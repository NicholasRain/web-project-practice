var langCN={currency:"&#165;",popup:{netError:"网络错误，请稍后再试！",title:"未知错误",submit:"确定",cancel:"取消",err:"未知错误, 请稍后重试"},datePicker:{year:"年",month:"月",day:"日",selYear:"请选择年",selMonth:"请选择月",selDay:"请选择日"},accountNav:{orderListNav:"订单管理",orderList:"我的订单",accountNav:"账户管理",coupon:"优惠券",points:"积分",profileNav:"个人信息",profile:"个人资料",security:"安全设置",address:"收货地址"},sign:{backIndex:"返回首页",login_close:"对不起，已关闭登录！",login_title:"登录",login_codeTitle:"登录密码",login_button:"登录",login_forget:"忘记密码",login:"登录",password:"密码",account:"账号",register:"注册",register_close:"暂不提供账号，已有账号？",register_vcode:"手机验证码",register_getVcode:"获取验证码",register_setCode:"设置密码",register_confirmCode:"确认密码",register_hasAccount:"已有账号？请",register_loginDirect:"直接登录",vcode:{type:"验证码",title:"获取手机验证码",unclear:"看不清？",reget:"重新获取",input_active:"请输入右图中的文字",input_error:"验证码不能为空！"},inputTips:{login_account_empty:"账号不能为空",login_account_active:"请输入登录账号",login_code_empty:"密码不能为空",login_code_active:"请输入账号密码",login_code_error:"账号和密码不匹配",login_code_error_email:"邮箱账户还未激活，请先到注册邮箱查收验证邮件完成验证",register_account_active:"请填写要申请的账号",register_account_empty:"账号不能为空！",register_vcode_active:"请输入收到的验证码",register_vcode_empty:"验证码不能为空",register_code_active:"请输入密码, 不少于6位字符",register_code_empty:"密码不能为空",register_recode_active:"请确认您的密码",register_recode_empty:"确认密码不能为空",register_account_short:"账号长度过短！",register_email_err:"请输入正确的邮箱账号！",register_mobile_err:"请输入正确的手机号！",register_username_err:"请输入正确的用户名！",register_account_err:"请输入正确的账号",register_code_short:"密码长度过短，不少于6位",register_code_diff:"两次密码输入不一致"},typeName:{account:"账户",userName:"用户名",email:"邮箱",mobile:"手机"},socialTitle:"社交账号登录",socialType:{weixin:"微信",qq:"QQ",weibo:"微博",renren:"人人",netease:"网易",douban:"豆瓣"}},profile:{title:"个人资料",typeName:{name:"昵称",realName:"真实姓名",IDcard:"身份证号",birthday:"生日",email:"电子邮箱",mobile:"手机号码",gender:"性别",male:"男",female:"女"},inputTips:{username:"请输入合法的昵称",IDcard:"请输入正确的身份证号码",email:"请输入正确的电子邮箱地址",mobile:"请输入正确的手机号码",usernameEmpty:"用户名不能为空！",usernameActive:"请输入您的昵称",realnameEmpty:"真实姓名不能为空",realnameActive:"请输入您的真实姓名",IDcardEmpty:"身份证号不能为空",IDcardActive:"请输入您的身份证号",emailEmpty:"电子邮箱不能为空",emailActive:"请输入您的电子邮箱",mobileEmpty:"手机号码不能为空",mobileActive:"请输入您的手机号码"},avatar:{title:"个人头像",edit:"修改头像",upload:"头像上传",select:"选择头像",preview:"预览头像",formatTips:"请上传JPG或PNG格式，小于5M的图片文件",formatSize:"推荐尺寸 90*90px",uploading:"正在上传图片"},edit:"修改",editProfile:"修改个人资料",loading:"正在加载会员等级",VIPlevel:"会员等级",credit:"经验值",points:"积分",selBirthday:"请选择正确的出生日期",keepSecret:"保密",unknown:"未填写",currentLv:"当前等级",beMaxLv:"，已达到最高等级",currentEx:"您的会员经验值为",moreExUpdate1:"还差",moreExUpdate2:"经验值升级为"},security:{title:"安全设置",edit:"修改",password:"账号密码",passwordTips:"互联网账号存在被盗风险，建议您定期更改密码以保护账户安全",bindSocial:"绑定社交账号",bindSocialTips:"绑定后可无需输入用户名和密码使用社交账号登录",toBind:"绑定",hasbind:"已绑",unbinded:"未绑定",unbindTips_1:"即将解除",unbindTips_2:"账号的绑定，解绑后将无法继续使用此",unbindTips_3:"快速登录此网站",unbind:"解除社交绑定",socialType:{weixin:"微信",qq:"QQ",weibo:"微博",renren:"人人",netease:"网易",douban:"豆瓣"},inputTips:{oldCode_empty:"旧密码不能为空",oldCode_active:"请输入您的旧密码",oldCode_err:"原密码不正确",newCode_empty:"新密码不能为空",newCode_active:"请输入您的新密码",newCode_short:"新密码长度不少于6位",confirmCode_empty:"确认密码不能为空",confirmCode_active:"请确认您的新密码",confirmCode_err:"两次密码输入不一致！"},oldCode:"旧密码",newCode:"设置新密码",confirmCode:"确认新密码",changeCode:"修改账号密码",changeSucess:"修改密码成功",changeFail:"修改密码失败"},address:{title:"收货地址",typeName:{name:"收货人",mobile:"联系电话",detail:"详细地址",zipcode:"邮政编码",setDefault:"设为默认地址"},selPlaceholder1:"请选择省份",selPlaceholder2:"请选择城市",selPlaceholder3:"请选择县区",inputTips:{area_err:"请选择完整的地址",name_empty:"收货人姓名不能为空",name_active:"请填写收货人姓名",mobile_empty:"请填写正确的联系电话",mobile_active:"请填写收货人的联系电话",detail_empty:"详细地址不能为空",detail_active:"请填写收货人的详细地址",zipcode_empty:"情填写正确的邮政编码",zipcode_active:"请填写所在地邮政编码"},remove:"删除",removeTitle:"删除收货地址",removeTips:"确定要删除所选收货地址吗？",defaultAddress:"默认地址",defaultTitle:"设置默认地址",defaultTips:"确定要将所选收货地址设为默认吗？",createTitle:"新增收货地址",editTitle:"编辑收货地址",edit:"编辑",empty:"您还没有添加收货地址"},coupon:{title:"优惠券",loading:"正在加载中...",used:"已使用",pending:"未使用",expired:"已过期",name:"优惠券名称",status:"状态",rules:"使用规则",code:"编号",indate:"有效期",expire_forever:"永久",nolimit:"无门槛使用",notFind:"未找到相关优惠券",percentage:"折",discount_off:"满￥#{active}减￥#{amount}",percentage_off:"满￥#{active}打#{percentage}折"},points:{loading:"正在加载积分详情...",title:"积分",useTitle:"可用积分",expiredTitle:"将过期",expired:"于#{expired_at}过期",detail:"积分明细",detail_desc:"详细说明",input:"收入",before_desc:"三个月前积分记录",latest_desc:"近三个月积分记录",output:"支出",date:"日期",io:"收入/支出",status:"状态",disabled:"本网站暂未启用积分功能",descTitle:"积分说明",empty:"未找到积分明细",desc_1:"积分赠送会在订单完成后自动到账， 取消订单则无法获得相应积分。",desc_2:"有效积分可直接用于支付网站订单。积分可抵现金额具体以订单显示为准。 ",desc_3:"积分可以累积，有效期最长2年，最短1年，即从获得积分开始至次年年底，逾期自动作废。例如，2015.12.31将清空2014年度获得但未使用的积分。",desc_4:""},orderPayment:{title:"支付订单",amountPay:"应付金额",orderDetail:"订单详情",cancelTips_1:"请您在提交订单后",cancelTips_2:"24小时",cancelTips_3:"内完成支付，否则订单会自动取消",payTips:"请尽快支付订单！",orderNo:"订单编号",productInfo:"商品信息",addressInfo:"收货信息",payMethodTips:"请选择以下支付方式付款",loadingMethods:"正在获取支付方式...",payBtn:"立即支付",bandTitle:"银行借记卡及信用卡",thirdPayTitle:"支付平台",thirdPayTitle_2:"大额支付推荐使用支付宝",paySucess:"支付成功",paySucessBtn:"已完成支付",payFail:"支付失败",payFailBtn:"支付遇到问题",paying:"正在支付"},orderList:{title:"我的订单",nav_all:"全部订单",nav_pay:"待付款",nav_ship:"待收货",nav_done:"已完成",searchTips:"输入订单号",loading:"正在加载中...",notFind:"未找到相关订单",orderNo:"订单号",totalAmount:"总额",package:"包裹 ",confirmOrder:"确认收货",payOrder:"立即支付",cancelOrder:"取消订单",buyAgain:"再次购买",orderDetail:"订单详情",payOnline:"在线支付",payOffline:"货到付款",cancelReason:{tips_1:"当前",tips_2:"订单取消后将无法恢复",tips_3:"，你可以在订单列表中再次购买。",title:"请选择取消订单的原因",reason_1:"商品价格比较贵",reason_2:"现在不想购买了",reason_3:"收货人信息有误",reason_4:"商品价格波动",reason_5:"送货时间过长",reason_6:"无法支付订单",reason_7:"需修改订单商品",reason_8:"需修改支付方式",reason_9:"其他原因",selReason:"请选择你取消的原因",cancel:"取消订单"},confirmTips:"是否收到该运单的全部商品？",order_unship:"未发货",order_receive:"已签收",order_expire:"支付过期",order_unpay:"等待付款",order_ship:"等待收货",order_shipping:"正在配送",order_done:"订单完成",order_cancel:"订单取消",order_refunding:"订单退单中",order_refund:"退单完成"},orderDetail:{title:"订单详情",orderNo:"订单号",loading:"正在加载中...",shopList:"购物清单",addressInfo:"收货信息",addressName:"收货姓名",addressMobile:"联系电话",addressDetail:"配送地址",payMethod:"支付方式",remark:"留言",coupon:"优惠券",unused:"未使用",unknownCoupon:"未知优惠券",totalAmount:"商品总额",shipAmount:"运费总计",pointsOff:"积分抵现",offAmount:"优惠减免",payAmount:"应付总额",orderState:"订单状态",payOnline:"在线支付",payOffline:"货到付款",noRemark:"无",state_order:"下单",state_paid:"完成支付",state_ship:"卖家发货",state_done:"订单完成",state_cancel:"订单取消",state_expired:"订单过期",payTips_1:"您付款的时间还剩余",payTips_2:"超时后订单将自动取消",cancelOrder:"取消订单",cancelTips:"如果要取消此订单，请在未发货之前取消。发货后将不能取消订单",hasCancelTips:"您的订单已取消，欢迎再次购买",shipTips:"卖家已发货，请留意物流信息",expiredTips:"您的订单已过期，欢迎再次购买",doneTips:"您的订单已完成，欢迎再次购买",shipMethod:"配送方式",package:"包裹",noShip:"无需物流",confirmOrder:"确认收货",shipCompany:"承运来源",shipNo:"快递单号",flashShip:"刷新信息",shipInfo:"查看物流信息",ship_normal:"快递",ship_pingyou:"平邮",ship_shunfeng:"顺丰",ship_self:"商家自送",ship_diy:"自提"},cart:{title:"购物车",loading:"正在加载购物车...",productName:"商品名称",unitPrice:"单价",quantity:"数量",stock:"库存",quantityWord:"件",operate:"操作",subtotal:"小计",checkAll:"全选",emptyCartTips:"您的购物车还没有商品，快去挑选心爱的商品吧！",goProductList:"去逛逛",totalAmount:"合计（不含运费）",clear:"清除下架商品",clearTips:"确定要清空下架商品吗?",selectProduct:"已选商品",confirmCart:"确认结算",atleastOne:"请至少选中一件商品",edit:"edit",discount:{type_1:"满减",type_2:"满折",type_3:"赠券",type_4:"包邮",off_desc:"减免 -&#165;",amount_off:"满 &#165;#{active_amount} 减 &#165;#{discount_amount}<br>",percent_off:"满 &#165;#{active_amount} 打 #{discount_percent} 折<br>",coupon_off_1:"购买即赠券 &#165;#{coupon_discount_amount}<br>",coupon_off_2:"满 &#165;#{active_amount} 赠券 &#165;#{coupon_discount_amount}<br>",ship_off:"满 &#165;#{active_amount} 包邮<br>"},coupon:"优惠券",hasOff:"已优惠",meetActivity:'已满足<span class="name yhsd-font-title">#{item_name}</span>的活动',rules:"活动规则",getMore:"去凑单！",remove:"删除",productInfoChange:"信息变动",productUnderstock:"库存不足",productUnsell:"商品下架",removeEmptyTips:"请至少选中一件商品",clearEmptyTips:"暂无下架商品",removeProduct:"删除商品",removeTips:"确定要把选中商品移出购物车吗?",removeSel:"删除选中商品",unSelSkus:"未选择正确的商品属性",editSkus:"修改商品属性",selSkusTips:"请选择商品属性"},simpleCart:{},orderCreate:{title:"提交订单",backToCart:"返回修改购物车",addressInfo:"收货信息",payMethod:"支付方式",shopList:"购物清单",remark:"留言",remarkTips:"请填写您的其他要求",remarkDesc:"订单补充说明",coupon:"优惠券",useCoupon:"使用优惠券",useCouponCodeTips_empty:"优惠码不能为空",useCouponCodeTips_active:"请填写您的优惠码",cancelUse:"取消使用",validating:"正在验证中...",points:"积分",use:"使用",left:"剩余",points_title:"输入积分数",use_max_points:"可抵现积分",get_points:"可获得积分",use_points:"使用积分",points_off:"积分抵现",use_points_active:"请输入要使用的积分数",use_points_empty:"使用积分数不能为空",couponCode:"优惠码",useCouponCode:"使用优惠码",couponCode_useless:"您的优惠码不可用",coupon_login:'请<a href="/account/login">登录</a>以查看可用优惠券',discountOff:"减免",discount_off_1:"满 &#165;#{active_amount}减 &#165;#{discount_amount}",discount_off_2:"无门槛减免 &#165;#{discount_amount}",discount_off_3:"无门槛打 #{discount_percentage}折",noCoupon:"无可用优惠券",expiredCode:"有效期：#{expired_at}<br>编码：",expire_forever:"永久",totalAmount:"商品总金额",shipAmount:"运费合计",vipDiscount:"会员优惠",activityDiscount:"活动优惠",couponDiscount:"用券优惠",lastAmount:"应付总额",unableSubmit:"无法提交订单，请联系卖家",addressTo:"寄送至",receiver:"收货人",package:"包裹",shipMethod:"配送方式",shipDesc_1:"普通快递",shipDesc_2:"顺丰速运",shipDesc_3:"EMS",shipDesc_4:"平邮",shipDesc_5:"商家配送",shipDesc_6:"自提",shipFee:"运费",loadingAddress:"正在加载收货信息...",loadingPay:"正在获取支付方式...",loadingCart:"正在加载购物车...",loadingCoupon:"正在加载优惠券...",noPaymethods:"商家的支付方式尚未准备完成，请联系商家开通",payOnline:"在线支付",payOffline:"货到付款",disabled:"不能",view:"查看",unSupportProducts:"以下#{quantity}件商品不支持",unSupportProducts_2:"以下商品中 #{unavail_products} 件商品不支持#{sTypeDesc}",addressInfoTips:"请确认收货信息",payMethodTips:"请确认支付方式",orderNo:"订单编号",saveOrderNo:"请妥善保管此订单号，方便查询物流与订单状态。",createSucess:"订单创建成功",createFail:"提交失败，请重试",goPay:"去支付"},forgetPassword:{title:"忘记密码",titleTips:"请输入邮箱或手机号来找回密码",account:"手机号/邮箱",findCode:"找回密码",resetCode:"重置密码",resetSucess:"密码已重置成功！",resetSucessTips:"请使用新的密码登录并愉快地购物吧！",resetWithEmail:"密码重置验证邮件已经发送到您的邮箱，请您点击其中的链接来重置密码！",inputTips:{account_empty:"账号不能为空！",account_active:"请填写注册时使用的手机号或邮箱",mobile_email_err:"请输入正确的手机号或邮箱！"}},validEmail:{title:"验证注册邮箱",sucess:"注册成功",sucessTips:"恭喜 #{email} 已注册成功！",goShoping:"返回继续购物",enterCenter:"进入个人中心",link:'验证邮件已发送到您的注册邮箱，请验证后再 <a href="/account/login">登录</a>。',noReply:"没有收到验证邮件怎么办？",noReplyTips:'检查上面的注册邮箱是否正确，错了可以 <a href="javascript:void(0);" id="yhsd-validemail-retry">重新注册</a>；<br>检查是否在注册邮箱的垃圾箱里。'},resetPassword:{title:"重置密码",titleTips:"重新设置密码",resetSucess:"密码已重置成功！",resetSucessTips:"请使用新的密码登录并愉快地购物吧！"},socialBind:{title:"社交账号绑定",accountBind:"请输入已注册账号完成社交账号绑定",infoBind:"请输入以下信息完成社交账号绑定",save:"保存",email_empty:"邮箱地址不能为空",email_active:"请输入您的邮箱地址",mobile_empty:"手机号码不能为空",mobile_active:"请输入您的手机号码",account_err:"请输入正确的账号",password_err:"请输入正确的密码",email_err:"请输入正确的邮箱地址",mobile_err:"请输入正确的手机号码"},productDetail:{selloutTit:"商品已售完",selloutCont:"请先逛逛其他商品吧。",submitAndBack:"点击确定返回到商品列表",offSell:"该商品已下架",unableBuy:"无法购买此商品，请挑选其他商品吧~",unableAdd:"无法加入购物车",discount_free_shipping:"满免邮",discount_amount_off:"满减",discount_coupon:"满赠券",discount_percent_off:"满折"}};window.$yhsd={};var yhsdAddressConfig=null,LANG=void 0===LANG?langCN:$.extend(!0,langCN,LANG);!function(){var e=function(e,t){for(var a,s=0,i=function(e){s=e};s<e.length&&(a=e[s],!1!==t.call(a,a,s,i));s++);},t=function(e){return document.getElementById(e)},a=function(e,t,a){if(document.getElementById(t))return!1;var s=document.createElement("script"),i=document.getElementsByTagName("head")[0];window[t]=a,s.src=e,s.id=t,i.appendChild(s)},s={set:function(e,t){if("localStorage"in window)return localStorage.setItem(e,t)},get:function(e){if("localStorage"in window)return localStorage.getItem(e)}},i=function(){var e,t=arguments[0],a=!1,s=t,n=1;for("boolean"==typeof t&&(a=t,s=arguments[n++]);e=arguments[n++];)if(e)for(var r in e){var o=e[r];a?o instanceof Array?s[r]=o.slice(0):"object"==typeof o&&(s[r]=i(!0,{},o)):s[r]=o}return s};function n(r){var o=this,d=function(){},c=s.get("jsplugin_areaselection_data"),l=c&&JSON.parse(c),p=t(r.id),u=n.dataVersion;if(!p)return null;i(o,{elem:p,placeholder:[LANG.address.selPlaceholder1,LANG.address.selPlaceholder2,LANG.address.selPlaceholder3],changed:d,inited:d,selects:[],tasks:[],curActivedLevel:0,initCode:"",isInited:!1},r),l&&l.version===u?o.init(l):a("//asset.ibanquan.com/common/js/areadata-"+u+".js","yhsd_areadata_callback",function(t){var a=JSON.parse(t);o.init(a),s.set("jsplugin_areaselection_data",t),e(n.instances,function(e){e.isInited||e.init(i(!0,{},a))})}),n.instances.push(o)}n.dataVersion="160315",n.instances=[],n.prototype={init:function(t){var a=this.elem,s=this.replaceText,i=!0,n=this.wireAll,r=this.field;if(this.data=t,"object"==typeof t){if(s){var o=document.createTextNode(s);a.appendChild(o),i=n=this.wireAll=!1}if("string"==typeof r){var d=this.matchField(r);d||((d=document.createElement("input")).name=r,d.type="hidden",a.appendChild(d)),this.lastCodeField=d}else r instanceof Array&&r.length&&(this.shouldBundle=!0);this.filterData(),this.initSelect(t.main,0,i),this.initSelect([],1,n),this.initSelect([],2,n),this.initCode&&this.setCode(this.initCode),e(this.tasks,function(e,t){e()}),this.isInited=!0,this.inited.call(this)}},filterData:function(){this.whiteList&&this.addFromWhite(this.whiteList)},addFromWhite:function(t){var a=this,s={},n={},r={main:[],sub:[]},o=i(!0,{},r);function d(t,s){var i=null;return e(a.data[s],function(e,a){if(e[0]===t)return i=e,!1}),i}function c(e,t){if(s[e])return!1;o[t].push(e),s[e]=!0}e(t,function(t,s){var i=a.getPrevCodes(t);if(i.length){var r=i.shift();n[t]=!0,n[r]&&c(r,"main"),i.length&&e(i,function(e,t){n[e]&&c(e,"sub")})}}),o.main.length?e(o.main,function(e,t){var a=d(e,"main");r.main.push(a)}):r.main=a.data.main,r.sub=a.data.sub,o.sub.length&&e(o.sub,function(t,s){var i=d(t,"sub")[2];e(a.data.sub,function(e,t,a){var s=e[0];e[2]===i&&!n[s]&&(r.sub.splice(t,1),a(--t))})}),i(a.data,r)},initSelect:function(e,t,a){var s=this.selects[t];s?this.initOptions(s,e,!0):((s=document.createElement("select")).level=this.selects.length,this.addClass&&(s.className=this.addClass),a||(s.style.display="none"),this.initOptions(s,e),this.shouldBundle&&this.bundleField(s),this.listenChange(s))},initOptions:function(t,a,s){var i=this,n=1===a.length,r=t.level,o=this.placeholder[r];t.options.length=0,a=[["",o]].concat(a),e(a,function(e,a){t.options[a]=new Option(e[1],e[0])}),!s&&this.appendSelect(t),i.initCode&&!i.isInited||n&&i.addTask(function(){i.changeSelect(t,1,"index")})},addTask:function(e){this.isInited?e():this.tasks.push(e)},appendSelect:function(e){this.elem.appendChild(e),this.selects.push(e)},unsetAfterLevel:function(t){var a=this;e(this.selects,function(e,s){s>t&&(e.value="",e.field&&(e.field.value=""),a.wireAll?e.options.length=1:e.style.display="none")})},updateSelects:function(t){var a=this;e(t,function(e,t){var s=a.selects[t];if(2===s.options.length?a.changeSelect(s,1,"index"):a.changeSelect(s,e),!e)return!1})},changeSelect:function(e,t,a){"index"===a?e.selectedIndex=t:(e.value=t,e.value!==t&&(e.selectedIndex=0)),this.handleChange(e)},listenChange:function(e){var t,a,s,i=this;a="change",s=function(e){var t=(e=e||window.event).target||e.srcElement;i.handleChange(t),i.codeChanged()},(t=e).addEventListener?t.addEventListener(a,s,!1):t.attachEvent?t.attachEvent("on"+a,s):t["on"+a]=s},handleChange:function(e,t){var a=e.value,s=e.level,i=(t=t||this.getSub(a),this.selects[s+1]);this.curActivedLevel=s,e.field&&(e.field.value=a),t?(this.unsetAfterLevel(s+1),this.initSub(t,i,e)):(this.unsetAfterLevel(s),e.value&&i&&(i.style.display="none"))},initSub:function(t,a,s){var i,n,r,o=a.level;if(this.replaceText||(a.style.display=""),this.initSelect(t,o),1===t.length){var d=t[0][0],c=this.getSub(d),l=!!(this.whiteList&&(i=this.whiteList,n=d,r=-1,e(i,function(e,t){if(e===n)return r=t,!1}),r>-1));c&&!l&&(a.style.display="none"),this.handleChange(a,c)}},setCode:function(e){var t=this;this.addTask(function(){var a=t.getPrevCodes(e);a.length||(a=["","",""]),t.updateSelects(a),t.codeChanged()})},resetCode:function(){this.setCode(this.initCode)},codeChanged:function(){var e=this.getCodeMap(),t=e.last.code;this.lastCodeField&&(this.lastCodeField.value=t),this.changed.call(e,e)},getPrevCodes:function(t,a){a=a||[];var s,i=this.data.main.concat(this.data.sub);return e(i,function(e,i){var n=e[0];t===n&&(a.unshift(t),s=e[2])}),s?this.getPrevCodes(s,a):a},getSub:function(t){var a=this.data.sub,s=[];if(e(a,function(e,a){t===e[2]&&s.push(e)}),s.length)return s},matchField:function(t){var a=document.getElementsByTagName("input"),s=null;return e(a,function(e,a){if(e.name===t&&!e.registered)return s=e,e.registered=!0,!1}),s},bundleField:function(e){var t=e.level,a=this.field[t],s=a?this.matchField(a):null;s?e.field=s:a&&(e.name=a)},getCodeMap:function(){var t=this,a={},s=null;return e(t.selects,function(e,i){var n,r=e.value,o={code:r,text:r?e.options[e.selectedIndex].innerText:""};switch(i){case 0:n="province";break;case 1:n="city";break;case 2:n="district"}("none"!==e.style.display||t.replaceText)&&(s=o),a[n]=o}),a.last=s,a}},window.yhsdAreaSelection=n}(),$yhsd.Util={isEmail:function(e){return Jssdk.util.isEmail(e)},isMobile:function(e){return Jssdk.util.isMobile(e)},isUserName:function(e){return Jssdk.util.isUsername(e)},isNickName:function(e){var t=e.toString();if(t.length>1&&t.length<21)return t},isRealname:function(e){return Jssdk.util.isRealname(e)},checkAddressMobile:function(e,t){return t=t.toString(),e?/^[0-9]{2,}$/.test(t):Jssdk.util.isMobile(t)},serializeDate:function(e,t){return t?e.slice(0,19).split("T").join(" "):e.slice(0,16).split("T").join(" ")},yuan:function(e){return Jssdk.util.yuan(e)},prettyNo:function(e){return parseFloat(e).toLocaleString()},checkIdentityCard:function(e){var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1],a=[1,0,10,9,8,7,6,5,4,3,2];return function(e){if(15===e.length)return n=(i=e).substring(6,8),r=i.substring(8,10),o=i.substring(10,12),(d=new Date(n,parseFloat(r)-1,parseFloat(o))).getYear()==parseFloat(n)&&d.getMonth()==parseFloat(r)-1&&d.getDate()==parseFloat(o);if(18===e.length){var s=e.split("");return!(!function(e){var t=e.substring(6,10),a=e.substring(10,12),s=e.substring(12,14),i=new Date(t,parseFloat(a)-1,parseFloat(s));return i.getFullYear()==parseFloat(t)&&i.getMonth()==parseFloat(a)-1&&i.getDate()==parseFloat(s)}(e)||!function(e){var s=0;"x"==e[17].toLowerCase()&&(e[17]=10);for(var i=0;i<17;i++)s+=t[i]*e[i];var n=s%11;return e[17]==a[n]}(s))}return!1;var i,n,r,o,d}(e)},getQuery:function(e,t){return Jssdk.util.getQuery(e,t)},setQuery:function(e,t,a){return Jssdk.util.setQuery(e,t,a)},setCookie:function(e,t,a,s){Jssdk.util.setCookie(e,t,a,s)},getCookie:function(e){return Jssdk.util.getCookie(e)},securePhone:function(e){return e.toString().replace(/(\d{3})\d{4}(\d+)/,"$1****$2")},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(e).replace(/[&<>"'\/]/g,function(e){return t[e]})}},$yhsd.util=$yhsd.Util,$yhsd.asset=window.assetPath.replace(/image\//g,"")+"common/",$yhsd.InputManager=function(e,t){this._inputs=$(e).find(".input"),this.config=t},$yhsd.InputManager.prototype={_inputs:[],verify:function(e,t){var a=this,s="blur"===t,i=this.getter(e);a.config[e].advanced(i,s)||function(t){var s=t.value?"exist":"";a.setter(e,s)}(i)},getter:function(e){var t=$(this._inputs[e]),a=t.parents(".input-area").eq(0),s=this.config[e].needTrim?$.trim(t.val()):t.val();return t.val(s),{value:s,state:a.attr("data-state")}},setter:function(e,t,a){var s=$(this._inputs[e]),i=s.parents(".input-area").eq(0),n=i.attr("data-state");return i.removeClass(n).addClass(t).attr("data-state",t).children(".tips").html(a||this.config[e].state[t]),"error"===t&&s.trigger("focus"),t},setVal:function(e,t){if(0!==t.length){var a=$(this._inputs[e]),s=a.parents(".input-area").eq(0),i=s.attr("data-state");a.val(t),s.removeClass(i).addClass("exist").attr("data-state","exist")}},init:function(){var e=this;$.each(e._inputs,function(t,a){var s=$(a),i=s.parents(".input-area"),n=e.config[t].immediate?"input propertychange":"blur";s.on("focus",function(){"error"!==i.attr("data-state")&&e.setter(t,"active")}).on(n,function(a){e.verify(t,a.type)}),s.siblings(".title").on("click",function(){s.trigger("focus")}),setTimeout(function(){window.navigator.userAgent.indexOf("Chrome")>-1&&"password"===s.attr("type")&&(s.parents(".input-field").find(".input[type=text]").val()&&e.setter(t,"exist",""))},300),s.one("input propertychange",function(){s.val()&&e.setter(t,"exist")})})}},$yhsd.Popup=function(e,t,a,s){this._title=e||"<h3>"+LANG.popup.title+"</h3>",this._content=t||'<div class="box"><div class="title">'+LANG.popup.err+'</div><div class="ctrl-btns"><a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a></div></div>",this.handle=a||function(){},this.noClose=s},$yhsd.Popup.prototype={_wrapper:'<div class="wrapper yhsd-popup-wrapper" id="yhsd-popup-wrapper" style="display: none">  <div class="yhsd-mask"></div>  <div class="yhsd-popup" id="yhsd-modal">    #{title}    #{close_btn}    #{content}  </div></div>',render:function(){var e=this.noClose?"":'<span class="yhsd-base-iconfont icon-close yhsd-popup-close yhsd-font-desc"></span>',t=this._wrapper.replace(/#\{title\}/g,this._title).replace(/#\{close_btn\}/g,e).replace(/#\{content\}/g,this._content);$(t).appendTo("body").fadeIn(200);var a=$("#yhsd-modal");a.css({"margin-left":-a.width()/2-40,"margin-top":-a.height()/2-30})},close:function(){$("#yhsd-popup-wrapper").fadeOut(200,function(){$(this).remove()})},init:function(e,t){var a=this;e?($("#yhsd-popup-wrapper").attr("id",t).hide(),$("#yhsd-modal").attr("id","")):$("#yhsd-popup-wrapper").remove(),a.render(),a.handle(),$("#yhsd-popup-wrapper").find(".yhsd-popup-close").on("click",function(){a.close()}),$("#yhsd-popup-wrapper").on("click",function(e){e.stopPropagation()})}},$yhsd.route={path:window.location.pathname,init:function(e){var t=this;if(e){var a=t.pathRegexp;$.each(e,function(e,t){if(!a[e]){var s=e.split("/");s.shift(),s.pop(),a[e]=new RegExp(s.join("/"))}}),$.each(a,function(a,s){var i=t.path.match(s);i&&1==i.length&&e[a]&&e[a](i[0])})}},pathRegexp:{all:/.*/,index:/^\/$/,cart:/^\/cart\/?$/,accountIndex:/^\/account\/?$/,accountLogin:/^\/account\/login\/?$/,accountRegister:/^\/account\/register\/?$/,socialBind:/^\/account\/social\/bind\/?$/,accountRegisterWithEmail:/^\/account\/register_with_email\/?$/,accountRegisterWithUsername:/^\/account\/register_with_user_name\/?$/,accountRegisterWithMobile:/^\/account\/register_with_mobile\/?$/,accountChangePassword:/^\/account\/change_password\/?$/,accountForgetPassword:/^\/account\/forget_password\/?$/,accountResetPasswordWithEmail:/^\/account\/reset_password_with_email\/?$/,accountResetPasswordWithMobile:/^\/account\/reset_password_with_mobile\/?$/,accountReset:/^\/account\/reset\/.+\/?$/,orderCreate:/^\/account\/create_order\/?$/,orderAll:/^\/account\/orders\/?$/,orderDetail:/^\/account\/orders\/.+\/?$/,productAll:/^\/products\/?$/,productDetail:/^\/products\/.+\/?$/,discounts:/^\/discounts\/.+\/?$/,types:/^\/types\/.+\/?$/,vendors:/^\/vendors\/.+\/?$/,search:/^\/search\/?$/,page:/^\/pages\/.+\/?$/,blogAll:/^\/blogs\/?$/,blogDetail:/^\/blogs\/.+\/?$/,postAll:/^\/posts\/?$/,postDetail:/^\/posts\/.+\/?$/}},$yhsd.HashRoute={routes:{},events:{},init:function(e){var t=this;e&&(t.routes=e,t._route(),$(window).on("hashchange",function(){t._route()}))},_route:function(){var e=window.location.hash.slice(1),t=!1;this._onDestroy(),$.each(this.routes,function(a,s){if(a==e)return t=!0,s(),!1}),!t&&(window.location.hash="/")},_onDestroy:function(){$.each(this.events,function(e,t){t.unsubscribe&&t.unsubscribe()}),this.events={}}},$yhsd.CheckBtn={init:function(e,t){var a=$(e).find('input[type="checkbox"], input[type="radio"]');a.on("change",function(){var e=$(this).prop("checked"),s=$(this).prev("label").children("span");"radio"===$(this).attr("type")&&a.siblings("label").children("span").removeClass("selected"),e?s.addClass("selected"):s.removeClass("selected"),t&&t($(this))})}},$yhsd.DatePicker={render:function(e,t){var a="";if("year"===e)for(var s=2016;s>1916;s--)a+='<option value="'+s+'">'+s+LANG.datePicker.year+"</option>";else if("month"===e)for(var i=1;i<13;i++)a+='<option value="'+i+'">'+i+LANG.datePicker.month+"</option>";else if("day"===e){a+='<option value="0">'+LANG.datePicker.selDay+"</option>";for(var n=1;n<t+1;n++)a+='<option value="'+n+'">'+n+LANG.datePicker.day+"</option>"}return a},piker:function(e){var t=this,a=$(e).children("select");a.eq(0).on("change",function(){$(e).attr("data-date",""),0==$(this).val()?a.eq(1).hide().prop("value",0):a.eq(1).show().prop("value",0),a.eq(2).hide()}),a.eq(1).on("change",function(){if($(e).attr("data-date",""),0==$(this).val())a.eq(2).hide();else{var s=a.eq(0).val()-0,i=a.eq(1).val()-0,n=(r=s,o=i,(d=new Date).setFullYear(r,o,0),d.getDate());a.eq(2).html(t.render("day",n)).show()}var r,o,d}),a.eq(2).on("change",function(){st1=0==a.eq(0).val()?"":a.eq(0).val(),st2=0==a.eq(1).val()?"":a.eq(1).val(),st3=0==a.eq(2).val()?"":a.eq(2).val();var t=st1+"/"+st2+"/"+st3;$(e).attr("data-date",t)})},init:function(e){var t=$(e);t.children("select").eq(0).append(this.render("year")),t.children("select").eq(1).append(this.render("month")),t.children("select").eq(2).append(this.render("day")),this.piker(e)}},$yhsd.SkuManager=function(e,t){var a={map:function(e,t){if(Array.prototype.map)return e.map(t);var a,s=[];for(a=0;a<e.length;a++)s.push(t(e[a],a,e));return s},every:function(e,t){if(Array.prototype.every)return e.every(t);var a;for(a=0;a<e.length;a++)if(!t(e[a],a,e))return!1;return!0},some:function(e,t){if(Array.prototype.some)return e.some(t);var a;for(a=0;a<e.length;a++)if(t(e[a],a,e))return!0;return!1},filter:function(e,t){if(Array.prototype.filter)return e.filter(t);var a,s=[];for(a=0;a<e.length;a++)t(e[a],a,e)&&s.push(e[a]);return s},handleStringOptions:function(e){var t;for(t=0;t<e.options.length;t++)"string"==typeof e.options[t].values&&(e.options[t].values=e.options[t].values.slice(1,-1).split(","));return e}};function s(e,t){var s=this;this.PRODUCT=a.handleStringOptions(e),this.variants=this._generateVariants(),void 0!==t?(this.selectedVariantId=parseInt(t),this.selectedOptions=a.filter(this.variants,function(e){return e.data.id===s.selectedVariantId})[0].option.slice()):window.notAutoSelectVariant?this.selectedOptions=[]:(this.variants.sort(function(e,t){var a,s=e.data.options.length;for(a=0;a<s;a++){if(e.data.options[a].position<t.data.options[a].position)return-1;if(e.data.options[a].position>t.data.options[a].position)return 1}return 0}),this.selectedOptions=this.variants[0].option.slice()),this.options=this._generateOptions(),this._checkSelectedMatch()}return s.prototype.get=function(e){this._diff(),e&&e(this.options,this.selectedVariant,this.patches,this.selectedOptions)},s.prototype.select=function(e,t,a){var s=function(){var e,t,a,s;return a={},s={},function(i){var n,r,o=[],d=[];for(n in i)r=i[n],s[n]=r,a[r]=n,o.push(r),d.push(n);e=new RegExp("("+o.join("|")+")","g"),t=new RegExp("("+d.join("|")+"|&#[0-9]{1,5};)","g")}({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"}),{htmlEncode:function(t){return t?String(t).replace(e,function(e,t){return a[t]}):t},htmlDecode:function(e){return e?String(e).replace(t,function(e,t){return t in s?s[t]:String.fromCharCode(parseInt(t.substr(2),10))}):e}}}();this.selectedOptions[e-1]=s.htmlEncode(s.htmlDecode(t)),this.options=this._generateOptions(),this._checkSelectedMatch(),this.get(a)},s.prototype.unselect=function(e,t){this.selectedOptions[e-1]="",this.options=this._generateOptions(),this._checkSelectedMatch(),this.get(t)},s.prototype._generateVariants=function(){var e=this.PRODUCT.variants;return a.map(e,function(e){return{option:a.map(e.options,function(e){return e.option_value}),data:e}})},s.prototype._generateOptions=function(){var e=this,t=this.PRODUCT.options;return this.cache=this.options,a.map(t,function(t){return{name:t.name,id:t.id,values:a.map(t.values,function(a){return{name:a,state:e._checkOptionState({value:a,position:t.position})}})}})},s.prototype._diff=function(){var e=this.cache;this.patches=e?a.map(this.options,function(t,s){return{name:t.name,id:t.id,values:a.filter(t.values,function(t,a){return t.state!==e[s].values[a].state})}}):this.options},s.prototype._checkOptionState=function(e){var t=e.value,s=e.position-1,i=this.selectedOptions,n=this.variants;if(t===i[s])return"selected";var r=i.slice();return r[s]=t,a.some(n,function(e){return a.every(e.option,function(t,a){return!r[a]&&0!==r[a]||r[a]===t&&!(window.variantsStockType&&"B"==e.data.stock_type&&e.data.stock<1)})})?"unselected":"disabled"},s.prototype._checkSelectedMatch=function(){var e,t,s=this;for(e=0;e<this.variants.length;e++){if(t=this.variants[e],a.every(t.option,function(e,t){return s.selectedOptions[t]===e}))return void(s.selectedVariant=t.data);s.selectedVariant=null}},new s(e,t)};var oGlobalConfig={noImage:$yhsd.asset+"img/160623/noimage.png",layoutHook:"#content_for_layout",openPoints:!1,_accountDom:'<div class="wrapper">  <div class="cont account">    <dl class="account-sideNav yhsd-form-background yhsd-main-border">      <dt class="yhsd-font-title"><i class="yhsd-base-iconfont icon-order-pc"></i>'+LANG.accountNav.orderListNav+'</dt>       <dd#{nav_order_selected}><a href="/account/orders" class="yhsd-font-desc">'+LANG.accountNav.orderList+'</a></dd>      <dt class="yhsd-font-title"><i class="yhsd-base-iconfont icon-account-pc"></i>'+LANG.accountNav.accountNav+'</dt>       <dd#{nav_coupon_selected}><a href="/account/#/coupon" class="yhsd-font-desc">'+LANG.accountNav.coupon+'</a></dd>       <dd#{nav_points_selected} style="display:none;"><a href="/account/#/points" class="yhsd-font-desc">'+LANG.accountNav.points+'</a></dd>      <dt class="yhsd-font-title"><i class="yhsd-base-iconfont icon-gerenzhongxin"></i>'+LANG.accountNav.profileNav+'</dt>       <dd#{nav_info_selected}><a href="/account/#/" class="yhsd-font-desc">'+LANG.accountNav.profile+'</a></dd>       <dd#{nav_safety_selected} style="display:none;"><a href="/account/#/security" class="yhsd-font-desc">'+LANG.accountNav.security+'</a></dd>       <dd#{nav_address_selected}><a href="/account/#/address" class="yhsd-font-desc">'+LANG.accountNav.address+'</a></dd>    </dl>    <div class="account-sideCont">    #{content}    </div>  </div></div>',returnAccountDom:function(e){var t=this,a={order:"order"===e?' class="selected"':"",coupon:"coupon"===e?' class="selected"':"",points:"points"===e?' class="selected"':"",info:"info"===e?' class="selected"':"",safety:"safety"===e?' class="selected"':"",address:"address"===e?' class="selected"':""};return Jssdk.reward_point.get(function(e){e.res.enabled&&$("dl.account-sideNav").length>0&&($("dl.account-sideNav").find("dd").eq(2).show(),t.openPoints=!0)}),Jssdk.account.current(function(e){!e.res.customer.social_type&&$("dl.account-sideNav").length>0&&$("dl.account-sideNav").find("dd").eq(4).show()}),this._accountDom.replace(/#\{nav_order_selected\}/g,a.order).replace(/#\{nav_coupon_selected\}/g,a.coupon).replace(/#\{nav_points_selected\}/g,a.points).replace(/#\{nav_info_selected\}/g,a.info).replace(/#\{nav_safety_selected\}/g,a.safety).replace(/#\{nav_address_selected\}/g,a.address)}},accountLogin={_empty:'<div class="wrapper">  <div class="cont">    <div class="empty-pages">      <img src="..'+$yhsd.asset+'img/160623/404-2.png" title="404">      <div class="desc">'+LANG.sign.login_close+'</div>      <a href="/" class="btn btn-sm btn-primary">'+LANG.sign.backIndex+"</a>    </div>  </div></div>",_default:'<div class="wrapper log-block-outer">  <div class="cont log-block-inner">    <div class="log-block">      <h4 class="yhsd-font-title">'+LANG.sign.login_title+'</h4>      <form class="input-field" id="yhsd-login-inputField" action="javascript:void(0);">        <div class="input-area input-area-lg" data-state="">          <div class="title">#{method}</div>          <input class="input yhsd-font-text" type="text" name="account" maxlength="200">          <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">          <div class="title">'+LANG.sign.login_codeTitle+'</div>          <input class="input yhsd-font-text" type="password" name="password" maxlength="40">          <div class="tips"></div>        </div>        <div class="rapid"><a class="yhsd-font-link" href="/account/register">'+LANG.sign.register+'</a><a href="/account/forget_password" class="forget yhsd-font-link">'+LANG.sign.login_forget+'</a></div>        <button id="yhsd-login-submit" class="btn btn-primary btn-lg btn-block" type="submit">'+LANG.sign.login_button+"</button>      </form>      #{social}    </div>  </div></div>",_social_list:'<div class="social-login">  <div><span class="yhsd-font-text">'+LANG.sign.socialTitle+"</span></div>  <ul>      #{social_items}  </ul></div>",_social_item:'<li><a href="#{url}" class="icon-#{type}-round"><span>#{type_name}'+LANG.sign.login_title+"</span></a></li>",init:function(){var e=this;Jssdk.shop.get(function(t){if(200===t.res.code){e.render(t.res.shop);var a=new $yhsd.InputManager("#yhsd-login-inputField",e.config);a.init(),$("#yhsd-login-inputField").on("submit",function(t){t.preventDefault(),t.stopPropagation(),e.submit(a)})}})},config:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.inputTips.login_account_empty,active:LANG.sign.inputTips.login_account_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.login_code_empty,active:LANG.sign.inputTips.login_code_active}}],render:function(e){var t=this,a="";if(e.enable_login){a=t._default;var s=[];e.enable_mobile_regist&&s.push(LANG.sign.typeName.mobile),e.enable_email_regist&&s.push(LANG.sign.typeName.email),e.enable_username_regist&&s.push(LANG.sign.typeName.userName),0===s.length&&s.push(LANG.sign.typeName.account),a=a.replace(/#\{method\}/g,s.join("/"));var i={weixin:e.enable_weixin_login,qq:e.enable_qq_login,netease:e.enable_netease_login,douban:e.enable_douban_login,weibo:e.enable_weibo_login,renren:e.enable_renren_login};if(i.weixin||i.qq||i.netease||i.douban||i.weibo||i.renren){var n="";$.each(i,function(a,s){if(s){var i="",r="";switch(a){case"weixin":i=LANG.sign.socialType.weixin,r=e.weixin_login_url;break;case"qq":i=LANG.sign.socialType.qq,r=e.qq_login_url;break;case"weibo":i=LANG.sign.socialType.weibo,r=e.weibo_login_url;break;case"renren":i=LANG.sign.socialType.renren,r=e.renren_login_url;break;case"netease":i=LANG.sign.socialType.netease,r=e.netease_login_url;break;case"douban":i=LANG.sign.socialType.douban,r=e.douban_login_url}n+=t._social_item.replace(/#\{type\}/g,a).replace(/#\{type_name\}/g,i).replace(/#\{url\}/g,r)}}),a=a.replace(/#\{social\}/g,t._social_list.replace(/#\{social_items\}/g,n))}else a=a.replace(/#\{social\}/g,"")}else a=t._empty;$(oGlobalConfig.layoutHook).html(a)},submit:function(e){var t=this,a={account:e.getter(0).value,password:e.getter(1).value};a.account?a.password?Jssdk.account.login(a,function(a){if(200===a.res.code)t._onSuccess();else if(201===a.res.code)if((a.res.message||"").indexOf("邮箱账户还未激活")>-1){var s='<div class="box">    <div class="title">'+LANG.sign.inputTips.login_code_error_email+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.sign.login+"</h3>",s).init()}else e.setter(1,"error",LANG.sign.inputTips.login_code_error);else{s='<div class="box">    <div class="title">'+a.res.message+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.sign.login+"</h3>",s).init()}}):e.setter(1,"error"):e.setter(0,"error")},_onSuccess:function(){var e=$yhsd.Util.getCookie("redirect_back_url");e?($yhsd.Util.setCookie("redirect_back_url",""),location.href=decodeURIComponent(e)):location.pathname="/"}},accountRegister={_empty:'<div class="wrapper">  <div class="cont">    <div class="empty-pages">      <img src="'+$yhsd.asset+'img/160623/close_register.png" title="no-register">      <div class="desc">'+LANG.sign.register_close+'</div>      <a href="/account/login" class="btn btn-sm btn-primary">'+LANG.sign.login+"</a>    </div>  </div></div>",_default:'<div class="wrapper log-block-outer">  <div class="cont log-block-inner register">    <div class="log-block">      <h4 class="yhsd-font-title">'+LANG.sign.register+'</h4>       <form class="input-field" id="yhsd-register-inputField" action="javascript:void(0);">         <div class="input-area input-area-lg" data-state="">           <div class="title">#{method}</div>           <input id="yhsd-register-type" class="input yhsd-font-text" type="text" name="account" maxlength="200">           <div class="tips"></div>         </div>         <div id="yhsd-register-vcode-show" class="input-group" style="display: none">           <div class="input-area input-area-lg" data-state="">             <div class="title">'+LANG.sign.register_vcode+'</div>             <input id="yhsd-register-vcode" class="input yhsd-font-text" type="text" name="verify_code" maxlength="10">             <div class="tips"></div>           </div>           <a id="yhsd-register-getVcode" href="javascript:void(0);" class="btn btn-input yhsd-font-link">'+LANG.sign.register_getVcode+'</a>         </div>         <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.sign.register_setCode+'</div>           <input id="yhsd-register-code" class="input yhsd-font-text" type="password" name="password" maxlength="40">           <div class="tips"></div>         </div>         <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.sign.register_confirmCode+'</div>           <input id="yhsd-register-codeConfirm" class="input yhsd-font-text" type="password" name="password_again" maxlength="40">           <div class="tips"></div>         </div>         <div class="rapid yhsd-font-desc">'+LANG.sign.register_hasAccount+'<a href="/account/login" class="yhsd-font-link">'+LANG.sign.register_loginDirect+'</a></div>         <button id="yhsd-register-submit" class="btn btn-primary btn-lg btn-block" type="submit">'+LANG.sign.register+"</button>       </form>       #{social}    </div>  </div></div>",_social_list:'<div class="social-login">  <div><span class="yhsd-font-desc">'+LANG.sign.socialTitle+"</span></div>  <ul>      #{social_items}  </ul></div>",_social_item:'<li><a href="#{url}" class="icon-#{type}-round"><span>#{type_name}'+LANG.sign.login+"</span></a></li>",init:function(){var e=this;Jssdk.shop.get(function(t){if(200===t.res.code){e.oCache=t.res.shop,t.res.shop.enable_mobile_regist&&e.methods.push(LANG.sign.typeName.mobile),t.res.shop.enable_email_regist&&e.methods.push(LANG.sign.typeName.email),t.res.shop.enable_username_regist&&e.methods.push(LANG.sign.typeName.userName),e.render(t.res.shop),e.tagVcode();var a=new $yhsd.InputManager("#yhsd-register-inputField",e.config);a.init(),$("#yhsd-register-inputField").on("submit",function(t){t.stopPropagation(),t.preventDefault(),e.submit(a)})}})},oCache:null,methods:[],render:function(e){var t=this,a="";if(t.methods.length>0){a=t._default.replace(/#\{method\}/g,t.methods.join("/"));var s={weixin:e.enable_weixin_login,qq:e.enable_qq_login,netease:e.enable_netease_login,douban:e.enable_douban_login,weibo:e.enable_weibo_login,renren:e.enable_renren_login};if(s.weixin||s.qq||s.netease||s.douban||s.weibo||s.renren){var i="";$.each(s,function(a,s){if(s){var n="",r="";switch(a){case"weixin":n=LANG.sign.socialType.weixin,r=e.weixin_login_url;break;case"qq":n=LANG.sign.socialType.qq,r=e.qq_login_url;break;case"weibo":n=LANG.sign.socialType.weibo,r=e.weibo_login_url;break;case"renren":n=LANG.sign.socialType.renren,r=e.renren_login_url;break;case"netease":n=LANG.sign.socialType.netease,r=e.netease_login_url;break;case"douban":n=LANG.sign.socialType.douban,r=e.douban_login_url}i+=t._social_item.replace(/#\{type\}/g,a).replace(/#\{type_name\}/g,n).replace(/#\{url\}/g,r)}}),a=a.replace(/#\{social\}/g,t._social_list.replace(/#\{social_items\}/g,i))}else a=a.replace(/#\{social\}/g,"")}else a=t._empty;$(oGlobalConfig.layoutHook).html(a)},tagVcode:function(){var e=this,t=$("#yhsd-register-type"),a=$("#yhsd-register-vcode-show");t.on("input propertychange",function(){var s=$.trim(t.val());e.oCache.enable_mobile_regist&&($yhsd.Util.isMobile(s)?(a.slideDown(200),e.getVcode(!0)):(a.slideUp(200),$("#yhsd-register-vcode").val(""),e.getVcode(!1)))})},getVcode:function(e){var t=$("#yhsd-register-getVcode");e?t.on("click",function(){if(!$(this).hasClass("gray")){var e="<h3>"+LANG.sign.vcode.title+"</h3>",a='<div class="box register-get-vcode">   <form class="input-field" id="yhsd-register-captcha-inputField" action="javascript:void(0);">       <div class="input-area input-area-lg" data-state="">          <div class="title">'+LANG.sign.vcode.type+'</div>          <input id="yhsd-register-captcha" class="input " type="text" maxlength="10" name="captcha_value">          <div class="tips"></div>       </div>       <img id="yhsd-register-captcha-img"><a href="javascript:void(0);" id="yhsd-register-captcha-retry">'+LANG.sign.vcode.unclear+'</a>       <div class="ctrl-btns">          <button id="yhsd-register-captcha-submit" class="btn btn-md btn-primary" type="submit">'+LANG.popup.submit+'</button>          <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>       </div>   </form></div>";new $yhsd.Popup(e,a,function(){var e=this;$("#yhsd-register-captcha-retry").on("click",function(){Jssdk.captcha.fetch(function(e){$("#yhsd-register-captcha-img").attr("src",e.src),$("#yhsd-register-captcha").attr("data-id",e.id)})}).click();var a=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.vcode.input_active,active:LANG.sign.vcode.input_error}}],s=new $yhsd.InputManager("#yhsd-register-captcha-inputField",a);s.init(),$("#yhsd-register-captcha-submit").on("click",function(){var a=s.getter(0).value;if(a){var i={mobile:$.trim($("#yhsd-register-type").val()),captcha_id:$("#yhsd-register-captcha").attr("data-id"),captcha_value:a};Jssdk.account.sendRegistValidateSms(i,function(a){200===a.res.code?(e.close(),function(e){t.html(LANG.sign.vcode.reget+"("+e+")").addClass("gray");var a=setInterval(function(){e--,t.html(LANG.sign.vcode.reget+"("+e+")"),e<0&&(clearInterval(a),t.removeClass("gray").html(LANG.sign.register_getVcode))},1e3)}(60)):201===a.res.code?s.setter(0,"error",a.res.message):(e.close(),setTimeout(function(){var e='<div class="box">    <div class="title">'+LANG.popup.netError+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.popup.title+"</h3>",e).init()},300))})}else s.setter(0,"error")})}).init()}}):t.off()},config:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.inputTips.login_account_empty,active:LANG.sign.inputTips.login_account_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_vcode_empty,active:LANG.sign.inputTips.register_vcode_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_code_empty,active:LANG.sign.inputTips.register_code_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_recode_empty,active:LANG.sign.inputTips.register_recode_active}}],verify:function(e){var t={type:"",account:e.getter(0).value,verify_code:e.getter(1).value,password:e.getter(2).value,password_again:e.getter(3).value},a=this.oCache.enable_mobile_regist,s=this.oCache.enable_email_regist,i=this.oCache.enable_username_regist;switch(!0){case a&&$yhsd.Util.isMobile(t.account):t.type="mobile";break;case s&&$yhsd.Util.isEmail(t.account):t.type="email";break;case i&&$yhsd.Util.isUserName(t.account):t.type="uname";break;default:return function(t){switch(!0){case 0===t.length:e.setter(0,"error");break;case t.indexOf("@")>-1&&s:e.setter(0,"error",LANG.sign.inputTips.register_email_err);break;case t.length<5:e.setter(0,"error",LANG.sign.inputTips.register_account_short);break;case t.length=/^[1-9][0-9]{6,}$/.test(t)&&a:e.setter(0,"error",LANG.sign.inputTips.register_mobile_err);break;case i:e.setter(0,"error",LANG.sign.inputTips.register_username_err);break;default:e.setter(0,"error",LANG.sign.inputTips.register_account_err)}}(t.account),!1}if("mobile"===t.type){if(!t.verify_code)return e.setter(1,"error"),!1}else delete t.verify_code;return t.password.length<6?(0===t.password.length?e.setter(2,"error"):e.setter(2,"error",LANG.sign.inputTips.register_code_short),!1):0===t.password_again.length?(e.setter(3,"error"),!1):t.password!==t.password_again?(e.setter(3,"error",LANG.sign.inputTips.register_code_diff),!1):(e.setter(3,"correct"),e.setter(2,"correct"),t)},validEmail:function(e){var t=('<div class="wrapper">    <div class="cont">        <h2 class="page-title">'+LANG.validEmail.sucess+'</h2>        <div class="account-block valid-email">            <img src="'+$yhsd.asset+'img/160623/register_sucess.png">            <div class="register-success">'+LANG.validEmail.sucessTips+'</div>            <div class="register-success-tips">                <div class="title">'+LANG.validEmail.title+'</div>                <div class="desc">'+LANG.validEmail.link+'</div>                <div class="title">'+LANG.validEmail.noReply+'</div>                <div class="desc">'+LANG.validEmail.noReplyTips+"</div>            </div>        </div>    </div></div>").replace(/#\{email\}/g,e);$(oGlobalConfig.layoutHook).html(t),$("#yhsd-validemail-retry").on("click",function(){window.location.href="/account/register"})},submit:function(e){var t=this,a=t.verify(e);a&&Jssdk.account.register(a,function(s){if(200===s.res.code)$yhsd.Util.isEmail(a.account)?t.validEmail(s.res.customer.notify_email):window.location.href="/";else if(201===s.res.code){var i=s.res.message;switch(!0){case i.indexOf("密码")>-1:e.setter(2,"error",i);break;case i.indexOf("验证码")>-1:e.setter(1,"error",i);break;case i.indexOf("邮箱")>-1||i.indexOf("手机")>-1||i.indexOf("用户名")>-1:e.setter(0,"error",i);break;default:var n='<div class="box">    <div class="title">'+i+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.sign.register+"</h3>",n).init()}}else{n='<div class="box">    <div class="title">'+LANG.popup.netError+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.popup.title+"</h3>",n).init()}})}},accountProfile={_main:'<div class="account-sideCont-block personal-info yhsd-form-background yhsd-main-border"> <h3 class="yhsd-font-title">'+LANG.profile.title+'</h3> <div class="avatar">   <div><img id="avatar-image" src="#{avatar_url}" title="'+LANG.profile.avatar.title+'" alt="'+LANG.profile.avatar.title+'"></div>   <a id="yhsd-edit-avatar" href="javascript:void(0);" class="yhsd-font-link">'+LANG.profile.avatar.edit+'</a> </div> <table class="yhsd-font-text yhsd-main-border">   <tbody>   <tr>     <td>'+LANG.profile.typeName.name+"</td>     <td>： </td>     <td>#{name}</td>   </tr>   <tr>     <td>"+LANG.profile.typeName.realName+"</td>     <td>： </td>     <td>#{real_name}</td>   </tr>   <tr>     <td>"+LANG.profile.typeName.IDcard+"</td>     <td>： </td>     <td>#{indentity_card}</td>   </tr>   <tr>     <td>"+LANG.profile.typeName.birthday+"</td>     <td>： </td>     <td>#{birthday}</td>   </tr>   <tr>     <td>"+LANG.profile.typeName.email+"</td>     <td>： </td>     <td>#{notify_email}</td>   </tr>   <tr>   <tr>     <td>"+LANG.profile.typeName.mobile+"</td>     <td>： </td>     <td>#{notify_phone}</td>   </tr>     <td>"+LANG.profile.typeName.gender+'</td>     <td>： </td>     <td>#{sex}</td>   </tr>   </tbody> </table> <a id="yhsd-edit-info" class="btn btn-primary btn-sm modify-info" href="javascript:void(0);">'+LANG.profile.edit+'</a></div><div id="yhsd-personal-level" class="account-sideCont-block vip-level yhsd-form-background yhsd-main-border">'+LANG.profile.loading+"</div>",_vip:'#{points_dom}<h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-point"></i>'+LANG.profile.credit+'：<span>#{credits}</span></h5><h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-grade"></i>'+LANG.profile.VIPlevel+"：<span>#{level_name}</span></h5>#{level_desc}#{level_graph}",_points:'<h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-reward_point"></i>'+LANG.profile.points+'：<span id="yhsd-personal-reward_point">0</span></h5>',render:function(oInfo){var self=this,sMain=self._main;$.each(oInfo,function(key,val){var reg="/#\\{"+key+"\\}/ig";"indentity_card"===key&&(val=val.toString().replace(/(\d{6})\d{10}(\d+)/,"$1******$2")),"notify_phone"===key&&(val=$yhsd.Util.securePhone(val)),sMain=sMain.replace(eval(reg),val)});var sDom=oGlobalConfig.returnAccountDom("info").replace(/#\{content\}/g,sMain);$(oGlobalConfig.layoutHook).html(sDom)},renderBar:function(e,t){var a=this;Jssdk.shop.get("customer_level",function(s){if(200===s.res.code){var i=s.res.customer_level,n="",r="",o=i.length;if(o>1){n='<small class="yhsd-font-desc">'+LANG.profile.currentEx+"#{credits}#{level_next}</small>",r='<div id="vip-level-bar" class="vip-level-bar">    <ol>        #{level_icons}    </ol>    <div class="progress">       #{progress}    </div></div>';var d="",c="",l=-1;$.each(i,function(a,s){var n=798/(o-1),r="";s.name===e.name&&(r=LANG.profile.currentLv),-1===l&&a<o-1&&(c+=r?'<div style="width: '+n*(t-s.credits)/(i[a+1].credits-s.credits)+'px"></div>':'<div style="width: '+n+'px"></div>'),s.name===e.name&&(l=a);var p="";0===a&&(p=' class="first"',n=n/2+14),a===o-1&&(p=' class="last"',n=n/2+14),d+='<li#{first_last} style="width: #{icon_width}px;"><img src="#{icon_src}"><b class="yhsd-font-title">#{name}</b><small class="yhsd-font-desc">#{is_current}</small></li>'.replace(/#\{first_last\}/g,p).replace(/#\{icon_width\}/g,n).replace(/#\{name\}/g,s.name).replace(/#\{icon_src\}/g,s.avatar_url).replace(/#\{is_current\}/g,r)});var p="";p=l===o-1?LANG.profile.beMaxLv:LANG.profile.moreExUpdate1+$yhsd.Util.prettyNo(i[l+1].credits-t)+LANG.profile.moreExUpdate2+i[l+1].name,r=r.replace(/#\{level_icons\}/g,d).replace(/#\{progress\}/g,c),n=n.replace(/#\{credits\}/g,$yhsd.Util.prettyNo(t)).replace(/#\{level_next\}/g,p)}var u=a._vip.replace(/#\{credits\}/g,$yhsd.Util.prettyNo(t)).replace(/#\{points_dom\}/g,oGlobalConfig.openPoints?a._points:"").replace(/#\{level_name\}/g,e.name).replace(/#\{level_desc\}/g,n).replace(/#\{level_graph\}/g,r);$("#yhsd-personal-level").html(u),oGlobalConfig.openPoints&&Jssdk.account.rewardPointDetails({nopage:"Y"},function(e){200===e.res.code&&$("#yhsd-personal-reward_point").html(e.res.reward_point_total)})}})},edit:function(e){var t=this;$("#yhsd-edit-info").on("click",function(){var a='<h3 class="yhsd-font-title">'+LANG.profile.editProfile+"</h3>",s='<div class="box change-personal-info">    <form class="input-field" id="yhsd-personal-editInfo-inputField" action="javascript:void(0);">        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.profile.typeName.name+'</div>           <input class="input yhsd-font-text" type="text" maxlength="255" name="name">           <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.profile.typeName.realName+'</div>           <input class="input yhsd-font-text" type="text" maxlength="255" name="real_name">           <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.profile.typeName.IDcard+'</div>           <input class="input yhsd-font-text" type="text" maxlength="19" name="indentity_card">           <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.profile.typeName.email+'</div>           <input class="input yhsd-font-text" type="text" maxlength="80" name="email">           <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.profile.typeName.mobile+'</div>           <input class="input yhsd-font-text" type="text" maxlength="15" name="telephone">           <div class="tips"></div>        </div>       <div class="select-group">           <div id="yhsd-personal-editInfo-drop" data-date="0">               <select class="yhsd-select yhsd-font-text"><option value="0">'+LANG.datePicker.selYear+'</option></select>               <select class="yhsd-select yhsd-font-text" style="display:none"><option value="0">'+LANG.datePicker.selMonth+'</option></select>               <select class="yhsd-select yhsd-font-text" style="display:none"><option value="0">'+LANG.datePicker.selDay+'</option></select>           </div>           <div class="drop-name">'+LANG.profile.typeName.birthday+'*</div>           <div class="tips">'+LANG.profile.selBirthday+'</div>       </div>       <div class="gender">           <h4 class="yhsd-font-title">'+LANG.profile.typeName.gender+'</h4>           <div class="checkbox-group">               <label for="undefined" class="yhsd-font-text"><span class="radio-btn selected"></span>'+LANG.profile.keepSecret+'</label>               <input type="radio" name="sex" id="undefined" checked>               <label for="male" class="yhsd-font-text"><span class="radio-btn"></span>'+LANG.profile.typeName.male+'</label>               <input type="radio" name="sex" id="male">               <label for="female" class="yhsd-font-text"><span class="radio-btn"></span>'+LANG.profile.typeName.female+'</label>               <input type="radio" name="sex" id="female">           </div>       </div>       <div class="ctrl-btns">           <button id="yhsd-edit-submit" class="btn btn-md btn-primary" type="submit">'+LANG.popup.submit+'</button>           <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>       </div>    </form></div>",i=new $yhsd.Popup(a,s,function(){var a=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.profile.inputTips.usernameEmpty,active:LANG.profile.inputTips.usernameActive}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.profile.inputTips.realnameEmpty,active:LANG.profile.inputTips.realnameActive}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.profile.inputTips.IDcardEmpty,active:LANG.profile.inputTips.IDcardActive}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.profile.inputTips.emailEmpty,active:LANG.profile.inputTips.emailActive}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.profile.inputTips.mobileEmpty,active:LANG.profile.inputTips.mobileActive}}],s=new $yhsd.InputManager("#yhsd-personal-editInfo-inputField",a);s.init(),$yhsd.CheckBtn.init(".gender"),$yhsd.DatePicker.init("#yhsd-personal-editInfo-drop"),e.name!==LANG.profile.unknown&&s.setVal(0,e.name),e.real_name!==LANG.profile.unknown&&s.setVal(1,e.real_name),e.indentity_card!==LANG.profile.unknown&&s.setVal(2,e.indentity_card),e.notify_email!==LANG.profile.unknown&&s.setVal(3,e.notify_email),e.notify_phone!==LANG.profile.unknown&&s.setVal(4,e.notify_phone);var n=$("#yhsd-personal-editInfo-drop").find(".yhsd-select");if(e.birthday!==LANG.profile.unknown){var r=e.birthday.split("-");n.eq(0).prop("value",+r[0]).trigger("change"),n.eq(1).prop("value",+r[1]).trigger("change"),n.eq(2).prop("value",+r[2]).trigger("change")}var o=$(".checkbox-group").find("label");e.sex===LANG.profile.typeName.male?o.eq(1).trigger("click"):e.sex===LANG.profile.typeName.female&&o.eq(2).trigger("click"),$("#yhsd-personal-editInfo-inputField").on("submit",function(e){e.stopPropagation(),e.preventDefault();var a={name:s.getter(0).value,sex:$(".checkbox-group").find("input:checked").attr("id")},n={real_name:s.getter(1).value,indentity_card:s.getter(2).value,notify_email:s.getter(3).value,notify_phone:s.getter(4).value,birthday:$("#yhsd-personal-editInfo-drop").attr("data-date")};if(a.name)if($yhsd.Util.isNickName(a.name)){if(n.real_name&&(a.real_name=n.real_name),n.indentity_card){if(!$yhsd.Util.checkIdentityCard(n.indentity_card))return void s.setter(2,"error",LANG.profile.inputTips.IDcard);a.indentity_card=n.indentity_card}if(n.notify_email){if(!$yhsd.Util.isEmail(n.notify_email))return void s.setter(3,"error",LANG.profile.inputTips.email);a.notify_email=n.notify_email}if(n.notify_phone){if(!$yhsd.Util.isMobile(n.notify_phone))return void s.setter(4,"error",LANG.profile.inputTips.mobile);a.notify_phone=n.notify_phone}if(n.birthday.length>0){if(n.birthday.length<8)return void $("#yhsd-personal-editInfo-drop").parent().addClass("error").on("click",function(){$(this).removeClass("error")});a.birthday=n.birthday}$.post("/api/v1/account/save?token="+window.ajaxToken,a,function(e){if(200===e.code)i.close(),t.init();else{var a='<div class="box">    <div class="title">'+e.message+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.profile.editProfile+"</h3>",a).init()}})}else s.setter(0,"error",LANG.profile.inputTips.username);else s.setter(0,"error")})});i.init()})},editAvatar:function(e){$("#yhsd-edit-avatar").on("click",function(){var t='<div class="box change-personal-avatar">    <div class="img"><img id="preview-img" src="'+e+'" alt="'+LANG.profile.avatar.preview+'"></div>    <div class="title">'+LANG.profile.avatar.formatTips+"</div>    <small>"+LANG.profile.avatar.formatSize+'</small><br>    <a href="javascript:void(0);" class="btn btn-sm btn-primary">'+LANG.profile.avatar.select+'</a>    <form id="edit-avatar-form" action="/account/upload_avatar" method="post" accept-charset="UTF-8" enctype="multipart/form-data" target="uploader">       <input accept="image/gif, image/jpeg, image/png, image/bmp" name="avatar" type="file">    </form>    <iframe id="iframe-uploader" name="uploader" style="display: none;"></iframe></div><div class="ctrl-btns">    <button id="yhsd-editAvatar-submit" class="btn btn-md btn-primary" type="submit">'+LANG.popup.submit+'</button>    <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div>";new $yhsd.Popup("<h3>"+LANG.profile.avatar.edit+"</h3>",t,function(){var e="";$("#edit-avatar-form").find("input").on("change",function(t){var a=$("#preview-img");if(window.FileReader){var s=t.target.files[0];e=s.name;var i=new FileReader;i.onload=function(e){a.attr({alt:LANG.profile.avatar.preview,src:e.target.result})},i.readAsDataURL(s)}else a.attr({alt:LANG.profile.avatar.preview,src:""})}),$("#yhsd-editAvatar-submit").on("click",function(){$("#edit-avatar-form").trigger("submit");var t='<div class="box change-personal-avatar">    <div class="title">'+LANG.profile.avatar.uploading+"：["+e+']</div>    <div class="progress"><div style="width: 6%"></div></div></div>',a=new $yhsd.Popup("<h3>"+LANG.profile.avatar.uploading+"</h3>",t,function(){$("#iframe-uploader")[0].onload=function(){var e=$("#yhsd-modal").find(".progress").children(),t=setInterval(function(){if(e.width()>510)clearInterval(t);else{var a=e.width()+20*Math.random()+20;e.css("width",a)}},100);Jssdk.account.current(function(s){200===s.res.code?($("#yhsd-popup-wrapper-progress").remove(),e.css("width","100%"),clearInterval(t),a.close(),$("#avatar-image").attr("src",s.res.customer.avatar_url)):window.location.reload()})}});a.init(!0,"yhsd-popup-wrapper-progress")})}).init()})},init:function(){var e=this;Jssdk.account.current(function(t){if(200===t.res.code){var a=LANG.profile.keepSecret;"male"===t.res.customer.sex?a=LANG.profile.typeName.male:"female"===t.res.customer.sex&&(a=LANG.profile.typeName.female);var s={avatar_url:t.res.customer.avatar_url,name:t.res.customer.name,real_name:t.res.customer.real_name||LANG.profile.unknown,indentity_card:t.res.customer.indentity_card?t.res.customer.indentity_card:LANG.profile.unknown,notify_email:t.res.customer.notify_email||LANG.profile.unknown,notify_phone:t.res.customer.notify_phone||LANG.profile.unknown,birthday:t.res.customer.birthday?t.res.customer.birthday.slice(0,10):LANG.profile.unknown,sex:a};e.render(s),e.edit(s),e.editAvatar(s.avatar_url),e.renderBar(t.res.customer.customer_level,t.res.customer.total_credit||0)}else new $yhsd.Popup(t.res.message||"<h3>"+LANG.popup.netError+"</h3>",void 0,function(){$(".yhsd-popup-close").filter(".btn-md").on("click",function(){window.location.href="/account"})}).init()})}},accountSecurity={_main:'<div class="account-sideCont-block personal-security yhsd-main-border">    <h3 class="yhsd-form-background yhsd-main-border yhsd-font-title">'+LANG.security.title+'</h3>    <div class="personal-security-change yhsd-form-background yhsd-main-border">        <h5 class="yhsd-font-title">'+LANG.security.password+'<small class="yhsd-font-text">（'+LANG.security.passwordTips+'）</small><a id="yhsd-security-edit" class="btn btn-primary btn-sm" href="javascript:void(0);">'+LANG.security.edit+"</a></h5>    </div>    #{social}</div>",_social_list:'<div id="personal-security-social" class="personal-security-social yhsd-form-background">   <h5 class="yhsd-font-title">'+LANG.security.bindSocial+'<small class="yhsd-font-text">（'+LANG.security.bindSocialTips+"）</small></h5>   <ul>       #{social_items}   </ul></div>",_social_item:'<li#{isCenter}><i class="yhsd-base-iconfont icon-#{type}"></i><span class="yhsd-font-text">#{type_name}<small class="yhsd-font-desc">#{desc}</small></span><a class="btn btn-#{btn} btn-sm" href="#{url}" data-type="#{type_name}">#{btn_desc}</a></li>',_unbind:"",render:function(e){var t=this,a=oGlobalConfig.returnAccountDom("safety").replace(/#\{content\}/g,t._main);if(e.length>0){var s="";$.each(e,function(e,a){var i="";switch(a.type){case"weixin":i=LANG.security.socialType.weixin,d=a.weixin_login_url;break;case"qq":i=LANG.security.socialType.qq,d=a.qq_login_url;break;case"weibo":i=LANG.security.socialType.weibo,d=a.weibo_login_url;break;case"renren":i=LANG.security.socialType.renren,d=a.renren_login_url;break;case"netease":i=LANG.security.socialType.netease,d=a.netease_login_url;break;case"douban":i=LANG.security.socialType.douban,d=a.douban_login_url}if(a.binded)var n=a.name,r=LANG.security.hasbind,o="secondary",d="javascript:void(0);";else n=LANG.security.unbinded,r=LANG.security.toBind,o="primary",d=a.bind_url;var c=1===e||4===e?' class="center"':"";s+=t._social_item.replace(/#\{type\}/g,a.type).replace(/#\{type_name\}/g,i).replace(/#\{url\}/g,d).replace(/#\{btn\}/g,o).replace(/#\{desc\}/g,n).replace(/#\{btn_desc\}/g,r).replace(/#\{isCenter\}/g,c)}),a=a.replace(/#\{social\}/g,t._social_list.replace(/#\{social_items\}/g,s))}else a=a.replace(/#\{social\}/g,"");$(oGlobalConfig.layoutHook).html(a)},edit:function(){var e='<div class="box change-password">    <form class="input-field" id="yhsd-security-inputField" action="javascript:void(0);">        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.security.oldCode+'</div>           <input class="input yhsd-font-text" type="password" name="password" maxlength="200">           <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.security.newCode+'</div>           <input class="input yhsd-font-text" type="password" name="set_password" maxlength="200">           <div class="tips"></div>        </div>        <div class="input-area input-area-lg" data-state="">           <div class="title">'+LANG.security.confirmCode+'</div>           <input class="input yhsd-font-text" type="password" name="confirm_password" maxlength="200">           <div class="tips"></div>        </div>        <div class="ctrl-btns">        <button id="yhsd-security-submit" class="btn btn-md btn-primary" type="submit">'+LANG.security.changeCode+'</button>         <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>     </div>    </form>    </div>";new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.security.changeCode+"</h3>",e,function(){var e=this,t=[{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.security.inputTips.oldCode_empty,active:LANG.security.inputTips.oldCode_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.security.inputTips.newCode_empty,active:LANG.security.inputTips.newCode_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.security.inputTips.confirmCode_empty,active:LANG.security.inputTips.confirmCode_active}}],a=new $yhsd.InputManager("#yhsd-security-inputField",t);a.init(),$("#yhsd-security-inputField").on("submit",function(t){t.stopPropagation(),t.preventDefault();var s={password_old:a.getter(0).value,password:a.getter(1).value,password_again:a.getter(2).value};s.password_old.length<6?0===s.password_old.length?a.setter(0,"error"):a.setter(0,"error",LANG.security.inputTips.oldCode_err):s.password.length<6?0===s.password.length?a.setter(1,"error"):a.setter(1,"error",LANG.security.inputTips.newCode_short):0!==s.password_again.length?s.password===s.password_again?window.Jssdk.account.changePassword(s,function(t){200===t.res.code?(e.close(),setTimeout(function(){new $yhsd.Popup("<h3>"+LANG.security.changeCode+"</h3>",'<div class="box"><div class="title">'+LANG.security.changeSucess+'</div><div class="ctrl-btns"><a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a></div></div>").init()},200)):"当前密码不正确"===t.res.message?a.setter(0,"error",LANG.security.inputTips.oldCode_err):(e.close(),setTimeout(function(){new $yhsd.Popup("<h3>"+LANG.security.changeFail+"</h3>",'<div class="box"><div class="title">'+t.res.message+'</div><div class="ctrl-btns"><a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a></div></div>").init()},200))}):a.setter(2,"error",LANG.security.inputTips.confirmCode_err):a.setter(2,"error")})}).init()},unbind:function(e){var t=e.attr("data-type"),a='<div class="box"><div class="title">'+LANG.security.unbindTips_1+"#{type}"+LANG.security.unbindTips_2+"#{type}"+LANG.security.unbindTips_3+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-unbind-submit" type="submit">'+LANG.security.unbind+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">取消</button></div></div>';a=a.replace(/#\{type\}/g,t);new $yhsd.Popup("<h3>"+LANG.security.unbind+"</h3>",a,function(){$("#yhsd-unbind-submit").on("click",function(){})}).init()},init:function(){var e=this;Jssdk.account.current(function(t){if(200===t.res.code){e.render(t.res.customer.social_accounts),$("#yhsd-security-edit").on("click",function(){e.edit()});var a=$("#personal-security-social");a.length>0&&a.on("click",".btn",function(){$(this).attr("href")})}else(new $yhsd.Popup).init()})}},accountAddress={_main:'<div class="account-sideCont-block personal-address yhsd-form-background yhsd-main-border">    <h3 class="yhsd-font-title">'+LANG.address.title+'</h3>    <div class="personal-address-table">        #{main_cont}    </div></div>',_item:'<tr class="address-item" data-id="#{id}">    <td class="shipment">        <div class="shipment-receiver yhsd-font-title"><span class="name">#{name}</span><span class="phone">#{phone}</span></div>        <div class="shipment-address yhsd-font-text"><span class="province">#{province}</span><span class="city">#{city}</span><span class="area">#{district}</span><span class="street">#{detail}</span></div>    </td>    <td class="default-address#{is_default}"><a href="javascript:void(0);" class="yhsd-font-desc">#{default}</a></td>    <td class="edit"><a href="javascript:void(0);" class="yhsd-font-desc">'+LANG.address.edit+'</a></td>    <td class="delete"><a href="javascript:void(0);" class="yhsd-font-desc">'+LANG.address.remove+"</a></td></tr>",_address:'<div class="box add-address">    <form class="input-field" id="yhsd-address-inputField" action="javascript:void(0);">        <div class="input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.name+'<span> *</span></div>            <input id="yhsd-address-name" class="input yhsd-font-text" type="text" name="detail" maxlength="200">            <div class="tips"></div>        </div>        <div class="tel input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.mobile+'<span> *</span></div>            <input id="yhsd-address-mobile" class="input yhsd-font-text" type="text" name="detail" maxlength="200">            <div class="tips"></div>        </div>        <div class="select-group">           <div id="yhsd-area-selection" class="yhsd-font-text"></div>           <div class="tips">'+LANG.address.inputTips.area_err+'</div>           <input id="yhsd-area-selection-code" type="hidden" name="areacode">        </div>        <div class="full input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.detail+'<span> *</span></div>            <input id="yhsd-address-detail" class="input yhsd-font-text" type="text" maxlength="200">            <div class="tips"></div>        </div>        <div class="full input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.zipcode+'</div>            <input id="yhsd-address-zipcode" class="input yhsd-font-text" type="text" maxlength="200">            <div class="tips"></div>        </div>        <div class="checkbox-group">           <label for="yhsd-is_default" class="yhsd-font-text"><span class="checkbox-btn"></span>'+LANG.address.typeName.setDefault+'</label>           <input type="checkbox" name="is_default" id="yhsd-is_default">        </div>        <div class="ctrl-btns">            <button id="yhsd-address-edit-submit" class="btn btn-md btn-primary" type="submit">'+LANG.popup.submit+'</button>            <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>        </div>    </form></div>",render:function(){var e=this,t='<table>     <thead>         <tr><th colspan="4"><a id="yhsd-address-addBtn" class="btn btn-#{is_primary} btn-md" href="javascript:void(0);"><i class="yhsd-base-iconfont icon-add-m"></i>'+LANG.address.createTitle+"</a></th></tr>     </thead>     <tbody>         #{list}    </tbody></table>",a='<div class="empty-table">   <p>'+LANG.address.empty+'</p>   <a id="yhsd-address-addBtn" class="btn btn-primary btn-sm" href="javascript:void(0);"><i class="yhsd-base-iconfont icon-add-m"></i>'+LANG.address.createTitle+"</a>",s=oGlobalConfig.returnAccountDom("address").replace(/#\{content\}/g,e._main);if(e.cache.length>0){s=s.replace(/#\{main_cont\}/g,t);var i="";$.each(e.cache,function(t,a){var s=e._item.replace(/#\{name\}/g,a.name).replace(/#\{id\}/g,a.id).replace(/#\{phone\}/g,$yhsd.Util.securePhone(a.mobile)).replace(/#\{default\}/g,a.is_default?LANG.address.defaultAddress:LANG.address.typeName.setDefault).replace(/#\{is_default\}/g,a.is_default?" default":"").replace(/#\{province\}/g,a.location_full_titles.split(",")[0]).replace(/#\{city\}/g,a.location_full_titles.split(",")[1]).replace(/#\{district\}/g,a.location_full_titles.split(",")[2]||"").replace(/#\{detail\}/g,a.detail);a.is_default?i=s+i:i+=s}),s=s.replace(/#\{list\}/g,i).replace(/#\{is_primary\}/g,e.cache.length<20?"primary":"disabled")}else s=s.replace(/#\{main_cont\}/g,a);$(oGlobalConfig.layoutHook).html(s)},cache:null,setter:function(e,t){var a=this,s=function(e){var t=null;return $.each(a.cache,function(a,s){s.id!=e||(t=s)}),t};switch(e){case"def":!function(){var e=s(t);oSend={id:e.id,name:e.name,district_code:e.district_code,detail:e.detail,mobile:e.mobile,is_default:!0};var i='<div class="box"><div class="title yhsd-font-text">'+LANG.address.defaultTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-address-default-submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close">'+LANG.popup.cancel+"</button></div></div>",n=new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.address.defaultTitle+"</h3>",i,function(){$("#yhsd-address-default-submit").on("click",function(){window.Jssdk.address.save(oSend,function(){n.close(),a.init()})})});n.init()}();break;case"remove":!function(e){var t='<div class="box"><div class="title yhsd-font-text">'+LANG.address.removeTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-address-delete-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",s=new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.address.removeTitle+"</h3>",t,function(){$("#yhsd-address-delete-submit").on("click",function(){window.Jssdk.address.remove({id:e},function(){s.close(),a.init()})})});s.init()}(t);break;default:!function(e,t){var i,n=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.name_empty,active:LANG.address.inputTips.name_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.mobile_empty,active:LANG.address.inputTips.mobile_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.detail_empty,active:LANG.address.inputTips.detail_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.zipcode_empty,active:LANG.address.inputTips.zipcode_active}}],r=a._address,o=function(e,i){var r=new $yhsd.InputManager("#yhsd-address-inputField",n);r.init(),$yhsd.CheckBtn.init("#yhsd-address-inputField .checkbox-group");var o={id:"yhsd-area-selection",addClass:"yhsd-select",field:"areacode"};if(yhsdAddressConfig)for(key in yhsdAddressConfig)o[key]=yhsdAddressConfig[key];i&&(oData=s(t),r.setVal(0,oData.name),r.setVal(1,oData.mobile),r.setVal(2,oData.detail),r.setVal(3,oData.zipcode),oData.is_default&&$("#yhsd-is_default").prev().trigger("click"),o.initCode=oData.district_code),new yhsdAreaSelection(o),$("#yhsd-address-inputField").on("submit",function(s){s.stopPropagation(),s.preventDefault();var i={id:t,name:r.getter(0).value,mobile:r.getter(1).value,district_code:$("#yhsd-area-selection-code").val()||$("#yhsd-area-selection").children().last().val(),detail:r.getter(2).value,zipcode:r.getter(3).value,is_default:$("#yhsd-is_default").prop("checked")};i.name?$yhsd.Util.checkAddressMobile(!0,i.mobile)?i.district_code?i.detail?(0===a.cache.length&&(i.is_default=!0),window.Jssdk.address[e](i,function(e){c.close(),a.init()})):r.setter(2,"error"):$("#yhsd-area-selection").parent().addClass("error").on("click",function(){$(this).removeClass("error")}):r.setter(1,"error"):r.setter(0,"error")})};if("new"===e){i='<h3 class="yhsd-font-title">'+LANG.address.createTitle+"</h3>";var d=function(){o("create",!1)}}else s(t),i='<h3 class="yhsd-font-title">'+LANG.address.editTitle+"</h3>",d=function(){o("save",!0)};var c=new $yhsd.Popup(i,r,d);c.init()}(e,t)}},init:function(){var e=this;window.Jssdk.address.get(function(t){200===t.res.code&&(e.cache=t.res.addresses,e.render(),$("#yhsd-address-addBtn").on("click",function(){if($(this).hasClass("btn-disabled"))return!1;e.setter("new")}),$(".address-item").find(".edit a").on("click",function(){var t=$(this).closest(".address-item");e.setter("edit",t.attr("data-id"))}),$(".address-item").find(".default-address a").on("click",function(){if($(this).parent().hasClass("default"))return!1;var t=$(this).closest(".address-item");e.setter("def",t.attr("data-id"))}),$(".address-item").find(".delete a").on("click",function(){var t=$(this).closest(".address-item");e.setter("remove",t.attr("data-id"))}))})}},accountCoupon={_main:'<div class="account-sideCont-block account-coupon yhsd-main-border">    <h3 class="yhsd-font-title yhsd-form-background">'+LANG.coupon.title+'</h3>    <ul id="yhsd-coupon-tags" class="account-tags yhsd-form-background yhsd-main-border">        <li data-tag="pending" class="selected"><a class="yhsd-font-title" href="javascript:void(0);">'+LANG.coupon.pending+'</a></li>        <li data-tag="used"><a class="yhsd-font-title" href="javascript:void(0);">'+LANG.coupon.used+'</a></li>        <li data-tag="expired"><a class="yhsd-font-title" href="javascript:void(0);">'+LANG.coupon.expired+'</a></li>    </ul>    <div class="account-coupon-table yhsd-main-border yhsd-form-background">        <table>            <thead>                <tr>                    <th class="title yhsd-main-border">'+LANG.coupon.title+'</th>                    <th class="name yhsd-main-border">'+LANG.coupon.name+'</th>                    <th class="rules yhsd-main-border">'+LANG.coupon.rules+'</th>                    <th class="status yhsd-main-border">'+LANG.coupon.status+'</th>                    <th class="code yhsd-main-border">'+LANG.coupon.code+'</th>                    <th class="indate yhsd-main-border">'+LANG.coupon.indate+'</th>                </tr>            </thead>            <tbody id="yhsd-coupon-list">               #{coupon_tr}            </tbody>        </table>    </div></div>',_loading:'<tr class="account-coupon-loading"><td colspan="6">'+LANG.coupon.loading+"</td></tr>",_coupon_tr:'<tr>    <td class="coupon-icon yhsd-main-border yhsd-font-text""><div><span>#{discount}</span><small>#{limit}</small></div></td>    <td class="coupon-name yhsd-main-border yhsd-font-text"">#{name}</td>    <td class="coupon-rules yhsd-main-border yhsd-font-text">#{limit}</td>    <td class="coupon-valid yhsd-main-border yhsd-font-text"">#{status}</td>    <td class="coupon-no yhsd-main-border yhsd-font-text"">#{code}</td>    <td class="coupon-date yhsd-main-border yhsd-font-text"">#{term}</td></tr>',render:function(){var e=oGlobalConfig.returnAccountDom("coupon").replace(/#\{content\}/g,this._main);e=e.replace(/#\{coupon_tr\}/g,this._loading),$(oGlobalConfig.layoutHook).html(e)},fetchData:function(e){var t=this;this.setData(!0),window.Jssdk.coupon.get(function(a){(a.res.code=200)?t.setData(!1,a.res.coupons,e):alert(LANG.popup.netError)})},setData:function(e,t,a){var s=this,i="";e?i=s._loading:$.each(t,function(e,t){if(t.status===a){i+=s._coupon_tr.replace(/#\{code\}/g,t.code).replace(/#\{name\}/g,t.coupon_group_name).replace(/#\{status\}/g,function(){return"pending"===t.status?LANG.coupon.pending:"expired"===t.status?LANG.coupon.expired:LANG.coupon.used}).replace(/#\{term\}/g,function(){return t.no_expires?t.actived_at.slice(0,10)+" 至 "+LANG.coupon.expire_forever:t.actived_at.slice(0,10)+" 至 "+t.expired_at.slice(0,10)}).replace(/#\{limit\}/g,function(){return 0===t.active_amount?LANG.coupon.nolimit:t.discount_amount?LANG.coupon.discount_off.replace(/#\{active\}/g,t.active_amount/100).replace(/#\{amount\}/g,t.discount_amount/100):LANG.coupon.percentage_off.replace(/#\{active\}/g,t.active_amount/100).replace(/#\{percentage\}/g,t.discount_percentage/10)}).replace(/#\{discount\}/g,function(){return t.discount_amount?LANG.currency+t.discount_amount/100:t.discount_percentage/10+LANG.coupon.percentage})}}),0===i.length&&(i='<tr class="account-coupon-loading"><td colspan="6">'+LANG.coupon.notFind+"</td></tr>"),$("#yhsd-coupon-list").html(i)},init:function(){var e=this;e.render(),e.fetchData("pending"),$("#yhsd-coupon-tags").children("li").on("click",function(){$(this).addClass("selected").siblings().removeClass("selected");e.fetchData($(this).attr("data-tag"))})}},accountPoints={_main:'<div class="account-sideCont-block account-points yhsd-main-border">    <h3 class="yhsd-font-title yhsd-form-background">'+LANG.points.title+'</h3>    <div class="intro yhsd-form-background">        <div class="avail-points">'+LANG.points.useTitle+'<span id="account-points-total" class="yhsd-font-title">0</span></div>        <div class="will-expire yhsd-font-text"><small></small>'+LANG.points.expiredTitle+'<span id="account-points-expire">0</span>'+LANG.points.title+'</div>    </div>    <ul id="yhsd-points-tags" class="account-tags yhsd-main-border yhsd-form-background">        <li class="selected"><a data-tag="detail" href="javascript:void(0);" class="yhsd-font-title">'+LANG.points.detail+'</a></li>        <li><a data-tag="input" href="javascript:void(0);" class="yhsd-font-title">'+LANG.points.input+'</a></li>        <li><a data-tag="output" href="javascript:void(0);" class="yhsd-font-title">'+LANG.points.output+'</a></li>    </ul>    <div class="account-points-table yhsd-form-background yhsd-main-border yhsd-font-text">        <table>            <thead>                <tr>                    <th class="date">'+LANG.points.date+'</th>                    <th class="io">'+LANG.points.io+'</th>                    <th class="status">'+LANG.points.detail_desc+'</th>                    <th class="record">                        <select id="yhsd-points-select" class="yhsd-form-background">                            <option value="1">'+LANG.points.latest_desc+'</option>                            <option value="0">'+LANG.points.before_desc+'</option>                        </select>                    </th>                </tr>            </thead>            <tbody id="yhsd-points-list" class="yhsd-main-border">               #{points_tr}            </tbody>        </table>    </div>   <div class="description yhsd-form-background yhsd-main-border">       <h4 class="yhsd-font-title">'+LANG.points.descTitle+'</h4>       <ol class="yhsd-font-desc">           <li>'+LANG.points.desc_1+"</li>           <li>"+LANG.points.desc_2+"</li>           <li>"+LANG.points.desc_3+"</li>       </ol>   </div></div>",_empty:'<tr class="account-points-empty"><td colspan="4">'+LANG.points.empty+"</td></tr>",_loading:'<tr class="account-points-empty"><td colspan="4">'+LANG.points.loading+"</td></tr>",oCache:{data:null,curTag:"detail",newest:!0},changeTag:function(){var e=this;$("#yhsd-points-tags").on("click","a",function(){$(this).parent().addClass("selected").siblings().removeClass("selected"),e.oCache.curTag=$(this).attr("data-tag"),e.render(e.oCache.data)})},changeRange:function(){var e=this;$("#yhsd-points-select").on("change",function(){e.oCache.newest="1"===$(this).val(),e.getData()})},render:function(e){var t=this,a=$("#yhsd-points-list");if(e){var s=new Date;if($("#account-points-expire").html(e.last_year_point).prev("small").html(s.getFullYear()+".12.31"),$("#account-points-total").html(e.reward_point_total),0===e.reward_point_details.length)a.html(t._empty);else{var i=[];if($.each(e.reward_point_details,function(e,a){"input"===t.oCache.curTag&&a.point<0||"output"===t.oCache.curTag&&a.point>0||i.push(a)}),0===i.length)a.html(t._empty);else{var n="";$.each(i,function(e,t){n+='<tr class="account-points-tr"><td class="date">#{created_at}</td><td class="io #{in_out}">#{point}</td><td class="status" colspan="2">#{desc}</td></tr>'.replace(/#\{created_at\}/g,$yhsd.Util.serializeDate(t.created_at,!0)).replace(/#\{in_out\}/g,t.point>0?"in":"out").replace(/#\{point\}/g,t.point>0?"+"+t.point:t.point).replace(/#\{desc\}/g,t.reward_point_desc||"-")}),a.html(n)}}}else a.html('<tr class="account-points-empty"><td colspan="4">'+LANG.points.disabled+"</td></tr>")},getData:function(){var e=this,t={nopage:"Y"};e.oCache.newest?t.last_three_month=!0:t.three_month_ago=!0,Jssdk.reward_point.get(function(a){200===a.res.code&&a.res.enabled?Jssdk.account.rewardPointDetails(t,function(t){200===t.res.code&&(e.oCache.data=t.res,e.render(t.res))}):e.render(!1)})},init:function(){var e=oGlobalConfig.returnAccountDom("points").replace(/#\{content\}/g,this._main);e=e.replace(/#\{points_tr\}/g,this._loading),$(oGlobalConfig.layoutHook).html(e),this.changeRange(),this.changeTag(),this.getData()}},orderPayment={_main:'<div class="wrapper" id="order-pay-wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.orderPayment.title+'</h2>        <div class="order-wrapper yhsd-main-border">            <div class="order-block order-paying yhsd-form-background yhsd-main-border">                <div class="info">                    <div>'+LANG.orderPayment.amountPay+'：<span class="price">'+LANG.currency+'#{total_amount}</span></div>                    <div class="show-more" id="order-paying-show">'+LANG.orderPayment.orderDetail+'<i class="yhsd-base-iconfont icon-down-mob"></i></div>                </div>                <h3 class="yhsd-font-title">'+LANG.orderPayment.payTips+"</h3>                <div>"+LANG.orderPayment.cancelTips_1+'<span class="price">'+LANG.orderPayment.cancelTips_2+"</span>"+LANG.orderPayment.cancelTips_3+'</div>                <div class="detail yhsd-main-border" id="order-paying-detail">                    <div class="detail-no">'+LANG.orderPayment.orderNo+'：<span class="right">#{order_no}</span></div>                    <div>'+LANG.orderPayment.addressInfo+'：<span class="right">#{order_address}</span></div>                    <div class="detail-msg">                        <div class="left">'+LANG.orderPayment.productInfo+'：</div>                        <div class="right">                           #{order_products}                        </div>                    </div>                </div>            </div>            <div class="order-block order-banks yhsd-form-background yhsd-main-border">                <h4 class="yhsd-font-title yhsd-main-border">'+LANG.orderPayment.payMethodTips+'</h4>                   <div id="order-pay-methods" class="loading">'+LANG.orderPayment.loadingMethods+'</div>                <div class="submit yhsd-font-text"><a id="order-pay-go" href="javascript:void(0)" class="btn btn-lg btn-vital">'+LANG.orderPayment.payBtn+"</a>"+LANG.orderPayment.amountPay+'：<span class="price">'+LANG.currency+"#{total_amount}</span></div>            </div>        </div>    </div></div>",render:function(){var e=this,t=e.cache.oData,a=$("#content_for_layout");a.fadeOut(200,function(){var s="",i="",n="<div>#{name} #{sku} "+LANG.currency+"#{price} × #{quantity}</div>";e.cache.isLogin?($.each(t.address.areas,function(e,t){s+=t.name}),$.each(t.shipments,function(e,t){$.each(t.line_items,function(e,t){i+=n.replace(/#\{name\}/g,t.name).replace(/#\{sku\}/g,t.options_desc||"").replace(/#\{price\}/g,$yhsd.Util.yuan(t.price)).replace(/#\{quantity\}/g,t.quantity)})})):(s=t.address.location_full_titles,$.each(t.shipments,function(e,t){i+=n.replace(/#\{name\}/g,t.name).replace(/#\{sku\}/g,t.options_desc||"").replace(/#\{price\}/g,$yhsd.Util.yuan(t.price)).replace(/#\{quantity\}/g,t.quantity)}));var r="<span>"+t.address.name+"</span><span>"+t.address.mobile+"</span><span>"+s+"</span><span>"+t.address.detail+"</span>",o=e._main.replace(/#\{order_no\}/g,t.order_no).replace(/#\{total_amount\}/g,$yhsd.Util.yuan(t.total_amount)).replace(/#\{order_address\}/g,r).replace(/#\{order_products\}/g,i);$(o).insertAfter(a),e.renderMehods(),$(window).on("hashchange",function(){""===window.location.hash&&($("#order-pay-wrapper").remove(),a.fadeIn(200))})})},renderMehods:function(){var e=this;Jssdk.payment_method.get({},function(t){if(200===t.res.code){var a="",s=!0;$.each(t.res.payment_method.online.methods,function(t,i){if(i.length>0){var n='<div><h5 class="yhsd-font-title">'+LANG.orderPayment.bandTitle+"</h5><ul>";"thirdparty"===t&&(n='<div><h5 class="yhsd-font-title">'+LANG.orderPayment.thirdPayTitle+'<small class="yhsd-font-text">（'+LANG.orderPayment.thirdPayTitle_2+"）</small></h5><ul>"),$.each(i,function(t,a){var i="";s&&(e.cache.payment_method_id=a.id,e.cache.bank_code_id=a.bank_code_id||"",i=" selected",s=!1),n+='<li class="#{class}#{is_selected}" data-code="#{code}" data-id="#{id}">#{desc}</li>'.replace(/#\{class\}/g,a.pay_type).replace(/#\{code\}/g,a.bank_code_id||"").replace(/#\{is_selected\}/g,i).replace(/#\{id\}/g,a.id).replace(/#\{desc\}/g,a.desc)}),a+=n+="</ul></div>"}}),$("#order-pay-methods").html(a).removeClass("loading"),e.userEvent()}})},cache:{isLogin:!0,oData:null,payment_method_id:"",bank_code_id:"",order_no:""},userEvent:function(){var e=this,t=$("#order-pay-methods").find("li");$("#order-pay-methods").on("click","li",function(){t.removeClass("selected"),$(this).addClass("selected"),e.cache.payment_method_id=$(this).attr("data-id"),e.cache.bank_code_id=$(this).attr("data-code")}),$("#order-paying-show").on("click",function(){$(this).children("i").toggleClass("icon-right-up icon-down-mob"),$("#order-paying-detail").toggleClass("active").children(".detail-no").slideToggle(200).siblings(".detail-msg").slideToggle(200)}),$("#order-pay-go").on("click",function(){var t="/payment/go_pay?order_no="+e.cache.order_no+"&payment_method_id="+e.cache.payment_method_id;e.cache.bank_code_id&&(t+="&bank_code_id="+e.cache.bank_code_id);var a='<div class="box order-paying">   <div class="left">       <div class="bg"></div>       <div>'+LANG.orderPayment.paySucess+'</div>       <a href="/account/orders/'+e.cache.order_no+'" class="btn btn-primary btn-sm">'+LANG.orderPayment.paySucessBtn+'</a>   </div>   <div class="right">       <div class="bg"></div>       <div>'+LANG.orderPayment.payFail+'</div>       <a href="'+window.location.pathname+'" class="btn btn-secondary btn-sm">'+LANG.orderPayment.payFailBtn+"</a>   </div></div>";window.open(t),new $yhsd.Popup("<h3>"+LANG.orderPayment.paying+"</h3>",a,function(){},!0).init()})},init:function(e,t){var a=this;a.cache.order_no=e,window.location.hash="pay",t?(a.cache.oData=t,a.cache.oData.order_no=e,a.cache.isLogin=!1,a.render()):Jssdk.order.get({order_no:e},function(e){200===e.res.code?0===e.res.orders[0].status&&0===e.res.orders[0].payment_status&&0===e.res.orders[0].payment_method_type?(a.cache.oData=e.res.orders[0],a.render()):window.location.reload():window.location.href="/account/orders"})}},productDetail={rootId:"#yhsd_variantSelector",eachLinkEl:".pro-detail-sub-each a",priceEl:$("#yhsd_variantSelector_price"),comparePriceEl:$("#yhsd_variantSelector_compare_price"),stockEl:$("#yhsd_variantSelector_stock"),saleEl:$("#yhsd_variantSelector_sale"),variantId:0,nBuyCount:1,countIptEl:"#yhsd_variantSelector_count",countAddEl:"#yhsd_variantSelector_add",countReduceEl:"#yhsd_variantSelector_reduce",addCartEl:"#yhsd_variantSelector_addCart",succEl:"#yhsd_variantSelector_addSucc",succCloseEl:"#yhsd_variantSelector_addSuccClose",errEl:$('<div class="yhsd-variantSelector-err"></div>'),sellout:!1,UnSelClass:"unselected settings-optionUnSelected_color settings-optionUnSelected_border  settings-optionUnSelected_background",DisabledClass:"disabled settings-optionDisabled_color settings-optionDisabled_border  settings-optionDisabled_background",SelClass:"selected settings-optionSelected_color settings-optionSelected_border  settings-optionSelected_background",optionEl:$("#yhsd_variantSelector_optionShow"),init:function(e){var t=this;if(t.orgPriceRange=t.priceEl.html(),t.orgComparePriceRange=t.comparePriceEl.html(),t.data=e,!$(t.rootId)[0]){if(document.body.clientWidth<=768)alert(LANG.productDetail.offSell+"，"+LANG.productDetail.submitAndBack),window.location.href="/products";else{var a='<div class="box"><div class="title">'+LANG.productDetail.submitAndBack+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-noPro-submit" type="submit">'+LANG.popup.submit+"</button></div></div>",s=new $yhsd.Popup("<h3>"+LANG.productDetail.offSell+"</h3>",a,function(){$("#yhsd-noPro-submit").on("click",function(){s.close(),window.location.href="/products"})});s.init()}return!0}var i=0;$.each(t.data.variants,function(e,t){i+=t.stock}),t.orgStock=i,t.stockEl[0]&&t.stockEl.html(i),t.orgSale=0,t.saleEl[0]&&(t.orgSale=t.saleEl.html()),this.skuManager=new $yhsd.SkuManager(this.data),t.initProductOption(),t.optionEl.on("click",".selected",function(e){var a=$(e.currentTarget).parent().parent(),s=Math.floor(a.attr("data-position")),i=a.find(".yhsd-variantSelector-err");i[0]&&i.remove(),t.skuManager.unselect(s),t.onOptionChange()}).on("click",".unselected",function(e){var a=$(e.currentTarget),s=a.parent().parent(),i=Math.floor(s.attr("data-position")),n=s.find(".yhsd-variantSelector-err");n[0]&&n.remove(),t.skuManager.select(i,a.text()),t.onOptionChange()}),$(t.countAddEl).on("click",function(){t.changeCountAdd()}),$(t.countReduceEl).on("click",function(){t.changeCountReduce()}),$(t.countIptEl).on("blur",function(){t.checkNum()}),$(t.addCartEl).on("click",function(){if(t.sellout)if(document.body.clientWidth<=768)alert(LANG.productDetail.selloutTit+"，"+LANG.productDetail.selloutCont);else{var e='<div class="box"><div class="title">'+LANG.productDetail.selloutCont+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-orders-submit" type="submit">'+LANG.popup.submit+"</button></div></div>",a=new $yhsd.Popup("<h3>"+LANG.productDetail.selloutTit+"</h3>",e,function(){$("#yhsd-orders-submit").on("click",function(){a.close()})});a.init()}else t.addCart()}),$(t.succCloseEl).on("click",function(){$(t.succEl).hide()})},initProductOption:function(){var e=this,t={selected:"Selected",unselected:"UnSelected",disabled:"Disabled"};e.data.options&&(e.optionEl.empty(),this.skuManager.get(function(a,s){e.currentVariant=s,$.each(a,function(a,s){var i=$('<div class="pro-detail-sub-each clearfix" data-position="#{optionPosition}"></div>'.replace("#{optionPosition}",a+1)),n=$("<h3>#{optionName}</h3>".replace("#{optionName}",s.name));i.append(n);var r=$('<div class="pro-detail-sub-each-wrap clearfix"></div>');$.each(s.values,function(e,a){var i='<a class="#{state} settings-option#{State}_background settings-option#{State}_border settings-option#{State}_color" data-option-id="#{option_id}" data-option-value="#{optionValue}" href="javascript:void(0);">#{optionValue}</a>'.replace(/#{state}/,a.state).replace(/#{State}/g,t[a.state]).replace(/#{optionValue}/g,a.name).replace(/#{option_id}/,s.id);r.append($(i))}),i.append(r),e.optionEl.append(i)})})),e.changeVariant()},onOptionChange:function(){var e=this,t={selected:this.SelClass,unselected:this.UnSelClass,disabled:this.DisabledClass};function a(e){var t,a,s;return a={},s={},function(e){var i,n,r=[],o=[];for(i in e)n=e[i],s[i]=n,a[n]=i,r.push(n),o.push(i);new RegExp("("+r.join("|")+")","g"),t=new RegExp("("+o.join("|")+"|&#[0-9]{1,5};)","g")}({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"}),function(e){return e?String(e).replace(t,function(e,t){return t in s?s[t]:String.fromCharCode(parseInt(t.substr(2),10))}):e}(e)}this.skuManager.get(function(s,i,n){var r,o;if(e.currentVariant=i,n)for(r=0;r<n.length;r++)if(n[r].values.length>0)for(o=0;o<n[r].values.length;o++)e.optionEl.find('[data-option-id="'+n[r].id+'"][data-option-value="'+a(n[r].values[o].name)+'"]').removeClass(t.selected+" "+t.unselected+" "+t.disabled).addClass(t[n[r].values[o].state])}),e.changeVariant()},addCart:function(){var e=this;if(0!==e.variantId){var t={variant_id:e.variantId,quantity:e.nBuyCount,is_check:!0};Jssdk.cart.add(t,function(t){if(200==t.res.code||212==t.res.code)e.addCartDone(),$(e.succEl).fadeOut(100,function(){$(e.succEl).fadeIn(300)});else{var a=LANG.productDetail.unableBuy;t.res&&t.res.desc&&(a=t.res.desc||a);var s='<div class="box"><div class="title">'+a+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" type="submit">'+LANG.popup.submit+"</button></div></div>";new $yhsd.Popup("<h3>"+LANG.productDetail.unableAdd+"</h3>",s).init()}})}else{var a=$(".pro-detail-sub-each");$.each(a,function(t,a){var s=$(a).find('a[class~="selected"]'),i=$(a).find(".yhsd-variantSelector-err");if(!s[0]&&!i[0]){var n=e.errEl.clone(),r=$(a).find("h3").html();n.html("请选择 "+r),$(a).append(n)}})}},addCartDone:function(){Jssdk.events.publish("getTopCart")},changeVariant:function(){this.currentVariant?this.showVariant(this.currentVariant.id,this.currentVariant.price,this.currentVariant.compare_price,this.currentVariant.sale,this.currentVariant.stock,this.currentVariant.feature_image,this.currentVariant.stock_type):this.showVariant()},showVariant:function(e,t,a,s,i,n,r){this.variantId=e||0,$(this.rootId).attr("data-variantId",e||0),$(this.rootId+"_price").html("number"!=typeof t?this.orgPriceRange:$yhsd.Util.yuan(t)),$(this.rootId+"_compare_price").html("number"!=typeof a?this.orgComparePriceRange:$yhsd.Util.yuan(a)),$(this.rootId+"_compare_price").parent().show(),arguments.length>0&&t!==a&&0!==a||$(this.rootId+"_compare_price").parent().hide();var o=s;void 0===o&&(o=this.orgSale),this.saleEl.html(o);var d=i;if(0===this.variantId&&(d=this.orgStock),void 0!==d){switch(r){case"A":this.sellout=!1,$(this.rootId+"_stock").parent().hide();break;case"B":this.sellout=!(d>=1),$(this.rootId+"_stock").parent().show()}$(this.rootId+"_stock").html(d)}if(this.checkNum(),Jssdk&&Jssdk.events){var c={isFind:!1,stock:d,sale:o};arguments&&arguments.length>0&&(c.isFind=!0,c.id=e,c.price=t,c.compare_price=a,c.feature_image=n,c.stock_type=r),Jssdk.events.publish("variantSelector.changed",c)}if(n){var l=$('.pro-detail-gallery-list a img[src*="'+n.image_id+'/"]');if(l[0]){var p=$(l[0]).parent();if("A"==p.prop("tagName")){try{p.click()}catch(e){}Jssdk&&Jssdk.events&&Jssdk.events.publish("variantSelector.featureImage",{image_id:n.image_id,parent:p})}}}},changeCountAdd:function(){var e=this.nBuyCount-0+1;this.checkNum(e)},changeCountReduce:function(){var e=this.nBuyCount-1;e<2&&(e=1),this.checkNum(e)},checkNum:function(e){var t=Math.floor($(this.countIptEl).val());e&&(t=e),t-=0;var a=999;if(a=0===this.variantId?this.data.stock-0:this.currentVariant.stock-0,t<1&&(t=1),t>99999&&(t=99999),0!==this.variantId)switch(this.currentVariant.stock_type){case"A":$.isNumeric(t)&&t+""!="NaN"&&(this.nBuyCount=t);break;case"B":t>=a&&(t=a),$.isNumeric(t)&&t+""!="NaN"&&t<=a&&(this.nBuyCount=t)}$(this.countIptEl).val(this.nBuyCount)}},orderList={_main:'<div class="account-sideCont-block account-orderList yhsd-main-border">    <h3 class="yhsd-font-title yhsd-form-background">'+LANG.orderList.title+'</h3>    <ul class="account-tags yhsd-form-background yhsd-main-border" id="yhsd-orderList-nav">        <li data-type="all" class="selected"><a href="javascript:void(0);" class="yhsd-font-title">'+LANG.orderList.nav_all+'<span id="order-nav-all" class="yhsd-font-desc">0</span></a></li>        <li data-type="pay"><a href="javascript:void(0);" class="yhsd-font-title">'+LANG.orderList.nav_pay+'<span id="order-nav-topay" class="yhsd-font-desc">0</span></a></li>        <li data-type="confirm"><a href="javascript:void(0);" class="yhsd-font-title">'+LANG.orderList.nav_ship+'<span id="order-nav-torec" class="yhsd-font-desc">0</span></a></li>        <li data-type="done"><a href="javascript:void(0);" class="yhsd-font-title">'+LANG.orderList.nav_done+'<span id="order-nav-done" class="yhsd-font-desc">0</span></a></li>        <li class="search"><i class="yhsd-base-iconfont icon-search-mob"></i><form id="yhsd-orderList-search" action="javascript:void(0);"><input class="yhsd-font-text yhsd-main-border" type="search" placeholder="'+LANG.orderList.searchTips+'"></form></li>    </ul>    <ul id="yhsd-orderList" class="account-orderList-list">       <li><div class="list-title" style="height: 200px;line-height: 200px;text-align: center;border-bottom:none;">'+LANG.orderList.loading+'</div></li>    </ul></div><ul class="account-page" id="account-page-nav"></ul>',_line:'<li class="yhsd-main-border yhsd-form-background">    <div class="list-title yhsd-main-border">        <h4 class="yhsd-font-title">#{status_desc}</h4>        <b class="yhsd-font-title">#{created_at}</b><span class="yhsd-font-text">'+LANG.orderList.orderNo+'：#{order_no}</span><span class="yhsd-font-text">#{payment_method_type}</span>        <div class="total yhsd-font-text">'+LANG.orderList.totalAmount+'：<b class="yhsd-font-title">'+LANG.currency+'#{total_price}</b></div>    </div>  <div class="list-cont" data-no="#{order_no}">    <div class="list-cont-left yhsd-main-border">#{order_groups}</div>    <div class="list-cont-right">        #{btns}    </div>  </div></li>',_item:'<div class="list-cont-item" data-vid="#{variant_id}">   <div class="image"><img src="#{src}" alt="#{product_name}"></div>   <a href="#{url}" class="list-cont-item-name yhsd-font-text" target="_blank">#{product_name}<small>#{skus}</small></a>   <div class="list-cont-item-price yhsd-font-text">'+LANG.currency+"#{unit_price} × #{quantity}</div></div>",_loading:'<li class="empty yhsd-main-border yhsd-form-background"><div class="list-title yhsd-font-text">'+LANG.orderList.loading+"</div></li>",_empty:'<li class="empty yhsd-main-border yhsd-form-background"><div class="list-title yhsd-font-text">'+LANG.orderList.notFind+"</div></li>",renderList:function(e){var t=this,a=$("#yhsd-orderList");if(a.empty(),0===e.length)a.html(t._empty);else{var s=function(e){var t=e;switch(e){case"支付过期":t=LANG.orderList.order_expire;break;case"等待付款":t=LANG.orderList.order_unpay;break;case"等待配送":t=LANG.orderList.order_ship;break;case"正在配送":case"配送中":t=LANG.orderList.order_shipping;break;case"订单完成":t=LANG.orderList.order_done;break;case"已取消":t=LANG.orderList.order_cancel;break;case"未发货":t=LANG.orderList.order_unship;break;case"已签收":t=LANG.orderList.order_receive;break;case"订单退单中":t=LANG.orderList.order_refunding;break;case"退单完成":t=LANG.orderList.order_refund}return t};$.each(e,function(e,i){var n="";$.each(i.shipments,function(e,a){var r='<div class="list-cont-items-group yhsd-main-border" data-id="'+a.id+'">',o='<div class="list-cont-items-status yhsd-font-text"><div>'+LANG.orderList.package+ +a.serial_number+'</div><a href="javascript:void(0);" class="link">'+a.status_desc+"</a>";1==a.status&&(o+='<a href="javascript:void(0);" class="btn btn-xs btn-primary yhsd-orders-submit">'+LANG.orderList.confirmOrder+"</a>"),o+="</div>",1===i.shipments.length&&(o='<div class="list-cont-items-status"><a href="javascript:void(0);" class="link">'+s(a.status_desc)+"</a></div>"),r+=o,$.each(a.line_items,function(e,a){var s=Jssdk.util.getImageUrl(a.feature_image.image_id,a.feature_image.image_name,"60x60",a.feature_image.image_epoch),i=a.options_desc?a.options_desc.split(",").join(" / "):"",n=t._item.replace(/#\{src\}/g,s).replace(/#\{url\}/g,a.page_url).replace(/#\{product_name\}/g,a.name).replace(/#\{skus\}/g,i).replace(/#\{variant_id\}/g,a.variant_id).replace(/#\{unit_price\}/g,$yhsd.Util.yuan(a.price)).replace(/#\{quantity\}/g,a.quantity);r+=n}),n+=r+="</div>"});var r="",o='<a href="javascript:void(0);" class="btn btn-sm btn-vital yhsd-orders-pay">'+LANG.orderList.payOrder+"</a>",d='<a href="javascript:void(0);" class="btn btn-sm btn-primary yhsd-orders-submit">'+LANG.orderList.confirmOrder+"</a>",c='<a class="link yhsd-orders-cancel" href="javascript:void(0);">'+LANG.orderList.cancelOrder+"</a>",l='<a class="link yhsd-orders-buyagain" href="javascript:void(0);">'+LANG.orderList.buyAgain+"</a>",p='<a class="link you_comment-target-add" data-order_no="'+i.order_no+'" href="/account/orders/'+i.order_no+'" target="_blank">'+LANG.orderList.orderDetail+"</a>";r=0===i.status?0===i.payment_status&&0==i.shipment_status?o+p+c:2===i.payment_status&&0==i.shipment_status?p+c:1===i.shipments.length?d+p:p:l+p;var u=t._line.replace(/#\{status_desc\}/g,s(i.status_desc)).replace(/#\{payment_method_type\}/g,0===i.payment_method_type?LANG.orderList.payOnline:LANG.orderList.payOffline).replace(/#\{order_no\}/g,i.order_no).replace(/#\{created_at\}/g,$yhsd.Util.serializeDate(i.created_at)).replace(/#\{total_price\}/g,$yhsd.Util.yuan(i.total_amount)).replace(/#\{btns\}/g,r).replace(/#\{order_groups\}/g,n);a.append(u)}),t.userEvent()}t.renderPages(),Jssdk.events.publish("component.render.completed")},renderPages:function(){for(var e=this,t=e.curState.pages,a="",s=1;s<t.pages+1;s++)t.view===s?a+='<li class="selected">'+s+"</li>":a+="<li>"+s+"</li>";var i='<li class="arrow-left#{allow_left}"><i class="yhsd-base-iconfont icon-left-mob"></i></li>#{other}<li class="arrow-right#{allow_right}"><i class="yhsd-base-iconfont icon-right-mob"></i></li>';i=i.replace(/#\{allow_left\}/g,t.view<2?" disabled":"").replace(/#\{allow_right\}/g,t.view===t.pages?" disabled":"").replace(/#\{other\}/g,a),$("#account-page-nav").html(i),$("#account-page-nav").off(),$("#account-page-nav").on("click","li",function(){if(!$(this).hasClass("selected")&&!$(this).hasClass("disabled")){var t=$(this).html();$(this).hasClass("arrow-left")?t=$(this).siblings(".selected").html()-1:$(this).hasClass("arrow-right")&&(t=+$(this).siblings(".selected").html()+1);var a={size:20,page:t},s=e.curState.type;"pay"===s?(a.status=0,a.payment_status=0):"confirm"===s?(a.status=0,a.payment_status=2):"done"===s&&(a.status=4),e.getData(a)}})},tagNav:function(e){var t=this;$("#yhsd-orderList-nav").children("li").not(":last").on("click",function(){$(this).addClass("selected").siblings("li").removeClass("selected");var e={size:20,page:1},a=$(this).attr("data-type");t.curState.type=a,"pay"===a?(e.status=0,e.payment_status=0):"confirm"===a?(e.status=0,e.payment_status=2):"done"===a&&(e.status=4),t.getData(e)})},search:function(){var e=this;$("#yhsd-orderList-search").on("submit",function(t){t.stopPropagation(),t.preventDefault();var a=$(this).children("input").val();$.trim(a)&&e.getData(a,!0)})},userEvent:function(){var e=this;$("#yhsd-orderList").on("click",".yhsd-orders-cancel",function(){var t={order_no:$(this).closest(".list-cont").attr("data-no"),reason:""},a='<div class="box order-detail">    <div class="title">'+LANG.orderList.cancelReason.tips_1+'<span class="warning">'+LANG.orderList.cancelReason.tips_2+"</span>"+LANG.orderList.cancelReason.tips_3+"</div>    <div>        <h4>"+LANG.orderList.cancelReason.title+'：</h4>        <div class="checkbox-group" id="yhsd-cancel_reason">            <label for="cancel_reason1"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_1+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason1" data-reason="'+LANG.orderList.cancelReason.reason_1+'">            <label for="cancel_reason2"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_2+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason2" data-reason="'+LANG.orderList.cancelReason.reason_2+'">            <label for="cancel_reason3"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_3+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason3" data-reason="'+LANG.orderList.cancelReason.reason_3+'">            <label for="cancel_reason4"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_4+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason4" data-reason="'+LANG.orderList.cancelReason.reason_4+'">            <label for="cancel_reason5"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_5+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason5" data-reason="'+LANG.orderList.cancelReason.reason_5+'">            <label for="cancel_reason6"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_6+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason6" data-reason="'+LANG.orderList.cancelReason.reason_6+'">            <label for="cancel_reason7"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_7+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason7" data-reason="'+LANG.orderList.cancelReason.reason_7+'">            <label for="cancel_reason8"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_8+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason8" data-reason="'+LANG.orderList.cancelReason.reason_8+'">            <label for="cancel_reason9"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_9+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason9" data-reason="'+LANG.orderList.cancelReason.reason_9+'">        </div>    </div>    <div class="tips" id="yhsd-order-cancel-tips">'+LANG.orderList.cancelReason.selReason+'</div>    <div class="ctrl-btns">        <button class="btn btn-md btn-primary" id="yhsd-order-cancel-submit" type="submit">'+LANG.orderList.cancelReason.cancel+'</button>        <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>    </div></div>",s=new $yhsd.Popup("<h3>"+LANG.orderList.cancelReason.cancel+"</h3>",a,function(){$yhsd.CheckBtn.init("#yhsd-cancel_reason"),$("#yhsd-modal").on("click",function(){$("#yhsd-order-cancel-tips").fadeOut(200)}),$("#yhsd-order-cancel-submit").on("click",function(a){if(t.reason=$("#yhsd-cancel_reason").find("input:checked").attr("data-reason"),!t.reason)return $("#yhsd-order-cancel-tips").fadeIn(200),void a.stopPropagation();Jssdk.order.cancel(t,function(){s.close(),e.init()})})});s.init()}),$("#yhsd-orderList").on("click",".yhsd-orders-submit",function(){var t,a=$(this).parent();t=a.hasClass("list-cont-right")?a.prev().find(".list-cont-items-group").attr("data-id"):a.parent().attr("data-id");var s={order_no:$(this).closest(".list-cont").attr("data-no"),shipment_id:t},i='<div class="box"><div class="title">'+LANG.orderList.confirmTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-orders-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",n=new $yhsd.Popup("<h3>"+LANG.orderList.confirmOrder+"</h3>",i,function(){$("#yhsd-orders-submit").on("click",function(){Jssdk.order.receive(s,function(t){n.close(),e.init()})})});n.init()}),$("#yhsd-orderList").on("click",".yhsd-orders-pay",function(){var e=$(this).closest(".list-cont").attr("data-no");orderPayment.init(e)}),$("#yhsd-orderList").on("click",".yhsd-orders-buyagain",function(){var e=$(this).closest(".list-cont").find(".list-cont-item"),t=0;$.each(e,function(a,s){var i={quantity:1,is_check:!0};i.variant_id=$(s).attr("data-vid"),Jssdk.cart.add(i,function(a){if(200===a.res.code)++t===e.length&&(window.location.href="/cart");else{var s='<div class="box">    <div class="title">'+LANG.popup.netError+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.orderList.title+"</h3>",s).init()}})})})},getData:function(e,t){var a=this;$("#yhsd-orderList").html(a._loading);var s={};s=t?{order_no:e}:e,Jssdk.order.get(s,function(e){200===e.res.code?(a.curState.pages=e.res.paging,a.renderList(e.res.orders)):308===e.res.code?a.renderList([]):new $yhsd.Popup(e.res.message||"<h3>"+LANG.popup.netError+"</h3>",void 0,function(){$(".yhsd-popup-close").filter(".btn-md").on("click",function(){window.location.reload()})}).init()})},curState:{config:null,type:"all",pages:null},init:function(){var e=oGlobalConfig.returnAccountDom("order").replace(/#\{content\}/g,this._main);$(oGlobalConfig.layoutHook).off(),$(oGlobalConfig.layoutHook).html(e),Jssdk.order.count(function(e){$("#order-nav-all").html(e.res.count)}),Jssdk.order.count({payment_status:0,status:0},function(e){$("#order-nav-topay").html(e.res.count)}),Jssdk.order.count({payment_status:2,status:0},function(e){$("#order-nav-torec").html(e.res.count)}),Jssdk.order.count({status:4},function(e){$("#order-nav-done").html(e.res.count)}),this.getData({size:20,page:1}),this.tagNav(),this.search()}},orderDetail={_main:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.orderDetail.title+'</h2>        <div class="order-wrapper order-detail yhsd-main-border" data-no="#{order_no}">            <div class="order-block order-detail-no yhsd-main-border yhsd-form-background yhsd-font-text">'+LANG.orderDetail.orderNo+'：#{order_no}</div>            #{order_status}            <div class="order-block order-buyList yhsd-main-border yhsd-form-background">               <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-list-pc"></i>'+LANG.orderDetail.shopList+'</h5>               <div class="order-buyList-group-wrapper">#{order_buy_list}</div>            </div>            <div class="order-block order-detail-address yhsd-main-border yhsd-form-background">                <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-location-pc"></i>'+LANG.orderDetail.addressInfo+'</h5>                <div class="address">                    <div><span class="left">'+LANG.orderDetail.addressName+'：</span><span class="right">#{name}</span></div>                    <div><span class="left">'+LANG.orderDetail.addressMobile+'：</span><span class="right">#{mobile}</span></div>                    <div><span class="left">'+LANG.orderDetail.addressDetail+'：</span><span class="right">#{address}</span></div>                </div>            </div>            <div class="order-block order-detail-payment yhsd-main-border yhsd-form-background">                <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-security-mob"></i>'+LANG.orderDetail.payMethod+'</h5>                <div><span class="left">'+LANG.orderDetail.payMethod+'：</span><span class="right">#{pay_type}</span></div>            </div>            <div class="order-other order-detail-msg yhsd-form-background yhsd-main-border">                <div class="order-other-left">                    <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-msg-pc"></i>'+LANG.orderDetail.remark+'</h5>                    <div><span>#{message}</span></div>                </div>                <div class="order-other-right yhsd-main-border">                    <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-coupon"></i>'+LANG.orderDetail.coupon+'</h5>                    <div>#{coupon_used}</div>                </div>            </div>            <div class="order-block order-detail-submit order-submit yhsd-main-border yhsd-form-background">                <div class="detail">                    <div>'+LANG.orderDetail.totalAmount+'：<span class="value">'+LANG.currency+"#{item_amount}</span></div>                    <div>"+LANG.orderDetail.shipAmount+'：<span class="value">'+LANG.currency+"#{shipment_amount}</span></div>                        #{off_amount}                    #{points_amount}                    <div>"+LANG.orderDetail.payAmount+'：<span class="value total">'+LANG.currency+"#{total_amount}</span></div>                </div>            </div>        </div>    </div></div>",_state:'<div class="order-block order-detail-info yhsd-form-background yhsd-main-border">    <div class="desc you_comment-target-add" data-order_no="#{order_no}">        <img src="#{image_src}" alt="'+LANG.orderDetail.orderState+'">        <h3 class="yhsd-font-title">'+LANG.orderDetail.orderState+"：#{status_title}</h3>        #{status_desc}    </div>    #{progress}</div>",render:function(e){var t=this._main.replace(/#\{order_status\}/g,this.renderState(e)).replace(/#\{order_buy_list\}/g,this.renderList(e)),a="";$.each(e.address.areas,function(e,t){a+=t.name+" "}),a+=e.address.detail;var s=LANG.orderDetail.unused;$.each(e.preferential_records,function(e,t){if(t.coupon_code){var a=t.promotion_name||LANG.orderDetail.unknownCoupon;return s="<span>"+a+"</span><br>",s+="<span>"+LANG.orderDetail.offAmount+"："+LANG.currency+$yhsd.Util.yuan(t.amount)+"</span><br>",s+='<span class="code">'+t.coupon_code+"</span>",!1}});var i="",n="",r=[],o=0;if($.each(e.discount_records,function(e,t){"积分抵现"===t.name?(o=t.amount,n=(n="<div>"+LANG.orderDetail.pointsOff+'：<span class="value">- '+LANG.currency+"#{points_amount}</span></div>").replace(/#\{points_amount\}/g,$yhsd.Util.yuan(t.amount))):r.push(t)}),r.length>0){var d='<div class="show-discount"><ul class="show-discount-tooltip">';$.each(r,function(e,t){d+='<li><span class="left">'+t.name+'</span><span class="right">-'+LANG.currency+" "+$yhsd.Util.yuan(t.amount)+"</span></li>"}),d+="</ul></div>",i=(i="<div>"+LANG.orderDetail.offAmount+'：<span class="value">'+d+"- "+LANG.currency+"#{discount_amount}</span></div>").replace(/#\{discount_amount\}/g,$yhsd.Util.yuan(e.discount_amount-o))}t=t.replace(/#\{order_no\}/g,e.order_no).replace(/#\{name\}/g,e.address.name).replace(/#\{mobile\}/g,$yhsd.Util.securePhone(e.address.mobile)||$yhsd.Util.securePhone(e.address.phone)||$yhsd.Util.securePhone(e.address.telephone)).replace(/#\{address\}/g,a).replace(/#\{pay_type\}/g,0===e.payment_method_type?LANG.orderDetail.payOnline:LANG.orderDetail.payOffline).replace(/#\{message\}/g,e.customer_remarks||LANG.orderDetail.noRemark).replace(/#\{coupon_used\}/g,s).replace(/#\{item_amount\}/g,$yhsd.Util.yuan(e.item_amount)).replace(/#\{shipment_amount\}/g,$yhsd.Util.yuan(e.shipment_amount)).replace(/#\{off_amount\}/g,i).replace(/#\{points_amount\}/g,n).replace(/#\{points_amount\}/g,$yhsd.Util.yuan(0)).replace(/#\{total_amount\}/g,$yhsd.Util.yuan(e.total_amount)),$(oGlobalConfig.layoutHook).html(t),Jssdk.events.publish("component.render.completed")},createLang:function(e){var t=e;switch(e){case"支付过期":t=LANG.orderList.order_expire;break;case"等待付款":t=LANG.orderList.order_unpay;break;case"等待配送":t=LANG.orderList.order_ship;break;case"正在配送":case"配送中":t=LANG.orderList.order_shipping;break;case"订单完成":t=LANG.orderList.order_done;break;case"已取消":t=LANG.orderList.order_cancel;break;case"未发货":t=LANG.orderList.order_unship;break;case"已签收":t=LANG.orderList.order_receive;break;case"订单退单中":t=LANG.orderList.order_refunding;break;case"退单完成":t=LANG.orderList.order_refund;break;case"快递":t=LANG.orderDetail.ship_normal;break;case"顺丰":t=LANG.orderDetail.ship_shunfeng;break;case"平邮":t=LANG.orderDetail.ship_pingyou;break;case"商家自送":t=LANG.orderDetail.ship_self;break;case"自提":t=LANG.orderDetail.ship_diy}return t},renderState:function(e){var t=$yhsd.asset+"img/160623/orderDetail-paying.png",a=$yhsd.asset+"img/160623/orderDetail-ready.png",s=$yhsd.asset+"img/160623/orderDetail-ship.png",i=$yhsd.asset+"img/160623/orderDetail-done.png",n=$yhsd.asset+"img/160623/orderDetail-cancel.png",r="",o=this.createLang(e.status_desc),d="",c='<div class="progress#{is_cod}">    <div class="bar">        <i class="bar-inner" style="width: #{bar_width};"></i>        <span class="first #{bar_class1}"></span>#{bar_class_cod}<span class="#{bar_class3}"></span><span class="#{bar_class4}"></span>    </div>    <ul>        <li class="step1">#{bar_time1}</li>        #{bar_time_cod}        <li class="step3">#{bar_time3}</li>        <li class="step4">#{bar_time4}</li>    </ul></div>';c=0===e.payment_method_type?c.replace(/#\{is_cod\}/g,"").replace(/#\{bar_class_cod\}/g,'<span class="#{bar_class2}"></span>').replace(/#\{bar_time_cod\}/g,'<li class="step2">#{bar_time2}</li>'):c.replace(/#\{is_cod\}/g," cod").replace(/#\{bar_class_cod\}/g,"").replace(/#\{bar_time_cod\}/g,"");var l="active",p="",u="",h=LANG.orderDetail.state_order+'<div class="time">'+e.created_at.slice(0,10)+"<br>"+e.created_at.slice(11,19)+"</div>",m=LANG.orderDetail.state_paid+'<div class="time"></div>',v=LANG.orderDetail.state_ship+'<div class="time"></div>',f=LANG.orderDetail.state_done+'<div class="time"></div>',y=0;return 0===e.status?0===e.payment_status?(o+="，"+LANG.orderDetail.payAmount+"："+LANG.currency+$yhsd.Util.yuan(e.total_amount),r=t,d+='<small class="yhsd-font-desc">'+LANG.orderDetail.payTips_1+'<span id="yhsd-order-timeout"> 00:00:00 </span> ，'+LANG.orderDetail.payTips_2+"</small>",d+='<div><a id="yhsd-order-detail-pay" href="javascript:void(0);" class="btn btn-sm btn-vital">'+LANG.orderPayment.payBtn+'</a><a href="javascript:void(0);" class="cancel yhsd-font-link" id="yhsd-order-cancel">'+LANG.orderDetail.cancelOrder+"</a></div>"):2===e.payment_status&&0===e.shipment_status?(r=a,d='<small class="yhsd-font-desc">'+LANG.orderDetail.cancelTips+"</small>",d+='<div><a href="javascript:void(0);" class="cancel yhsd-font-link" id="yhsd-order-cancel">'+LANG.orderDetail.cancelOrder+"</a></div>",p="active",m=LANG.orderDetail.state_paid+'<div class="time">'+e.created_at.slice(0,10)+"<br>"+e.created_at.slice(11,19)+"</div>",y=0===e.payment_method_type?33.33:0):(r=s,d='<small class="yhsd-font-desc">'+LANG.orderDetail.shipTips+"</small>",p=u="active",m=LANG.orderDetail.state_paid,v=LANG.orderDetail.state_ship,y=0===e.payment_method_type?66.66:50):(l="",p=u="hide",m=v="",5===e.status?(r=n,d+="<small>"+LANG.orderDetail.expiredTips+"</small>",f=LANG.orderDetail.state_expired):4===e.status?(r=i,d+="<small>"+LANG.orderDetail.doneTips+"</small>",f=LANG.orderDetail.state_done):(r=n,d+="<small>"+LANG.orderDetail.hasCancelTips+"</small>",f=LANG.orderDetail.state_cancel)),c=c.replace(/#\{bar_class1\}/g,l).replace(/#\{bar_class2\}/g,p).replace(/#\{bar_class3\}/g,u).replace(/#\{bar_class4\}/g,"").replace(/#\{bar_time1\}/g,h).replace(/#\{bar_time2\}/g,m).replace(/#\{bar_time3\}/g,v).replace(/#\{bar_time4\}/g,f).replace(/#\{bar_width\}/g,y+"%"),sDom=this._state.replace(/#\{image_src\}/g,r).replace(/#\{order_no\}/g,e.order_no).replace(/#\{status_title\}/g,o).replace(/#\{status_desc\}/g,d).replace(/#\{progress\}/g,c),sDom},renderList:function(e){var t=this,a="",s='<div class="order-buyList-item">    <div class="image"><img src="#{item_src}" alt="#{item_name}"></div>    <div class="product">        <a class="name yhsd-font-title" href="#{item_href}" target="_blank">#{item_name}</a>        <span class="desc yhsd-font-desc">#{sku_desc}</span>    </div>    <span class="price yhsd-font-title">'+LANG.currency+'#{item_price} × #{quantity}</span>    <span class="line-price yhsd-font-title">'+LANG.currency+"#{line_price}</span></div>";return $.each(e.shipments,function(i,n){var r='<div class="order-buyList-group">';$.each(n.line_items,function(e,t){var a=Jssdk.util.getImageUrl(t.feature_image.image_id,t.feature_image.image_name,"60x60",t.feature_image.image_epoch);r+=s.replace(/#\{item_src\}/g,a).replace(/#\{item_name\}/g,t.name).replace(/#\{item_href\}/g,t.page_url).replace(/#\{item_price\}/g,$yhsd.Util.yuan(t.price)).replace(/#\{sku_desc\}/g,t.options_desc?t.options_desc.split(",").join(" / "):"").replace(/#\{quantity\}/g,t.quantity).replace(/#\{line_price\}/g,$yhsd.Util.yuan(t.price*t.quantity))});var o='<div class="shipment">   #{tag}   #{package}   #{ships}   #{submit}   <div class="ship-msg-box"><i class="yhsd-base-iconfont icon-right-up"></i>#{ship_msg}</div></div>',d="",c="<span>"+LANG.orderDetail.shipMethod+':</span><span class="desc yhsd-font-text">'+t.createLang(n.ship_type_desc)+LANG.currency+n.amount/100+"</span>",l="<span>"+t.createLang(n.status_desc)+"</span>",p="",u="";e.shipments.length>1&&(d='<span class="tag">'+LANG.orderDetail.package+n.serial_number+"</span>"),1!==n.status&&2!==n.status||(l=1===n.status?'<a class="btn btn-xs btn-primary" href="javascript:void(0);">'+LANG.orderDetail.confirmOrder+"</a>":"",n.supplier===LANG.orderDetail.noShip?(p='<span class="ship-msg" data-type="'+n.supplier+'" data-id="'+n.id+'"><span class="yhsd-base-iconfont icon-ship-car"></span>'+LANG.orderDetail.noShip+"</span>",u=""):(p='<span class="ship-msg" data-type="'+n.supplier+'" data-id="'+n.id+'"><span class="yhsd-base-iconfont icon-ship-car"></span>'+LANG.orderDetail.shipInfo+'<i class="yhsd-base-iconfont icon-down-mob"></i></span>',u="<div>"+LANG.orderDetail.shipCompany+"：<b>"+n.supplier+"</b>"+LANG.orderDetail.shipNo+"：<b>"+n.ship_no+'</b><a class="ship-msg-reflash" href="javascript:void(0);" data-url="'+n.tracker_url+'">'+LANG.orderDetail.flashShip+'</a></div><ul><li class="loading">'+LANG.orderDetail.loading+"</li></ul>")),o=o.replace(/#\{tag\}/g,d).replace(/#\{ship_msg\}/g,u).replace(/#\{package\}/g,c).replace(/#\{submit\}/g,l).replace(/#\{ships\}/g,p),a+=r+=o+"</div>"}),a},userEvent:function(e){var t=this,a=Date.parse(e.timeout_at),s=function(){var e=(new Date).getTime(),t=a-e;t<1&&(t=0,window.location.href="/account/orders");var i=Math.floor(t/36e5),n=Math.floor(t%36e5/6e4),r=Math.floor(t%36e5%6e4/1e3);n<10&&(n="0"+n),r<10&&(r="0"+r),$("#yhsd-order-timeout").html(i+":"+n+":"+r),setTimeout(function(){s()},1e3)};$("#yhsd-order-timeout").length>0&&s(),$("#yhsd-order-cancel").on("click",function(){var a={order_no:e.order_no,reason:""},s='<div class="box order-detail">    <div class="title">'+LANG.orderList.cancelReason.tips_1+'<span class="warning">'+LANG.orderList.cancelReason.tips_2+"</span>"+LANG.orderList.cancelReason.tips_3+"</div>    <div>        <h4>"+LANG.orderList.cancelReason.title+'：</h4>        <div class="checkbox-group" id="yhsd-cancel_reason">            <label for="cancel_reason1"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_1+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason1" data-reason="'+LANG.orderList.cancelReason.reason_1+'">            <label for="cancel_reason2"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_2+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason2" data-reason="'+LANG.orderList.cancelReason.reason_2+'">            <label for="cancel_reason3"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_3+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason3" data-reason="'+LANG.orderList.cancelReason.reason_3+'">            <label for="cancel_reason4"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_4+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason4" data-reason="'+LANG.orderList.cancelReason.reason_4+'">            <label for="cancel_reason5"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_5+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason5" data-reason="'+LANG.orderList.cancelReason.reason_5+'">            <label for="cancel_reason6"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_6+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason6" data-reason="'+LANG.orderList.cancelReason.reason_6+'">            <label for="cancel_reason7"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_7+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason7" data-reason="'+LANG.orderList.cancelReason.reason_7+'">            <label for="cancel_reason8"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_8+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason8" data-reason="'+LANG.orderList.cancelReason.reason_8+'">            <label for="cancel_reason9"><span class="radio-btn"></span>'+LANG.orderList.cancelReason.reason_9+'</label>            <input type="radio" name="cancel-reason" id="cancel_reason9" data-reason="'+LANG.orderList.cancelReason.reason_9+'">        </div>    </div>    <div class="tips" id="yhsd-order-cancel-tips">'+LANG.orderList.cancelReason.selReason+'</div>    <div class="ctrl-btns">        <button class="btn btn-md btn-primary" id="yhsd-order-cancel-submit" type="submit">'+LANG.orderList.cancelReason.cancel+'</button>        <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>    </div></div>",i=new $yhsd.Popup("<h3>"+LANG.orderList.cancelReason.cancel+"</h3>",s,function(){$yhsd.CheckBtn.init("#yhsd-cancel_reason"),$("#yhsd-modal").on("click",function(){$("#yhsd-order-cancel-tips").fadeOut(200)}),$("#yhsd-order-cancel-submit").on("click",function(e){if(a.reason=$("#yhsd-cancel_reason").find("input:checked").attr("data-reason"),!a.reason)return $("#yhsd-order-cancel-tips").fadeIn(200),void e.stopPropagation();Jssdk.order.cancel(a,function(){i.close(),t.init()})})});i.init()}),$(".order-buyList-group-wrapper").on("click",".btn-primary",function(){var a={order_no:e.order_no,shipment_id:$(this).prev().attr("data-id")},s='<div class="box"><div class="title">'+LANG.orderList.confirmTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-orders-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",i=new $yhsd.Popup("<h3>"+LANG.orderList.confirmOrder+"</h3>",s,function(){$("#yhsd-orders-submit").on("click",function(){Jssdk.order.receive(a,function(e){i.close(),t.init()})})});i.init()}),$(".order-buyList-group-wrapper").on("click",".ship-msg",function(){$(this).attr("data-type")!==LANG.orderDetail.noShip&&($(this).hasClass("active")?($(this).removeClass("active").children("i").removeClass("icon-down-mob").addClass("icon-right-up"),$(this).siblings(".ship-msg-box").slideUp(200)):($(this).addClass("active").children("i").addClass("icon-down-mob").removeClass("icon-right-up"),$(this).siblings(".ship-msg-box").slideDown(200).find(".ship-msg-reflash").trigger("click")))}),$(".ship-msg-reflash").on("click",function(){var e=$(this).attr("data-url"),t=$(this).parent().next();$.ajax({type:"get",url:e,dataType:"jsonp",success:function(e){var a="",s=JSON.parse(e);$.each(s.gtex_traces,function(e,t){a+="<li",a+=e===s.gtex_traces.length-1?' class="last"':"",a+=0===e?' class="first"':"",a+="><small></small><span>"+t.time+"</span>"+t.content+"</li>"}),t.html(a)},error:function(){},fail:function(){}})}),$("#yhsd-order-detail-pay").on("click",function(){orderPayment.init(e.order_no)})},init:function(){var e=this,t=window.location.pathname.slice(16);Jssdk.order.get({order_no:t},function(t){200===t.res.code?(e.render(t.res.orders[0]),e.userEvent(t.res.orders[0])):window.location.href="/account/orders"})}},cart={_main:'<div class="wrapper">    <div class="cont">        <div class="cart-head">            <h2 class="yhsd-font-title">'+LANG.cart.title+'</h2>            <ul class="cart-head-promote" id="cart-head-promote"></ul>        </div>        <div class="cart-cont yhsd-main-border">            <div class="cart-cont-head yhsd-main-border yhsd-form-background">                <span class="checkbox-group">                   <label for="cart-select-all" class="cart-select-all yhsd-font-text"><span class="checkbox-btn"></span>'+LANG.cart.checkAll+'</label>                   <input type="checkbox" name="selected-all" id="cart-select-all">                </span>                <span class="name yhsd-font-text">'+LANG.cart.productName+'</span><span class="price yhsd-font-text">'+LANG.cart.unitPrice+'</span><span class="quantity yhsd-font-text">'+LANG.cart.quantity+'</span><span class="subtotal yhsd-font-text">'+LANG.cart.subtotal+'</span><span class="operate yhsd-font-text">'+LANG.cart.operate+'</span>            </div>            <ul class="cart-cont-list empty" id="cart-cont-list">                <li><div class="cart-cont-item yhsd-main-border">'+LANG.cart.loading+'</div></li>            </ul>            <div class="cart-cont-footer" id="cart-cont-footer"></div>        </div>    </div></div>',render:function(){if(!(2!==this.oCache.lock&&this.oCache.cart.item_count>0))if(0===this.oCache.cart.item_count)$("#cart-cont-footer").html(""),$(".cart-select-all").children().removeClass("selected").end().next().prop("checked",!1),$("#cart-cont-list").addClass("empty").html('<li class="yhsd-main-border"><div class="cart-cont-item yhsd-main-border">'+LANG.cart.emptyCartTips+'<br><a href="/products" class="btn btn-primary btn-sm">'+LANG.cart.goProductList+"</a></div></li>");else{this.sortList(),this.renderList();var e='<div class="confirm yhsd-form-background yhsd-main-border">    <a id="yhsd-cart-submit" href="javascript:void(0);" class="btn btn-vital btn-lg">'+LANG.cart.confirmCart+'</a>    <div class="confirm-submit">'+LANG.cart.selectProduct+'<span class="quantity">#{quantity}</span>'+LANG.cart.quantityWord+'<span class="total">'+LANG.cart.totalAmount+'：</span><span class="price">'+LANG.currency+'#{total_price}</span><span class="discount"><small>'+LANG.cart.hasOff+"：</small>"+LANG.currency+'#{discount}</span></div>    <div class="confirm-options">        <span class="checkbox-group">            <label for="footer-select-all" class="cart-select-all yhsd-font-text"><span class="checkbox-btn"></span>'+LANG.cart.checkAll+'</label>            <input type="checkbox" name="footer-select-all" id="footer-select-all">        </span>        <span id="yhsd-cart-delete" class="yhsd-font-text">'+LANG.cart.remove+'</span><span id="yhsd-cart-remove" class="yhsd-font-text">'+LANG.cart.clear+"</span>    </div></div>";if(this.oCache.entire.length>0){var t="";$.each(this.oCache.entire,function(e,a){var s='<tr class="yhsd-font-text">  <td>'+LANG.cart.meetActivity+"</td>  <td>#{item_desc}</td></tr>",i=LANG.cart.hasOff+'：<span class="price yhsd-font-title">- '+LANG.currency+$yhsd.Util.yuan(a.discount_amount)+"</span>";"coupon"===a.discount_type&&(i=LANG.cart.coupon+'： <span class="coupon"></span><div class="tooltip">'+a.name+"</div>"),t+=s.replace(/#\{item_name\}/g,a.name).replace(/#\{item_desc\}/g,i)}),e='<div class="discounts yhsd-form-background yhsd-main-border"><table><tbody>'+t+"</tbody></table></div>"+e}var a=this.oCache.selected===this.oCache.cart.item_count,s=0;this.oCache.selected>0&&this.oCache.total_amount-this.oCache.discount_amount>0&&(s=this.oCache.total_amount-this.oCache.discount_amount),e=e.replace(/#\{quantity\}/g,this.oCache.count).replace(/#\{is_selected\}/g,a?"selected":"").replace(/#\{is_checked\}/g,a?"checked":"").replace(/#\{total_price\}/g,$yhsd.Util.yuan(s)).replace(/#\{discount\}/g,$yhsd.Util.yuan(this.oCache.discount_amount)),$("#cart-cont-footer").html(e),this.userEvent()}},renderList:function(){var e=this,t="";$.each(e.oCache.cartSorted,function(a,s){var i='<li class="yhsd-main-border">';if(null!==s.discount&&s.products.length>0){var n='<div class="cart-cont-item cart-cont-item-discount yhsd-form-background yhsd-main-border">   <div>       <span class="type">#{type}</span><span class="name yhsd-font-title">#{name}</span>       <span class="rules yhsd-font-title">'+LANG.cart.rules+'<small>#{rules}</small></span><a class="gather" href="#{href}" target="_blank">'+LANG.cart.getMore+'</a>   </div>   <span class="price yhsd-font-title">'+LANG.currency+'#{price}</span><span class="off yhsd-font-text">#{off}</span></div>',r="",o="",d="";switch(s.discount.discount_type){case"amount_off":o=LANG.cart.discount.type_1,r=LANG.cart.discount.off_desc+$yhsd.Util.yuan(s.discount.discount_amount),$.each(s.discount.details,function(e,t){d=(d+=LANG.cart.discount.amount_off).replace(/#\{active_amount\}/g,t.active_amount/100).replace(/#\{discount_amount\}/g,t.discount_amount/100)});break;case"percent_off":o=LANG.cart.discount.type_2,r=LANG.cart.discount.off_desc+$yhsd.Util.yuan(s.discount.discount_amount),$.each(s.discount.details,function(e,t){d=(d+=LANG.cart.discount.percent_off).replace(/#\{active_amount\}/g,t.active_amount/100).replace(/#\{discount_percent\}/g,t.discount_percent/10)});break;case"coupon":o=LANG.cart.discount.type_3,r="",$.each(s.discount.details,function(e,t){d=0==t.active_amount?(d+=LANG.cart.discount.coupon_off_1).replace(/#\{coupon_discount_amount\}/g,t.coupon_discount_amount/100):(d+=LANG.cart.discount.coupon_off_2).replace(/#\{active_amount\}/g,t.active_amount/100).replace(/#\{coupon_discount_amount\}/g,t.coupon_discount_amount/100)});break;default:o=LANG.cart.discount.type_4,r=LANG.cart.discount.type_4,$.each(s.discount.details,function(e,t){0==t.active_amount?d+=LANG.cart.discount.type_4+"<br>":d=(d+=LANG.cart.discount.ship_off).replace(/#\{active_amount\}/g,t.active_amount/100)})}i+=n.replace(/#\{type\}/g,o).replace(/#\{name\}/g,s.discount.name).replace(/#\{rules\}/g,d).replace(/#\{href\}/g,s.discount.page_url).replace(/#\{price\}/g,$yhsd.Util.yuan(s.discount.match_item_amount-s.discount.discount_amount)).replace(/#\{off\}/g,r)}if($.each(s.products,function(t,a){var s='<div class="cart-cont-item cart-cont-item-product yhsd-form-background yhsd-main-border #{unnormal_class} #{is_selected}" data-vid="#{variant_id}" data-reason="#{reason}">    #{check_box}    <div class="img"><img src="#{item_src}" alt="#{item_name}"></div>    <div class="name"><a href="#{item_href}" target="_blank" class="yhsd-font-title">#{item_name}</a></div>    <div class="sku #{is_sku} yhsd-font-desc"><span class="edit yhsd-base-iconfont icon-edit"></span>#{item_sku}</div>    <style>.cart-cont-item-product>.sku.active .edit:before {content: "'+LANG.cart.edit+'";font-family:"Microsoft Yahei",verdana!important;}</style>    <div class="unit-price yhsd-font-text">'+LANG.currency+'#{item_price}</div>    <div class="control">        <div class="quantity-selector yhsd-font-text">            <span class="yhsd-base-iconfont icon-minus"></span><input class="yhsd-font-text" type="text" value="#{quantity}"><span class="yhsd-base-iconfont icon-add"></span>        </div>    </div>    <div class="price yhsd-font-text">'+LANG.currency+'#{item_line_price}</div>    <div class="delete yhsd-font-text">'+LANG.cart.remove+"</div></div>",n="",r="",o="";if(a.available)a.is_check?(n="selected",e.oCache.total_amount+=a.line_price,e.oCache.selected++,e.oCache.count+=a.quantity,e.oCache.selIds.push(a.variant_id),r='<div class="checkbox-group"><label for="item-#{index}"><span class="checkbox-btn selected"></span></label><input type="checkbox" name="cancel-reason" id="item-#{index}" checked></div>'):r='<div class="checkbox-group"><label for="item-#{index}"><span class="checkbox-btn"></span></label><input type="checkbox" name="cancel-reason" id="item-#{index}"></div>';else{var d="";switch(a.reason){case"商品信息变动":d=LANG.cart.productInfoChange,o="unsell";break;case"商品库存不足":d=LANG.cart.productUnderstock,o="change";break;default:d=LANG.cart.productUnsell,e.oCache.offShelves.push(a.variant_id),o="unsell"}r='<div class="checkbox-group">'+d+"</div>"}i+=s.replace(/#\{item_src\}/g,a.image_src||oGlobalConfig.noImage).replace(/#\{index\}/g,t).replace(/#\{is_selected\}/g,n).replace(/#\{unnormal_class\}/g,o).replace(/#\{check_box\}/g,r).replace(/#\{reason\}/g,a.reason).replace(/#\{variant_id\}/g,a.variant_id).replace(/#\{item_name\}/g,a.name).replace(/#\{item_href\}/g,a.page_url).replace(/#\{is_sku\}/g,a.options_desc?"":"hidden").replace(/#\{item_sku\}/g,a.options_desc?a.options_desc.split(",").join("<br>").split(":").join(" : "):"").replace(/#\{item_price\}/g,$yhsd.Util.yuan(a.price)).replace(/#\{quantity\}/g,a.quantity).replace(/#\{item_line_price\}/g,$yhsd.Util.yuan(a.line_price))}),null!==s.discount&&s.products.length>0&&"coupon"===s.discount.discount_type){var c='<span class="name">'+s.discount.details[0].coupon_group_name+'</span><span class="off">'+LANG.currency+$yhsd.Util.yuan(s.discount.details[0].coupon_discount_amount)+"</span>";t+=i+'<div class="cart-cont-item cart-cont-item-coupon yhsd-main-border"><span class="coupon"></span>'+c+"</div></li>"}else t+=i+"</li>"}),$("#cart-cont-list").html(t).removeClass("empty")},renderPromote:function(){var e='<li><span class="type">#{type}</span><span class="name">#{name}</span><span class="rules">'+LANG.cart.rules+"<small>#{rules}</small></span></li>",t="";$.each(this.oCache.entire,function(a,s){var i="",n="";switch(s.discount_type){case"amount_off":i=LANG.cart.discount.type_1,sOff=LANG.cart.discount.off_desc+$yhsd.Util.yuan(s.discount_amount),$.each(s.details,function(e,t){n=(n+=LANG.cart.discount.amount_off).replace(/#\{active_amount\}/g,t.active_amount/100).replace(/#\{discount_amount\}/g,t.discount_amount/100)});break;case"percent_off":i=LANG.cart.discount.type_2,sOff=LANG.cart.discount.off_desc+$yhsd.Util.yuan(s.discount_amount),$.each(s.details,function(e,t){n=(n+=LANG.cart.discount.percent_off).replace(/#\{active_amount\}/g,t.active_amount/100).replace(/#\{discount_percent\}/g,t.discount_percent/10)});break;case"coupon":i=LANG.cart.discount.type_3,sOff="",$.each(s.details,function(e,t){n=0==t.active_amount?(n+=LANG.cart.discount.coupon_off_1).replace(/#\{coupon_discount_amount\}/g,t.coupon_discount_amount/100):(n+=LANG.cart.discount.coupon_off_2).replace(/#\{active_amount\}/g,t.active_amount/100).replace(/#\{coupon_discount_amount\}/g,t.coupon_discount_amount/100)});break;default:i=LANG.cart.discount.type_4,sOff=LANG.cart.discount.type_4,$.each(s.details,function(e,t){0==t.active_amount?n+=LANG.cart.discount.type_4+"<br>":n=(n+=LANG.cart.discount.ship_off).replace(/#\{active_amount\}/g,t.active_amount/100)})}t+=e.replace(/#\{type\}/g,i).replace(/#\{name\}/g,s.name).replace(/#\{rules\}/g,n)}),$("#cart-head-promote").html(t).slideDown(200)},sortList:function(){var e=this.oCache.cart.items,t=this.oCache.partial,a=[],s=[];t.length>0&&$.each(t,function(t,i){var n={discount:i,products:[]};$.each(i.range_products,function(t,a){$.each(e,function(e,t){t.product_id===a&&t.is_check&&(s[e]=!0,t.available?n.products.unshift(t):n.products.push(t))})}),a.push(n)});var i=[],n=[];$.each(e,function(e,t){s[e]||(t.available?t.is_check?i.unshift({discount:null,products:[t]}):i.push({discount:null,products:[t]}):n.push({discount:null,products:[t]}))}),this.oCache.cartSorted=$.merge(a,$.merge(i,n))},sortDiscount:function(){var e=this;e.oCache.discount_amount=0,$.each(e.oCache.discounts,function(t,a){e.oCache.discount_amount+=a.discount_amount,"partial"===a.range_type?e.oCache.partial.push(a):e.oCache.entire.push(a)})},oCache:{cart:null,cartSorted:null,discounts:null,entire:[],partial:[],selIds:[],offShelves:[],lock:0,selected:0,count:0,discount_amount:0,total_amount:0},fetchData:function(e,t){var a=this;a.oCache.cart=null,a.oCache.cartSorted=null,a.oCache.discounts=null,a.oCache.entire=[],a.oCache.partial=[],a.oCache.selIds=[],a.oCache.offShelves=[],a.oCache.lock=0,a.oCache.selected=0,a.oCache.count=0,a.oCache.discount_amount=0,a.oCache.total_amount=0,e?(a.oCache.lock++,a.oCache.cart=t.res.cart,a.render()):Jssdk.cart.get(function(e){200===e.res.code?(Jssdk.events.publish("flashTopCart",e),a.oCache.lock++,a.oCache.cart=e.res.cart,a.render()):window.location.reload()}),Jssdk.discount.matchCart(function(e){200===e.res.code?(a.oCache.lock++,a.oCache.discounts=e.res.discounts,a.sortDiscount(),a.renderPromote(),a.render()):window.location.reload()})},userEvent:function(){var e=this;e.oCache.cart.item_count===e.oCache.selected?$(".cart-select-all").children().addClass("selected").end().next().prop("checked",!0):$(".cart-select-all").children().removeClass("selected").end().next().prop("checked",!1),$("#cart-cont-list").off(),$("#cart-cont-list").on("mouseenter",".sku",function(e){var t=$(this).closest(".cart-cont-item").attr("data-reason");if("商品已下架"!==t&&"商品信息变动"!==t){$(this).addClass("hover");var a=$(this),s=setTimeout(function(){a.addClass("active")},200);a.on("mouseleave",function(e){clearTimeout(s),$(this).removeClass("hover active")})}}),$("#cart-cont-list").on("click",".edit",function(t){var a=$(this).parent(),s={handle:a.prev().children().attr("href").split("/")[2],variant_id:a.parent().attr("data-vid"),quantity:a.siblings(".control").find("input").val()};if(a.hasClass("active")){var i,n,r,o;function d(){r?(r.feature_image?n.img=r.feature_image.src:n.img=i.feature_image.src,n.stock=r.stock,n.price=r.price):(n.img=i.feature_image.src,n.stock=0,$.each(i.variants,function(e,t){n.stock+=t.stock}),i.price_max===i.price_min?n.price=i.price_min:n.price=i.price_min+"-"+i.price_max)}function c(){var e='<div class="info">    <img id="sku-image" src="#{item_image}">    <div class="name">#{item_name}</div>    <div><span class="price">'+LANG.currency+'<small id="sku-price">#{item_price}</small></span><span id="sku-stock" class="stock">'+LANG.cart.stock+"#{item_stock}"+LANG.cart.quantityWord+"</span></div></div>#{item_sku}",t="";if(n.options.length>0&&(t='<div class="sku">',$.each(n.options,function(e,a){var s='<div class="sku-item"><div class="left">';s+=a.name,s+='：</div><div class="right" data-index="'+e+'">';var i=a.values;$.each(i,function(e,t){s+='<a href="javascript:void(0);" class="btn btn-xs btn-default '+t.state+'">'+t.name+"</a>"}),t+=s+="</div></div>"}),t+="</div>"),"string"==typeof n.price)var a=n.price.split("-"),s=$yhsd.Util.yuan(a[0])+" - "+$yhsd.Util.yuan(a[1]);else s=$yhsd.Util.yuan(n.price);e=e.replace(/#\{item_image\}/g,n.img).replace(/#\{item_name\}/g,n.name).replace(/#\{item_price\}/g,s).replace(/#\{item_stock\}/g,n.stock).replace(/#\{item_sku\}/g,t),$("#edit-product-cont").html(e);var i=$("#yhsd-modal");i.css({"margin-left":-i.width()/2-40,"margin-top":-i.height()/2-30})}Jssdk.product.get(s.handle,function(t){i=t.res.product,n={name:i.name},(o=new $yhsd.SkuManager(i,s.variant_id)).get(function(t,a,i,l){var p,u;n.options=t,r=a,l=l,d(),p='<div class="box edit-product-info">    <div id="edit-product-cont"></div>    <div class="ctrl-btns">        <button class="btn btn-md btn-primary" id="yhsd-cart-edit-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+'</button>        <div class="tips">'+LANG.cart.selSkusTips+"</div>    </div></div>",(u=new $yhsd.Popup("<h3>"+LANG.cart.editSkus+"</h3>",p,function(){var t=$("#yhsd-modal").children(".edit-product-info"),a=$("#yhsd-cart-edit-submit");c(),t.on("click",".btn",function(){var e=+$(this).parent().attr("data-index")+1;if($(this).hasClass("selected"))o.unselect(e,function(e,t,a,s){n.options=e,r=t,s=s,d(),c()});else{if($(this).hasClass("disabled"))return;o.select(e,$(this).html(),function(e,t,a,s){n.options=e,r=t,s=s,d(),c()})}}),a.on("click",function(){if(r){var t=s.variant_id,a=r.id;if(a!=t)if(0==a)$(this).siblings(".tips").html(LANG.cart.unSelSkus).fadeIn(200);else{Jssdk.cart.removeOne({variant_id:t},function(){});var i={variant_id:a,quantity:s.quantity,is_check:!0};Jssdk.cart.add(i,function(t){console.log(t.res),200!==t.res.code&&212!==t.res.code||e.fetchData()}),u.close()}else u.close()}})})).init()})})}}),$("#cart-cont-list").on("click","label",function(){var t=$(this).children().hasClass("selected")?"unCheckOne":"checkOne",a=$(this).closest(".cart-cont-item-product").attr("data-vid");Jssdk.cart[t]({variant_id:a},function(){e.fetchData()})}),$(".cart-select-all").off(),$(".cart-select-all").on("click",function(){var t=$(this).children().hasClass("selected")?"unCheckAll":"checkAll";Jssdk.cart[t](function(){e.fetchData()})}),$("#cart-cont-list").on("click",".delete",function(){var t=$(this).closest(".cart-cont-item-product").attr("data-vid"),a='<div class="box"><div class="title">'+LANG.cart.removeTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" id="yhsd-cart-delete-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>";new $yhsd.Popup("<h3>"+LANG.cart.removeProduct+"</h3>",a,function(){$("#yhsd-cart-delete-submit").on("click",function(){Jssdk.cart.removeOne({variant_id:t},function(){e.fetchData()})})}).init()}),$("#yhsd-cart-delete").off(),$("#yhsd-cart-delete").on("click",function(){var t="",a=null;0===e.oCache.selIds.length?t='<div class="box"><div class="title">'+LANG.cart.removeEmptyTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" type="submit">'+LANG.popup.submit+"</button></div></div>":(t='<div class="box"><div class="title">'+LANG.cart.removeTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" id="yhsd-cart-delete-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",a=function(){$("#yhsd-cart-delete-submit").on("click",function(){Jssdk.cart.multiRemove({variant_ids:e.oCache.selIds},function(){e.fetchData()})})}),new $yhsd.Popup("<h3>"+LANG.cart.removeSel+"</h3>",t,a).init()}),$("#yhsd-cart-remove").off(),$("#yhsd-cart-remove").on("click",function(){var t="",a=null;0===e.oCache.offShelves.length?t='<div class="box"><div class="title">'+LANG.cart.clearEmptyTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" type="submit">'+LANG.popup.submit+"</button></div></div>":(t='<div class="box"><div class="title">'+LANG.cart.clearTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" id="yhsd-cart-remove-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",a=function(){$("#yhsd-cart-remove-submit").on("click",function(){Jssdk.cart.multiRemove({variant_ids:e.oCache.offShelves},function(){e.fetchData()})})}),new $yhsd.Popup("<h3>"+LANG.cart.removeSel+"</h3>",t,a).init()}),$("#cart-cont-list").on("focus",".quantity-selector input",function(){var t=+$(this).val(),a=$(this).closest(".cart-cont-item-product").attr("data-vid"),s=$(this).closest(".cart-cont-item").attr("data-reason");if(s&&"商品库存不足"!==s)return $(this).prop("value",t).blur(),!1;$(this).one("blur",function(){var i=parseInt($(this).val());if(!i||i===t||i<1)$(this).prop("value",t);else if("商品库存不足"===s&&i>=t)$(this).prop("value",t);else{$(this).prop("value",i);var n={variant_id:a,quantity:i};Jssdk.cart.quantity(n,function(t){e.fetchData()})}})}),$("#cart-cont-list").on("click",".quantity-selector .icon-add",function(){var e=$(this).closest(".cart-cont-item").attr("data-reason"),t=$(this).prev();e&&"商品库存不足"!==e||t.trigger("focus").prop("value",+t.val()+1).trigger("blur")}),$("#cart-cont-list").on("click",".quantity-selector .icon-minus",function(){var e=$(this).closest(".cart-cont-item").attr("data-reason"),t=$(this).next();e&&"商品库存不足"!==e||t.trigger("focus").prop("value",+t.val()-1).trigger("blur")}),$("#yhsd-cart-submit").off(),$("#yhsd-cart-submit").on("click",function(){if(0!==e.oCache.selected)window.location.href="/account/create_order";else{var t='<div class="box"><div class="title">'+LANG.cart.atleastOne+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md yhsd-popup-close" type="submit">'+LANG.popup.submit+"</button></div></div>";new $yhsd.Popup("<h3>"+LANG.cart.confirmCart+"</h3>",t).init()}});var t=$("#cart-cont-list").height(),a=$("#yhsd-cart-submit").parent(),s=$(window).height(),i=$("#cart-cont-footer").children(".discounts").height();i>0&&(i+=42),s-t<200&&a.addClass("fixed"),$(window).off(),$(window).on("scroll",function(){document.body.scrollTop+document.documentElement.scrollTop+s-t-i<480?a.addClass("fixed"):a.removeClass("fixed")})},init:function(){var e=this;$(oGlobalConfig.layoutHook).html(e._main),Jssdk.events.subscribe("flashMainCart",function(t){e.fetchData(!0,t)})}},simpleCart={hoverColor:"settings-topCartLinkHover_color",hoverBgc:"settings-topCartLinkHover_background",rootId:"yhsd_topCart",rootSel:"#yhsd_topCart",rootEl:$("#yhsd_topCart"),linkEl:$("#yhsd_topCart_show"),eachItemHtml:'<li class="topCart-each settings-main_border" data-vid="#{variant_id}"><div class="topCart-each-img settings-proPic_border"><img class="" src="#{imgsrc}" alt="name" /></div><a class="topCart-each-name txt-overflow settings-proTitle_color" href="#{link}">#{name}</a><span class="topCart-each-desc txt-overflow settings-desc_color" title="#{desc}">#{desc}</span><span class="topCart-each-price settings-price_color"><span>'+LANG.currency+'</span><strong>#{price}</strong><span class="settings-desc_color"> x #{quantity}</span></span><a class="topCart-each-del settings-link_color" href="javascript:void(0);">'+LANG.cart.remove+"</a></li>",init:function(e,t){var a=this,s=!1;a.linkEl.on("touchend",function(e){if(e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]){var t=e.originalEvent.changedTouches[0];if(document.elementFromPoint){var s=document.elementFromPoint(t.clientX,t.clientY);s&&$(s).parents("#yhsd_topCart_show").get(0)&&(a.touchend=!0,window.location.href="/cart")}}}),a.linkEl.on("mouseenter",function(){a.touchend||(s=!0,$(this).addClass(a.hoverColor),$(this).addClass(a.hoverBgc),$("#yhsd_topCart_list").empty(),a.getlist(s))}),a.linkEl.on("mouseleave",function(e){var t=$(e.toElement||e.relatedTarget);if(t.attr("id")){if(t.attr("id")==a.rootId)return}else if(t.parents(a.rootSel)[0])return;s=!1,$(this).removeClass(a.hoverColor),$(this).removeClass(a.hoverBgc),a.rootEl.hide()}),a.rootEl.on("mouseleave",function(e){"yhsd_topCart_show"!=$(e.toElement||e.relatedTarget).attr("id")&&(s=!s,a.linkEl.removeClass(a.hoverColor),a.linkEl.removeClass(a.hoverBgc),a.rootEl.hide())}),"viewMode"==t&&a.viewMode(),e||a.getlist(e),Jssdk.events.subscribe("flashTopCart",function(e){a.buildList(e.res.cart),a.getCartTotal(e.res.cart)}),Jssdk.events.subscribe("getTopCart",function(e){a.getlist()})},getlist:function(e){var t=this;Jssdk.cart.get(function(a){t.buildList(a.res.cart),Jssdk.events.publish("flashMainCart",a),e?t.rootEl.show():t.getCartTotal(a.res.cart)})},buildList:function(e){var t=this,a=0,s=0,i=$("#yhsd_topCart_list");i.empty(),$.each(e.items,function(e,n){if(n.available&&n.is_check){var r=t.eachItemHtml.replace("#{imgsrc}",Jssdk.util.getImageUrl(n.image_id,n.image_name,"62x62",n.image_epoch));r=(r=(r=(r=(r=(r=r.replace("#{variant_id}",n.variant_id)).replace("#{link}",n.page_url)).replace("#{name}",n.name)).replace("#{price}",$yhsd.Util.yuan(n.price))).replace(/\#\{desc\}/gi,n.options_desc||"")).replace("#{quantity}",n.quantity),i.append($(r)),a+=n.quantity,s+=n.line_price}}),$("#yhsd_topCart_quantity").html(a),$("#yhsd_topCart_quantityTitle").html(a),$("#yhsd_topCart_totalPrice").html($yhsd.Util.yuan(s)),t.isViewMode?$(".topCart-each-del").hide():$(".topCart-each-del").on("click",function(){var e=$(this).parents(".topCart-each").attr("data-vid");t.removeItem(e)})},getCartTotal:function(e){var t=0;$.each(e.items,function(e,a){a.available&&a.is_check&&(t+=a.quantity)}),$("#yhsd_topCart_quantity").html(t),$("#yhsd_topCart_quantityTitle").html(t)},removeItem:function(e){var t=this;Jssdk.cart.removeOne({variant_id:e},function(){t.getlist()})},viewMode:function(){this.isViewMode=!0,this.rootEl.find(".topCart-summary").hide()}},orderCreate={_main:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.orderCreate.title+'</h2>        <div class="order-wrapper yhsd-main-border">            <div id="yhsd-order-address" class="order-block order-address yhsd-form-background yhsd-main-border">                <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-order-pc"></i>'+LANG.orderCreate.addressInfo+'</h5>                <div id="order-address-list" class="loading yhsd-font-text">'+LANG.orderCreate.loadingAddress+'</div>            </div>            <div class="order-block order-payment yhsd-form-background yhsd-main-border">                <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-security-mob"></i>'+LANG.orderCreate.payMethod+'</h5>                <div id="order-payment-type" class="loading yhsd-font-text">'+LANG.orderCreate.loadingPay+'</div>            </div>            <div class="order-block order-buyList yhsd-form-background yhsd-main-border">                <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-list-pc"></i>'+LANG.orderCreate.shopList+'<a href="/cart" class="yhsd-font-link">'+LANG.orderCreate.backToCart+'</a></h5>                <div class="order-buyList-group-wrapper" id="order-buyList"><div class="loading yhsd-font-text">'+LANG.orderCreate.loadingCart+'</div></div>            </div>            <div class="order-other yhsd-form-background yhsd-main-border">                <div class="order-other-left">                    <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-msg-pc"></i>'+LANG.orderCreate.remark+'</h5>                    <div id="order-left-message" class="input-area input-area-md" data-state="">                        <div class="title">'+LANG.orderCreate.remarkDesc+'</div>                        <input class="input" type="text" name="message" maxlength="400">                        <div class="tips"></div>                    </div>                </div>                <div class="order-other-right yhsd-main-border" id="order-create-coupon">                    <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-coupon"></i>'+LANG.orderCreate.coupon+'</h5>                    <a class="add-coupon yhsd-font-link" href="javascript: void(0)"><i class="yhsd-base-iconfont icon-add-round"></i>'+LANG.orderCreate.useCoupon+'</a>                </div>            </div>            <div id="order-create-points"></div>            <div class="order-block order-submit yhsd-form-background yhsd-main-border" id="yhsd-order-summary">                <div class="detail">                    <div class="origin-amount">'+LANG.orderCreate.totalAmount+'：<span class="value">0.00</span></div>                    <div class="promote" style="display: none;">'+LANG.orderCreate.activityDiscount+'：<span class="value"></span></div>                    <div class="coupon" style="display: none;">'+LANG.orderCreate.couponDiscount+'：<span class="value">- 0.00</span></div>                    <div class="vip">'+LANG.orderCreate.vipDiscount+'：<span class="value">- 0.00</span></div>                    <div class="ship">'+LANG.orderCreate.shipAmount+'：<span class="value">- 0.00</span></div>                    <div class="points" style="display: none;">'+LANG.orderCreate.points_off+'：<span class="value">- 0.00</span></div>                    <div class="total-amount">'+LANG.orderCreate.lastAmount+'：<span class="value total">0.00</span></div>                    <div class="points-get" style="display:none;"></div>                </div>                <div class="address" style="display: none;">                    <span class="left">'+LANG.orderCreate.addressTo+'：</span><span class="right district"></span><br>                    <span class="left">'+LANG.orderCreate.receiver+'：</span><span class="right contact"></span>                </div>                <a id="order-create-submit" href="javascript:void(0);" class="btn btn-lg btn-vital">'+LANG.orderCreate.title+'</a>                <div class="error" style="display:none;">'+LANG.orderCreate.unableSubmit+"</div>            </div>        </div>    </div></div>",oCache:{isLogin:!0,localCart:null,payment_method_type:null,address:null,addressIndex:-1,shipments:null,payment_method_id:null,bank_code_id:null,coupon:null,origin_amount:0,ship_amount:0,vip:{off:0,rate:0,name:""},promote_off:0,_discounts:"",before_point_amount:0,total_amount:0,shipment_used:[],unavail_products:{online:[],offline:[]},points:{rules:null,use:0,off:0,max:0,total:0,get:0}},list:function(){var e=this,t=$("#order-buyList");if(-1===e.oCache.addressIndex||""===e.oCache.payment_method_type){var a="",s=0,i='<div class="order-buyList-group">';$.each(e.oCache.localCart.items,function(e,t){if(t.available&&t.is_check){var a='<div class="order-buyList-item">    <div class="image"><img src="#{item_src}" alt="#{item_name}"></div>    <div class="product">        <a class="name yhsd-font-title" href="#{item_href}" target="_blank">#{item_name}</a>        <span class="desc yhsd-font-desc">#{item_sku}</span>    </div>    <span class="price yhsd-font-title">'+LANG.currency+'#{item_price} × #{item_quantity}</span>    <span class="line-price yhsd-font-title">'+LANG.currency+"#{item_line_price}</span></div>";a=a.replace(/#\{item_src\}/g,t.image_src||oGlobalConfig.noImage).replace(/#\{item_name\}/g,t.name).replace(/#\{item_href\}/g,t.page_url).replace(/#\{item_sku\}/g,t.options_desc?t.options_desc.split(",").join(" / "):"").replace(/#\{item_price\}/g,$yhsd.Util.yuan(t.price)).replace(/#\{item_quantity\}/g,t.quantity).replace(/#\{item_line_price\}/g,$yhsd.Util.yuan(t.line_price)),s+=t.line_price,i+=a}}),a+=i+"</div>",t.html(a),e.oCache.origin_amount=s,e.oCache.ship_amount=0,e.summary()}else{var n={payment_method_type:e.oCache.payment_method_type};e.oCache.isLogin?n.address_id=e.oCache.address[e.oCache.addressIndex].id:n.district_code=e.oCache.address[e.oCache.addressIndex].district_code,Jssdk.cart.withinShipments(n,function(a){if(200===a.res.code){var s="";e.oCache.shipments=a.res.shipments,e.oCache.shipment_used=[];var i=0,n=0;$.each(a.res.shipments,function(t,r){var o='<div class="order-buyList-group">';if($.each(r.carts,function(e,t){var a='<div class="order-buyList-item">    <img src="#{item_src}" alt="#{item_name}">    <div class="product">        <a class="name yhsd-font-title" href="#{item_href}" target="_blank">#{item_name}</a>        <span class="desc yhsd-font-desc">#{item_sku}</span>    </div>    <span class="price yhsd-font-title">'+LANG.currency+'#{item_price} × #{item_quantity}</span>    <span class="line-price yhsd-font-title">'+LANG.currency+"#{item_line_price}</span></div>";a=a.replace(/#\{item_src\}/g,t.image_src||oGlobalConfig.noImage).replace(/#\{item_name\}/g,t.name).replace(/#\{item_href\}/g,t.page_url).replace(/#\{item_sku\}/g,t.options_desc?t.options_desc.split(",").join(" / "):"").replace(/#\{item_price\}/g,$yhsd.Util.yuan(t.price)).replace(/#\{item_quantity\}/g,t.quantity).replace(/#\{item_line_price\}/g,$yhsd.Util.yuan(t.line_price)),i+=t.line_price,o+=a}),a.res.shipments.length>1)var d='<div class="shipment" data-index="'+t+'"><span class="tag">'+LANG.orderCreate.package+(t+1)+"</span>"+LANG.orderCreate.shipMethod+'：<#{is_select} class="btn btn-sm btn-primary">#{options}</#{is_select}></div>';else d='<div class="shipment" data-index="'+t+'">'+LANG.orderCreate.shipMethod+'：<#{is_select} class="btn btn-sm btn-primary">#{options}</#{is_select}></div>';var c={id:r.id,shipment_method_id:r.shipment_methods[0].id,shipAmount:r.shipment_methods[0].amount};e.oCache.shipment_used.push(c),n+=r.shipment_methods[0].amount;var l="";r.shipment_methods.length>0&&$.each(r.shipment_methods,function(e,t){var a="";switch(t.ship_type){case 0:a=LANG.orderCreate.shipDesc_1;break;case 1:a=LANG.orderCreate.shipDesc_2;break;case 2:a=LANG.orderCreate.shipDesc_3;break;case 3:a=LANG.orderCreate.shipDesc_4;break;case 4:a=LANG.orderCreate.shipDesc_5;break;case 5:a=LANG.orderCreate.shipDesc_6}if(1===r.shipment_methods.length){d=d.replace(/#\{is_select\}/g,"a");var s="<span>#{ship_desc} - #{ship_amount}</span>"}else{d=d.replace(/#\{is_select\}/g,"select");s='<option value="'+e+'" data-amount="#{amount}" data-id="#{ship_id}">#{ship_desc} -#{ship_amount}</option>'}var i=t.discount?t.discount.name:LANG.orderCreate.shipFee+LANG.currency+t.amount/100;l+=s.replace(/#\{ship_id\}/g,t.id).replace(/#\{ship_desc\}/g,a).replace(/#\{amount\}/g,t.amount).replace(/#\{ship_amount\}/g,i)}),d=d.replace(/#\{options\}/g,l),s+=o+d+"</div>"}),t.html(s),e.oCache.origin_amount=i,e.oCache.ship_amount=n,e.summary(),t.on("change","select",function(t){var a=$(this).closest(".shipment").attr("data-index")-0;e.oCache.shipment_used[a].shipment_method_id=+$(this).find("option").eq(+$(this).val()).attr("data-id"),e.oCache.shipment_used[a].shipAmount=+$(this).find("option").eq(+$(this).val()).attr("data-amount"),e.oCache.ship_amount=0,$.each(e.oCache.shipment_used,function(t,a){e.oCache.ship_amount+=a.shipAmount}),e.summary()})}})}},address:function(e){var t=this;({_item:'<li class="address-item order-address-list-item #{unlogin}" data-id="#{id}" data-index="#{index}">   <div class="checkbox-group">       <label for="address-#{id}"><span class="radio-btn#{is_selected}"></span></label>       <input type="radio" name="is_default" id="address-#{id}" #{is_checked}>   </div>    <div class="shipment info">        <div class="shipment-receiver yhsd-font-title"><span class="name">#{name} </span><span class="phone"> #{phone}</span></div>        <small class="shipment-address yhsd-font-desc"><span class="province">#{province}</span><span class="city">#{city}</span><span class="area">#{district}</span><span class="street"></span>#{detail}</small>    </div>    <div class="yhsd-font-desc default-address#{is_default}">#{default}</div>    <div class="yhsd-font-desc edit">'+LANG.address.edit+'</div>    <div class="yhsd-font-desc delete">'+LANG.address.remove+"</div></li>",_address:'<div class="box add-address">    <form class="input-field" id="yhsd-address-inputField" action="javascript:void(0);">        <div class="input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.name+'<span> *</span></div>            <input id="yhsd-address-name" class="input yhsd-font-text" type="text" name="detail" maxlength="200">            <div class="tips"></div>        </div>        <div class="tel input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.mobile+'<span> *</span></div>            <input id="yhsd-address-mobile" class="input yhsd-font-text" type="text" name="detail" maxlength="200">            <div class="tips"></div>        </div>        <div class="select-group">           <div id="yhsd-area-selection"class="yhsd-font-text"></div>           <div class="tips">'+LANG.address.inputTips.area_err+'</div>           <input id="yhsd-area-selection-code" type="hidden" name="areacode">        </div>        <div class="full input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.detail+'<span> *</span></div>            <input id="yhsd-address-detail" class="input yhsd-font-text" type="text" maxlength="200">            <div class="tips"></div>        </div>        <div class="full input-area input-area-lg" data-state="">            <div class="title">'+LANG.address.typeName.zipcode+'</div>            <input id="yhsd-address-zipcode" class="input yhsd-font-text" type="text" maxlength="200">            <div class="tips"></div>        </div>        <div class="checkbox-group">           <label class="yhsd-font-text" for="yhsd-is_default"><span class="checkbox-btn"></span>'+LANG.address.typeName.setDefault+'</label>           <input type="checkbox" name="is_default" id="yhsd-is_default">        </div>        <div class="ctrl-btns">            <button id="yhsd-address-edit-submit" class="btn btn-md btn-primary" type="submit">'+LANG.popup.submit+'</button>            <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>        </div>    </form></div>",render:function(e){var a=this,s="";if(a.cache&&a.cache.length>0){s='<ul class="order-address-list">';var i="";$.each(a.cache,function(s,n){n.is_default&&(t.oCache.addressIndex=s);var r=a._item.replace(/#\{name\}/g,n.name).replace(/#\{id\}/g,n.id).replace(/#\{index\}/g,s).replace(/#\{phone\}/g,$yhsd.Util.securePhone(n.mobile)).replace(/#\{default\}/g,n.is_default||!e?LANG.address.defaultAddress:LANG.address.typeName.setDefault).replace(/#\{is_default\}/g,n.is_default||!e?" default":"").replace(/#\{is_selected\}/g,n.is_default?" selected":"").replace(/#\{is_checked\}/g,n.is_default?" checked":"").replace(/#\{province\}/g,n.location_full_titles.split(",")[0]).replace(/#\{city\}/g,"undefined"===n.location_full_titles.split(",")[1]?"":n.location_full_titles.split(",")[1]).replace(/#\{district\}/g,n.location_full_titles.split(",")[2]||"").replace(/#\{detail\}/g,n.detail);n.is_default?i=r+i:i+=r}),s+=i+"</ul>",e?(s=s.replace(/#\{unlogin\}/g,"unlogin"),s+='<a id="yhsd-address-addBtn" class="add-btn yhsd-font-link" href="javascript:void(0);"><i class="yhsd-base-iconfont icon-add-m"></i>'+LANG.address.createTitle+"</a>"):s=s.replace(/#\{unlogin\}/g,"unlogin")}else s='<a id="yhsd-address-addBtn" class="btn btn-sm btn-primary" href="javascript:void(0);"><i class="yhsd-base-iconfont icon-add-m"></i>'+LANG.address.createTitle+"</a>",t.oCache.addressIndex=-1;$("#order-address-list").removeClass("loading").html(s)},cache:null,setter:function(a,s){var i=this,n=function(e){var t=null;return $.each(i.cache,function(a,s){s.id!=e||(t=s)}),t};switch(a){case"def":!function(t){var a=n(t);oSend={id:a.id,name:a.name,district_code:a.district_code,detail:a.detail,mobile:a.mobile,is_default:!0};var s='<div class="box"><div class="title">'+LANG.address.defaultTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-address-default-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",r=new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.address.defaultTitle+"</h3>",s,function(){$("#yhsd-address-default-submit").on("click",function(){window.Jssdk.address.save(oSend,function(){r.close(),i.init(e)})})});r.init()}(s);break;case"remove":!function(a){var s='<div class="box"><div class="title">'+LANG.address.removeTips+'</div><div class="ctrl-btns"><button class="btn btn-primary btn-md" id="yhsd-address-delete-submit" type="submit">'+LANG.popup.submit+'</button><button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div></div>",n=new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.address.removeTitle+"</h3>",s,function(){$("#yhsd-address-delete-submit").on("click",function(){e?window.Jssdk.address.remove({id:a},function(){n.close(),i.init(e)}):(n.close(),i.cache=t.oCache.address=[],t.addressIndex=-1,i.render(),t.summary(),i.userEvent(),t.payment())})});n.init()}(s);break;default:!function(a,s){s=s||0;var r,o=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.name_empty,active:LANG.address.inputTips.name_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.mobile_empty,active:LANG.address.inputTips.mobile_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.detail_empty,active:LANG.address.inputTips.detail_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.address.inputTips.zipcode_empty,active:LANG.address.inputTips.zipcode_active}}],d=i._address,c=function(a,r){var d=new $yhsd.InputManager("#yhsd-address-inputField",o);d.init(),$yhsd.CheckBtn.init("#yhsd-address-inputField .checkbox-group");var c={id:"yhsd-area-selection",addClass:"yhsd-select",field:"areacode"};if(yhsdAddressConfig)for(key in yhsdAddressConfig)c[key]=yhsdAddressConfig[key];r&&(oData=n(s),d.setVal(0,oData.name),d.setVal(1,oData.mobile),d.setVal(2,oData.detail),d.setVal(3,oData.zipcode),oData.is_default&&$("#yhsd-is_default").prev().trigger("click"),c.initCode=oData.district_code),new yhsdAreaSelection(c),$("#yhsd-address-inputField").on("submit",function(n){n.stopPropagation(),n.preventDefault();var r={id:s,name:d.getter(0).value,mobile:d.getter(1).value,district_code:$("#yhsd-area-selection-code").val()||$("#yhsd-area-selection").children().last().val(),detail:d.getter(2).value,zipcode:d.getter(3).value,is_default:$("#yhsd-is_default").prop("checked")};r.name?$yhsd.Util.checkAddressMobile(e,r.mobile)?r.district_code?r.detail?e?window.Jssdk.address[a](r,function(t){p.close(),i.init(e)}):(p.close(),window.Jssdk.area.findPrev(r.district_code,function(e){r.location_full_titles=e.province[1]+","+(e.district&&e.district[1])||"",r.location_full_titles+=e.city.length>0?","+e.city[1]:"",i.cache=t.oCache.address=[r],t.oCache.addressIndex=0,i.render(),t.summary(),i.userEvent(),t.payment()})):d.setter(2,"error"):$("#yhsd-area-selection").parent().addClass("error").on("click",function(){$(this).removeClass("error")}):d.setter(1,"error"):d.setter(0,"error")})};if("new"===a){r='<h3 class="yhsd-font-title">'+LANG.address.createTitle+"</h3>";var l=function(){c("create",!1)}}else n(s),r='<h3 class="yhsd-font-title">'+LANG.address.editTitle+"</h3>",l=function(){c("save",!0)};var p=new $yhsd.Popup(r,d,l);p.init()}(a,s)}},userEvent:function(){var e=this;$("#yhsd-address-addBtn").on("click",function(){if($(this).hasClass("btn-disabled"))return!1;e.setter("new")}),$(".address-item").find(".edit").on("click",function(){var t=$(this).closest(".address-item");e.setter("edit",t.attr("data-id"))}),$(".address-item").find(".default-address").on("click",function(){if($(this).hasClass("default"))return!1;var t=$(this).closest(".address-item");e.setter("def",t.attr("data-id"))}),$(".address-item").find(".delete").on("click",function(){var t=$(this).closest(".address-item");e.setter("remove",t.attr("data-id"))}),$yhsd.CheckBtn.init("#order-address-list",function(e){var a=e.closest(".address-item").attr("data-index")-0;e.closest(".address-item").attr("data-id");t.oCache.addressIndex=a,t.payment(),t.summary()}),$("#order-address-list").find('input[type="radio"]').eq(0).prop("checked",!0).trigger("change")},init:function(e){var a=this;e?window.Jssdk.address.get(function(s){200===s.res.code&&(a.cache=t.oCache.address=s.res.addresses,a.render(e),t.summary(),a.userEvent(),t.payment())}):(a.cache=t.oCache.address=[],a.render(e),t.summary(),a.userEvent(),t.payment())}}).init(e)},payment:function(){var e=this,t={};e.oCache.isLogin?-1!==e.oCache.addressIndex&&(t.address_id=e.oCache.address[e.oCache.addressIndex].id):-1!==e.oCache.addressIndex&&(t.district_code=e.oCache.address.district_code),Jssdk.payment_method.get(t,function(t){if(200===t.res.code){var a="";if($.isEmptyObject(t.res.payment_method))a=LANG.orderCreate.noPaymethods,$("#order-payment-type").html(a).addClass("loading");else{a='<form id="order-create-payment">';var s="",i=!1;$.each(t.res.payment_method,function(t,a){var n='<div class="checkbox-group">   <label for="#{type}"><span class="radio-btn #{is_selected} #{is_valid}"></span>#{type_desc}</label>   <input data-id="#{payment_method_id}" data-bank="#{bank_code_id}" type="radio" name="payment" id="#{type}" data-id="#{pay_id}" #{is_checked} #{is_valid}>   #{unavail_products}</div>',r="",o="",d="",c=[];c=a.methods.bank&&a.methods.bank.length>0?a.methods.bank:a.methods.thirdparty&&a.methods.thirdparty.length>0?a.methods.thirdparty:a.methods.cod;var l="";if("online"===t){if(0===a.methods.bank.length&&0===a.methods.thirdparty.length)return;l=LANG.orderCreate.payOnline,a.avail&&!i&&(r="checked",o="selected",i=!0,e.oCache.payment_method_id=c[0].id,e.oCache.payment_method_type="online",c[0].bank_code_id&&(e.oCache.bank_code_id=c[0].bank_code_id))}else{if(0===a.methods.cod.length)return;l=LANG.orderCreate.payOffline,a.avail&&!i&&(r="checked",o="selected",i=!0,e.oCache.payment_method_type="offline",e.oCache.payment_method_id=c[0].id,e.oCache.bank_code_id="")}a.unavail_products.length>0&&(d=(d='<span class="unavail-tips">'+LANG.orderCreate.unSupportProducts_2+'<a href="javascript:void(0);" data-type="'+t+'">'+LANG.orderCreate.view+"</a></span>").replace(/#\{unavail_products\}/g,a.unavail_products.length).replace(/#\{sTypeDesc\}/g,l),e.oCache.unavail_products[t]=a.unavail_products),n=n.replace(/#\{type\}/g,t).replace(/#\{type_desc\}/g,l).replace(/#\{payment_method_id\}/g,c[0]&&c[0].id||"").replace(/#\{bank_code_id\}/g,c[0]&&c[0].bank_code_id||"").replace(/#\{pay_id\}/g,"").replace(/#\{is_checked\}/g,r).replace(/#\{is_valid\}/g,a.avail?"":"disabled").replace(/#\{is_selected\}/g,o).replace(/#\{unavail_products\}/g,d),s="online"===t?n+s:s+n}),a+=s+"</form>",$("#order-payment-type").html(a).removeClass("loading"),e.list(),$yhsd.CheckBtn.init("#order-create-payment",function(t){e.oCache.payment_method_id=t.attr("data-id"),e.oCache.bank_code_id=t.attr("data-bank")||null,e.oCache.payment_method_type=t.attr("id")||null,e.list()}),$("#order-create-payment").on("click","a",function(){var t=$(this).attr("data-type"),a=e.oCache.unavail_products[t];if("online"===t)var s=LANG.orderCreate.payOnline;else s=LANG.orderCreate.payOffline;var i='<div class="box createOrder-notAllow">    <div class="title yhsd-font-text">'+LANG.orderCreate.unSupportProducts+'#{type_desc}</div>    <ul>#{list}</ul></div><div class="ctrl-btns">    <a class="btn btn-primary btn-md" href="/cart">'+LANG.orderCreate.backToCart+'</a>    <button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div>",n='<li>   <div class="image"><img src="#{pro_src}"></div>   <div class="name">   <a href="#{pro_href}" target="_blank" class="yhsd-font-text">#{pro_name}</a>   <span>#{pro_desc}</span>   </div>   <div class="price">'+LANG.currency+"#{pro_price} × #{pro_quantity}</div></li>",r="";$.each(a,function(e,t){r+=n.replace(/#\{pro_src\}/g,t.image_src).replace(/#\{pro_href\}/g,t.page_url).replace(/#\{pro_name\}/g,t.name).replace(/#\{pro_desc\}/g,t.options_desc?t.options_desc.split(",").join(" / "):"").replace(/#\{pro_price\}/g,$yhsd.Util.yuan(t.price)).replace(/#\{pro_quantity\}/g,t.quantity)}),i=i.replace(/#\{quantity\}/g,a.length).replace(/#\{type_desc\}/g,s).replace(/#\{list\}/g,r);new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.orderCreate.disabled+s+"</h3>",i,function(){}).init()})}}else $("#order-payment-type").html(LANG.orderCreate.noPaymethods).addClass("loading"),e.list()})},coupon:function(){var e=this;function t(){$("#order-create-coupon").find(".cancel").on("click",function(){$("#order-create-coupon").html('<h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-coupon"></i>'+LANG.orderCreate.coupon+'</h5><a class="add-coupon yhsd-font-link" href="javascript: void(0)"><i class="yhsd-base-iconfont icon-add-round"></i>'+LANG.orderCreate.useCoupon+"</a>"),e.oCache.coupon=null,e.summary(),a()})}function a(){$("#order-create-coupon").find(".add-coupon").on("click",function(){var a='<div class="box use-coupon">    <div class="tags" id="use-coupon-tags">        <div class="first active"><span class="yhsd-font-title">'+LANG.orderCreate.coupon+'</span></div>        <div class="last"><span class="yhsd-font-title">'+LANG.orderCreate.useCouponCode+'</span></div>    </div>    <ul class="coupons empty" id="use-coupon-list">        <li>'+LANG.orderCreate.loadingCoupon+'</li>    </ul>   <div id="use-coupon-input" class="input-area input-area-lg" data-state="" style="display: none;">       <div class="title">'+LANG.orderCreate.couponCode+'</div>       <input id="yhsd-coupon-code" class="input yhsd-font-text" type="text" name="coupon-code" maxlength="200">       <div class="tips"></div>   </div></div><div class="ctrl-btns">    <button class="btn btn-primary btn-md" id="order-create-usecoupon" type="submit">'+LANG.popup.submit+'</button>    <button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div>",s=new $yhsd.Popup('<h3 class="yhsd-font-title">'+LANG.orderCreate.useCoupon+"</h3>",a,function(){var a=!0,i=$("#use-coupon-list"),n=$("#use-coupon-input"),r=function(i){var n=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.orderCreate.useCouponCodeTips_empty,active:LANG.orderCreate.useCouponCodeTips_active}}],r=new $yhsd.InputManager("#use-coupon-input",n);r.init(),$("#order-create-usecoupon").on("click",function(){if(a){var n,o=$("#use-coupon-list").find("input:checked").closest("li").attr("data-index"),d='<h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-coupon"></i>'+LANG.orderCreate.coupon+'</h5><a class="cancel yhsd-font-link" href="javascript: void(0)">'+LANG.orderCreate.cancelUse+'</a><div class="coupon"><div>#{name}</div><div>#{desc}</div><div class="code">#{code}</div></div>';n=i[o].active_amount>0?i[o].discount_amount?(n=LANG.coupon.discount_off).replace(/#\{active\}/g,i[o].active_amount/100).replace(/#\{amount\}/g,i[o].discount_amount/100):(n=LANG.coupon.percentage_off).replace(/#\{active\}/g,i[o].active_amount/100).replace(/#\{percentage\}/g,i[o].discount_percentage/10):i[o].discount_amount?(n=LANG.orderCreate.discount_off_2).replace(/#\{discount_amount\}/g,i[o].discount_amount/100):(n=LANG.orderCreate.discount_off_3).replace(/#\{discount_percentage\}/g,i[o].discount_percentage/10),d=d.replace(/#\{name\}/g,i[o].coupon_group_name).replace(/#\{desc\}/g,n).replace(/#\{code\}/g,i[o].code),$("#order-create-coupon").html(d),e.oCache.coupon={discount:i[o].discount_amount,percentage:i[o].discount_percentage,code:i[o].code},e.summary(),t(),s.close()}else{var c=r.getter(0).value;c.length<1?r.setter(0,"error"):(r.setter(0,"active",LANG.orderCreate.validating),Jssdk.coupon.verify({coupon_code:c},function(a){if(a.res.avail){var i='<h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-coupon"></i>'+LANG.orderCreate.coupon+'</h5><a class="cancel yhsd-font-link" href="javascript: void(0)">'+LANG.orderCreate.cancelUse+'</a><div class="coupon"><div>'+LANG.orderCreate.useCouponCode+"</div><div>"+LANG.orderCreate.discountOff;i+=$yhsd.Util.yuan(a.res.discount_amount)+'</div><div class="code">'+c+"</div></div>",$("#order-create-coupon").html(i),e.oCache.coupon={discount:a.res.discount_amount,code:c},e.summary(),t(),s.close()}else r.setter(0,"error",LANG.orderCreate.couponCode_useless)}))}})};e.oCache.isLogin?Jssdk.coupon.get(function(e){var t="";if(200===e.res.code){var a=e.res.coupons,s=[];if(a.length>0&&$.each(a,function(e,t){var a;t.cart_match&&"pending"===t.status&&(a=t,(new Date).getTime()-new Date(a.actived_at).getTime()>=0)&&s.push(t)}),s.length>0){var n='<li class="checkbox-group" data-index="#{index}">    <label for="coupon-use-#{index}"><span class="radio-btn#{first_selected}"></span></label>    <input type="radio" name="payment" id="coupon-use-#{index}" #{first_checked}>    <div class="icon">#{amount}<br><small>#{desc}</small></div>    <div class="info">#{name}<br>'+LANG.orderCreate.expiredCode+"：#{code}</div></li>";$.each(s,function(e,a){if(a.active_amount>0)s=a.discount_amount?(s=LANG.coupon.discount_off).replace(/#\{active\}/g,a.active_amount/100).replace(/#\{amount\}/g,a.discount_amount/100):(s=LANG.coupon.percentage_off).replace(/#\{active\}/g,a.active_amount/100).replace(/#\{percentage\}/g,a.discount_percentage/10);else var s=LANG.coupon.nolimit;if(a.expired_at)var i=a.actived_at.slice(0,10).split("-").join(".")+" - "+a.expired_at.slice(0,10).split("-").join(".");else i=a.actived_at.slice(0,10).split("-").join(".")+" - "+LANG.orderCreate.expire_forever;var r=a.discount_amount?LANG.currency+$yhsd.Util.yuan(a.discount_amount):a.discount_percentage/10+LANG.coupon.percentage;t+=n.replace(/#\{index\}/g,e).replace(/#\{first_selected\}/g,0===e?" selected":"").replace(/#\{first_checked\}/g,0===e?" checked":"").replace(/#\{amount\}/g,r).replace(/#\{desc\}/g,s).replace(/#\{expired_at\}/g,i).replace(/#\{name\}/g,a.coupon_group_name).replace(/#\{code\}/g,a.code)}),i.removeClass("empty").html(t),$yhsd.CheckBtn.init("#use-coupon-list")}else t="<li>"+LANG.orderCreate.noCoupon+"</li>",i.html(t);r(s)}}):(sDom="<li>"+LANG.orderCreate.coupon_login+"</li>",i.html(sDom),r()),$("#use-coupon-tags").on("click","div",function(){$(this).addClass("active").siblings().removeClass("active"),$(this).hasClass("first")?(i.slideDown(200),n.slideUp(200),a=!0):(i.slideUp(200),n.slideDown(200),a=!1)})});s.init()})}a()},points:function(e){var t=this;if(t.oCache.isLogin&&t.oCache.points.rules&&t.oCache.points.rules.enabled){$("#yhsd-order-summary").find(".points-get").show();var a=$("#order-create-points").off(),s='<a class="add" href="javascript: void(0)"><i class="yhsd-base-iconfont icon-add-round"></i>'+LANG.orderCreate.use_points+"</a>（"+LANG.orderCreate.left+"<span>#{total}</span>"+LANG.orderCreate.points+"，"+LANG.orderCreate.use_max_points+"<span>#{valid}</span>）",i="<span>"+LANG.orderCreate.use_points+"：</span>#{used}"+LANG.orderCreate.points+"<small>-"+LANG.currency+'#{price}</small><a class="cancel" href="javascript: void(0)">'+LANG.orderCreate.cancelUse+"</a>";e.update({reward_point_exchange_ratio:t.oCache.points.rules.exchange_ratio,reward_point_limit:t.oCache.points.rules.limit,reward_point_total:t.oCache.points.total,reward_point_use:t.oCache.points.use||0});var n=0;e.get(function(e){n=e.reward_point_max,t.oCache.points.use=e.reward_point_use,t.oCache.points.off=e.point_disocunt_amount}),t.oCache.points.use>0?(i=i.replace(/#\{used\}/g,t.oCache.points.use).replace(/#\{price\}/g,$yhsd.Util.yuan(t.oCache.points.off)),a.html('<div class="order-points">'+i+"</div>")):(0===n&&(s="共<span>#{total}</span>"+LANG.orderCreate.points+"，"+LANG.orderCreate.use_max_points+"<span>#{valid}</span>"),s=s.replace(/#\{total\}/g,t.oCache.points.total).replace(/#\{valid\}/g,n),a.html('<div class="order-points yhsd-main-border yhsd-form-background">'+s+"</div>")),a.on("click",".add",function(){var a='<h3 class="yhsd-font-title">'+LANG.orderCreate.use_points+"</h3>",s='<div class="box use-points">   <div id="use-coupon-input" class="input-area input-area-lg" data-state="">       <div class="title">'+LANG.orderCreate.points_title+'</div>       <input class="input yhsd-font=text" type="text" name="points" maxlength="200">       <div class="tips"></div>   </div></div><div class="ctrl-btns">    <button class="btn btn-primary btn-md" id="order-create-usepoints" type="submit">'+LANG.popup.submit+'</button>    <button class="btn btn-secondary btn-md yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button></div>",i=new $yhsd.Popup(a,s,function(){var a=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.orderCreate.use_points_empty,active:LANG.orderCreate.use_points_active}}],s=new $yhsd.InputManager("#use-coupon-input",a);s.init(),$("#order-create-usepoints").on("click",function(){var a;if(0!==(a=s.getter(0).value).length)if(a=parseInt(a)){var r=a>n?n:a;s.setVal(0,r),t.oCache.points.use=r,e.update({reward_point_use:t.oCache.points.use||0}),e.get(function(e){t.oCache.points.off=e.point_disocunt_amount}),t.summary(),i.close()}else s.setter(0,"error","请输入合法的数字");else s.setter(0,"error")})});i.init()}),a.on("click",".cancel",function(){a.html('<div class="order-points">'+s+"</div>"),t.oCache.points.use=0,t.oCache.points.off=0,t.summary()})}},summary:function(){var e=this,t=Jssdk.util.orderCalculator();!function(){if(e.oCache.addressIndex>-1){var t=$("#yhsd-order-summary").find(".address"),a=e.oCache.address[e.oCache.addressIndex];t.find(".district").html(a.location_full_titles.split(",").join(" ")+" "+a.detail),t.find(".contact").html(a.name+" "+a.mobile),t.fadeIn(200)}}(),function(){if(0!==e.oCache.origin_amount){var a=$("#yhsd-order-summary").find(".detail");a.find(".origin-amount").children("span").html(LANG.currency+$yhsd.Util.yuan(e.oCache.origin_amount)),t.update({item_amount:e.oCache.origin_amount}),e.oCache.promote_off>0?a.find(".promote").slideDown(200).children("span").html(e.oCache._discounts+"-"+LANG.currency+$yhsd.Util.yuan(e.oCache.promote_off)):a.find(".promote").slideUp(200),t.update({discount_amount:e.oCache.promote_off});var s=0;if(e.oCache.coupon){s=e.oCache.coupon.discount||parseInt((100-e.oCache.coupon.percentage)*(e.oCache.origin_amount-e.oCache.promote_off)/100);a.find(".coupon").slideDown(200).children("span").html("-"+LANG.currency+$yhsd.Util.yuan(s))}else a.find(".coupon").slideUp(200);if(t.update({coupon_discount_amount:s}),e.oCache.isLogin){var i=e.oCache.vip.name+"-"+LANG.orderCreate.vipDiscount+'：<span class="value">- #{price}</span>';t.update({level_discount:e.oCache.vip.rate}),t.get(function(t){e.oCache.vip.off=t.level_discount_amount}),a.find(".vip").html(i.replace(/#\{price\}/g,LANG.currency+$yhsd.Util.yuan(e.oCache.vip.off)))}a.find(".ship").children("span").html(LANG.currency+$yhsd.Util.yuan(e.oCache.ship_amount)),t.update({shipment_amount:e.oCache.ship_amount}),e.points(t),e.oCache.points.off>0?a.find(".points").slideDown(200).children("span").html("-"+LANG.currency+$yhsd.Util.yuan(e.oCache.points.off)):a.find(".points").slideUp(200),t.get(function(t){e.oCache.total_amount=t.final_amount}),e.oCache.total_amount<0&&(e.oCache.total_amount=0),a.find(".total-amount").children("span").html(LANG.currency+$yhsd.Util.yuan(e.oCache.total_amount))}}()},submit:function(){var e=this;$("#order-create-submit").on("click",function(){var t=$(this),a=e.oCache.address[e.oCache.addressIndex],s={payment_method_id:e.oCache.payment_method_id,shipments:JSON.stringify(e.oCache.shipment_used),bank_code_id:e.oCache.bank_code_id},i=$(this).next(".error"),n=function(e){i.html(e).slideDown(300,function(){setTimeout(function(){i.html("").slideUp(300)},3e3)})};if(a){if(e.oCache.isLogin){if(s.address_id=a.id,!s.address_id)return void n(LANG.orderCreate.addressInfoTips)}else if(s.name=a.name,s.district_code=a.district_code,s.mobile=a.mobile,s.detail=a.detail,a.zipcode&&(s.zipcode=a.zipcode),!(s.name&&s.district_code&&s.mobile&&s.detail))return void n(LANG.orderCreate.addressInfoTips);var r=!1,o=null;if("object"==typeof yhsdOrderMetafieldsConf&&yhsdOrderMetafieldsConf instanceof Array&&yhsdOrderMetafieldsConf.length>0&&(yhsdOrderMetafieldsConf.reverse(),o={name:"order_attributes",description:"metafiled",fields:{}},$.each(yhsdOrderMetafieldsConf,function(e,t){if(t.name&&t.title){var a=t.id||"yhsdOrderMeta-"+t.name,s="",i=$("#"+a).serializeArray(),d=[];$.each(i,function(e,t){d.push(t.value)}),d=d.join();var c=$("#"+a).siblings(".metafiled-tips");t.validation&&"function"==typeof t.validation&&(s=t.validation(d)),s&&"string"==typeof s&&s.length>0?(c.html(s).fadeIn(200,function(){setTimeout(function(){c.fadeOut(200)},5e3)}),n(s),r=!0):(o.fields[t.name]=d,c.fadeOut(200))}})),!r)if(o&&(s.meta_fields=JSON.stringify(o)),s.payment_method_id){var d=$.trim($("#order-left-message").find(".input").val());if(d&&(s.remark=d),e.oCache.coupon&&(s.coupon_code=e.oCache.coupon.code),e.oCache.points.use>0&&(s.reward_point=e.oCache.points.use),!t.hasClass("btn-secondary")){var c=60;t.html(LANG.orderCreate.title+'(<span id="order-submit-count">60</span>)'),t.addClass("btn-secondary").removeClass("btn-vital");var l,p,u=setInterval(function(){c>0?t.find("span").html(c--):(t.html(LANG.orderCreate.title).addClass("btn-vital").removeClass("btn-secondary"),clearInterval(u))},1e3);l=s,p=function(a){if(200===a.res.code)if(e.oCache.isLogin)window.location.href="/account/orders/"+a.res.order_no;else{if("online"===e.oCache.payment_method_type)var s=LANG.orderCreate.goPay,i=function(){t.html(LANG.orderCreate.title),clearInterval(u),$("#unlogin-create-submit").on("click",function(){r.close();var t={total_amount:e.oCache.total_amount,address:e.oCache.address[0],shipments:e.oCache.shipments[0].carts};orderPayment.init(a.res.order_no,t)})};else{s=LANG.popup.submit;t.html(LANG.orderCreate.title),clearInterval(u);i=function(){$("#unlogin-create-submit").on("click",function(){r.close(),window.location.href="/"})}}var n='<div class="box">    <div class="save-orde-no">'+LANG.orderCreate.orderNo+"：<span>"+a.res.order_no+"</span></div>    <div>"+LANG.orderCreate.saveOrderNo+'</div>    <div class="ctrl-btns">       <button id="unlogin-create-submit" class="btn btn-primary btn-md" type="submit">'+s+"</button>    </div></div>";(r=new $yhsd.Popup("<h3>"+LANG.orderCreate.createSucess+"</h3>",n,i,!0)).init()}else{t.html(LANG.orderCreate.title).addClass("btn-vital").removeClass("btn-secondary"),clearInterval(u);var r,o='<div class="box">    <div class="title">'+a.res.message+"，"+LANG.orderCreate.createFail+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";(r=new $yhsd.Popup("<h3>"+LANG.orderCreate.title+"</h3>",o)).init()}},"function"==typeof window.yhsdOverrideDesktopOrderCreate?window.yhsdOverrideDesktopOrderCreate(l,p):Jssdk.order.create(l,p)}}else n(LANG.orderCreate.payMethodTips)}else n(LANG.orderCreate.addressInfoTips)})},init:function(){var e=this;Jssdk.discount.matchCart(function(t){if(200===t.res.code&&(t.res.reward_point_enabled&&(e.oCache.points.rules={enabled:t.res.reward_point_enabled,exchange_ratio:t.res.reward_point_exchange_ratio,limit:t.res.reward_point_limit}),t.res.discounts.length>0)){var a='<div class="show-discount"><ul class="show-discount-tooltip">';$.each(t.res.discounts,function(t,s){e.oCache.promote_off+=s.discount_amount,a+='<li><span class="left">'+s.name+'</span><span class="right">-'+LANG.currency+" "+$yhsd.Util.yuan(s.discount_amount)+"</span></li>"}),a+="</ul></div>",e.oCache._discounts=a}Jssdk.cart.get(function(t){var a=!1;e.oCache.localCart=t.res.cart,$.each(t.res.cart.items,function(t,s){s.available&&s.is_check&&(a=!0,e.oCache.points.get+=s.point*s.quantity)}),a?($(oGlobalConfig.layoutHook).html(e._main),function(){if("object"==typeof yhsdOrderMetafieldsConf&&yhsdOrderMetafieldsConf instanceof Array&&yhsdOrderMetafieldsConf.length>0){yhsdOrderMetafieldsConf.reverse();var e='<div class="order-block order-metafiled yhsd-form-background yhsd-main-border #{class}">    <h5 class="yhsd-font-title"><i class="yhsd-base-iconfont icon-order-pc"></i>#{title}</h5>       #{content}</div>',t='<form id="#{id}" class="input-area input-area-md" action="javascript:void(0);">    <input class="input yhsd-font-text" type="text" name="#{name}" placeholder="#{placeholder}" value="#{default_val}">    <div class="metafiled-tips"></div></form>',a='<form id="#{id}" class="checkbox-group" action="javascript:void(0);">   #{checkbox_options}</form><div class="metafiled-tips"></div>',s='<form id="#{id}" class="select-group" action="javascript:void(0);">    <select class="yhsd-select yhsd-font-text" name="#{name}">       #{select_options}    </select></form><div class="metafiled-tips"></div>';$.each(yhsdOrderMetafieldsConf,function(i,n){if(n.name&&n.title){var r=e.replace(/#\{title\}/g,n.title).replace(/#\{title\}/g,n.title),o="";switch(n.type){case"select":if(n.options&&n.options.length>0){var d="";$.each(n.options,function(e,t){var a=n.default&&"string"==typeof n.default&&n.default===t?"selected":"";d+='<option value="'+t+'"'+a+">"+t+"<optiopn>"}),o=s.replace(/#\{id\}/g,n.id||"yhsdOrderMeta-"+n.name).replace(/#\{select_options\}/g,d).replace(/#\{name\}/,n.name)}break;case"radio":case"checkbox":if(n.options&&n.options.length>0){d="";var c='<label for="yhsdOrderMeta-#{index}">  <span class="#{type}-btn #{is_selected}"></span>#{op_name}</label><input type="#{type}" value="#{op_name}" name="#{name}" id="yhsdOrderMeta-#{index}" #{is_checked}>';$.each(n.options,function(e,t){var a="",s="";(n.default&&"string"==typeof n.default&&n.default===t||n.default instanceof Array&&n.default[e]||!n.default&&"radio"===n.type&&0===e)&&(a="selected",s="checked"),d+=c.replace(/#\{index\}/g,n.name+"-"+e).replace(/#\{type\}/g,n.type).replace(/#\{name\}/g,n.name).replace(/#\{op_name\}/g,t).replace(/#\{is_selected\}/,a).replace(/#\{is_checked\}/,s)}),o=a.replace(/#\{id\}/g,n.id||"yhsdOrderMeta-"+n.name).replace(/#\{checkbox_options\}/,d)}break;default:var l=n.default&&"string"==typeof n.default?n.default:"";o=t.replace(/#\{id\}/g,n.id||"yhsdOrderMeta-"+n.name).replace(/#\{default_val\}/,l).replace(/#\{name\}/,n.name).replace(/#\{placeholder\}/,n.placeholder||"")}$(r.replace(/#\{class\}/,n.class||"").replace(/#\{content\}/,o)).insertAfter("#yhsd-order-address"),"radio"!==n.type&&"checkbox"!==n.type||$yhsd.CheckBtn.init("#yhsdOrderMeta-"+n.name)}})}}(),Jssdk.account.current(function(t){t.res.customer?($("#yhsd-order-summary").find(".points-get").html(LANG.orderCreate.get_points+"：<span>"+e.oCache.points.get+"</span>"),e.address(!0),e.oCache.points.total=t.res.customer.point,e.oCache.vip.rate=t.res.customer.customer_level.discount,e.oCache.vip.name=t.res.customer.customer_level.name):(e.oCache.isLogin=!1,e.address(!1)),e.coupon(),e.submit();var a=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:"",active:LANG.orderCreate.remarkTips}}];new $yhsd.InputManager("#order-left-message",a).init()})):window.location.href="/"})})}},forgetPassword={_main:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.forgetPassword.title+'</h2>        <div class="account-block">            <h4 class="yhsd-font-title">'+LANG.forgetPassword.titleTips+'</h4>            <form id="yhsd-change-inputField" class="input-field" action="javascript:void(0);">                <div class="input-area input-area-lg" data-state="">                    <div class="title">'+LANG.forgetPassword.account+'</div>                    <input id="yhsd-change-type" class="input yhsd-font-text" type="text" name="account" maxlength="200">                    <div class="tips"></div>                </div>                <div id="yhsd-change-byphone" style="display: none">                <div class="input-group">                    <div class="input-area input-area-lg" data-state="">                        <div class="title">'+LANG.sign.register_vcode+'</div>                        <input id="yhsd-change-vcode" class="input yhsd-font-text" type="text" name="verify_code" maxlength="10">                        <div class="tips"></div>                    </div>                    <a id="yhsd-change-getVcode" href="javascript:void(0);" class="btn btn-input">'+LANG.sign.register_getVcode+'</a>                </div>                <div class="input-area input-area-lg" data-state="">                    <div class="title">'+LANG.sign.register_setCode+'</div>                    <input id="yhsd-reset-code" class="input yhsd-font-text" type="password" name="password" maxlength="40">                    <div class="tips"></div>                </div>                <div class="input-area input-area-lg" data-state="">                    <div class="title">'+LANG.sign.register_confirmCode+'</div>                    <input id="yhsd-reset-codeConfirm" class="input yhsd-font-text" type="password" name="password_again" maxlength="40">                    <div class="tips"></div>                </div>            </div>            </form>            <a id="yhsd-change-submit" href="javascript:void(0);" class="btn btn-primary btn-lg btn-block">'+LANG.forgetPassword.findCode+"</a>        </div>    </div></div>",_resetPhone:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.forgetPassword.resetCode+'</h2>        <div class="account-block">            <img src="'+$yhsd.asset+'img/160623/reset-success.png">            <div class="reset-success">'+LANG.forgetPassword.resetSucess+"</div>            <small>"+LANG.forgetPassword.resetSucessTips+'</small>            <a href="/account/login" class="btn btn-primary btn-sm">'+LANG.sign.login+"</a>        </div>    </div></div>",_resetEmail:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.forgetPassword.resetCode+'</h2>        <div class="account-block reset-mail">            <img src="'+$yhsd.asset+'img/160623/reset_mail.png""            <p>'+LANG.forgetPassword.resetWithEmail+"</p>        </div>    </div></div>",config:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.forgetPassword.inputTips.account_empty,active:LANG.forgetPassword.inputTips.account_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_vcode_empty,active:LANG.sign.inputTips.register_vcode_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_code_empty,active:LANG.sign.inputTips.register_code_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_recode_empty,active:LANG.sign.inputTips.register_recode_active}}],tagVcode:function(){var e=this,t=$("#yhsd-change-type"),a=$("#yhsd-change-byphone"),s=$("#yhsd-change-submit");t.on("input propertychange",function(){var i=$.trim(t.val());$yhsd.Util.isMobile(i)?(a.slideDown(200),e.getVcode(!0),s.html(LANG.forgetPassword.resetCode)):(a.slideUp(200),$("#yhsd-change-vcode").val(""),$("#yhsd-reset-code").val(""),$("#yhsd-reset-codeConfirm").val(""),e.getVcode(!1),s.html(LANG.forgetPassword.findCode))})},getVcode:function(e){var t=$("#yhsd-change-getVcode");e?t.on("click",function(){if(!$(this).hasClass("gray")){var e="<h3>"+LANG.sign.vcode.title+"</h3>",a='<div class="box register-get-vcode">   <form class="input-field" id="yhsd-register-captcha-inputField" action="javascript:void(0);">       <div class="input-area input-area-lg" data-state="">          <div class="title">'+LANG.sign.vcode.type+'</div>          <input id="yhsd-register-captcha" class="input " type="text" maxlength="10" name="captcha_value">          <div class="tips"></div>       </div>       <img id="yhsd-register-captcha-img"><a href="javascript:void(0);" id="yhsd-register-captcha-retry">'+LANG.sign.vcode.unclear+'</a>       <div class="ctrl-btns">          <button id="yhsd-register-captcha-submit" class="btn btn-md btn-primary" type="submit">'+LANG.popup.submit+'</button>          <button class="btn btn-md btn-secondary yhsd-popup-close" type="button">'+LANG.popup.cancel+"</button>       </div>   </form></div>";new $yhsd.Popup(e,a,function(){var e=this;$("#yhsd-register-captcha-retry").on("click",function(){Jssdk.captcha.fetch(function(e){$("#yhsd-register-captcha-img").attr("src",e.src),$("#yhsd-register-captcha").attr("data-id",e.id)})}).click();var a=[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.vcode.input_error,active:LANG.sign.vcode.input_active}}],s=new $yhsd.InputManager("#yhsd-register-captcha-inputField",a);s.init(),$("#yhsd-register-captcha-submit").on("click",function(){var a=s.getter(0).value;if(a){var i={mobile:$.trim($("#yhsd-change-type").val()),captcha_id:$("#yhsd-register-captcha").attr("data-id"),captcha_value:a};Jssdk.account.sendResetValidateSms(i,function(a){200===a.res.code?(e.close(),function(e){t.html(LANG.sign.vcode.reget+"("+e+")").addClass("gray");var a=setInterval(function(){e--,t.html(LANG.sign.vcode.reget+"("+e+")"),e<0&&(clearInterval(a),t.removeClass("gray").html(LANG.sign.register_getVcode))},1e3)}(60)):201===a.res.code?s.setter(0,"error",a.res.message):(e.close(),setTimeout(function(){var e='<div class="box">    <div class="title">'+LANG.sign.vcode.title+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.popup.title+"</h3>",e).init()},300))})}else s.setter(0,"error")})}).init()}}):t.off()},verify:function(e){var t=e.getter(0).value,a=$yhsd.Util.isMobile(t),s=$yhsd.Util.isEmail(t);if(!a&&!s){switch(!0){case 0===t.length:e.setter(0,"error");break;case t.length<5:e.setter(0,"error",LANG.sign.inputTips.register_account_short);break;case t.indexOf("@")>0:e.setter(0,"error",LANG.sign.inputTips.register_email_err);break;case t.length=/^[1-9][0-9]{6,}$/.test(t):e.setter(0,"error",LANG.sign.inputTips.register_mobile_err);break;default:e.setter(0,"error",LANG.forgetPassword.inputTips.mobile_email_err)}return!1}if(a){if((i={account:t}).verify_code=e.getter(1).value,i.password=e.getter(2).value,i.password_again=e.getter(3).value,!i.verify_code)return e.setter(1,"error"),!1;if(i.password.length<6)return 0===i.password.length?e.setter(2,"error"):e.setter(2,"error",LANG.sign.inputTips.register_code_active),!1;if(0===i.password_again.length)return e.setter(3,"error"),!1;if(i.password!==i.password_again)return e.setter(3,"error",LANG.sign.inputTips.register_code_diff),!1;e.setter(3,"correct"),e.setter(2,"correct")}if(s)var i={email:t};return i},submit:function(e){var t=this,a=t.verify(e);if(a){var s="resetPasswordWithMobile";a.email&&(s="resetPasswordWithEmail"),Jssdk.account[s](a,function(a){if(200===a.res.code)"resetPasswordWithEmail"===s?$(oGlobalConfig.layoutHook).html(t._resetEmail):$(oGlobalConfig.layoutHook).html(t._resetPhone);else if(201===a.res.code){var i=a.res.message;if("验证码不正确"===i)e.setter(1,"error",i);else{var n='<div class="box">    <div class="title">'+i+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.forgetPassword.title+"</h3>",n).init()}}else{n='<div class="box">    <div class="title">'+LANG.popup.netError+'</div>    <div class="ctrl-btns">       <a href="javascript:void(0);" class="btn btn-primary btn-md yhsd-popup-close">'+LANG.popup.submit+"</a>    </div></div>";new $yhsd.Popup("<h3>"+LANG.forgetPassword.title+"</h3>",n).init()}})}},init:function(){var e=this,t=this._main;$(oGlobalConfig.layoutHook).html(t);var a=new $yhsd.InputManager("#yhsd-change-inputField",e.config);a.init(),e.tagVcode(),$("#yhsd-change-submit").on("click",function(){e.submit(a)})}},resetPassword={_main:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.resetPassword.title+'</h2>        <div class="account-block">            <h4 class="yhsd-font-title">'+LANG.resetPassword.titleTips+'</h4>            <form id="yhsd-reset-inputField" class="input-field" action="'+window.location.pathname+'" method="post">                <div class="input-area input-area-lg" data-state="">                    <div class="title">'+LANG.sign.register_setCode+'</div>                    <input id="yhsd-reset-code" class="input yhsd-font-text" type="password" name="password" maxlength="40">                    <div class="tips"></div>                </div>                <div class="input-area input-area-lg" data-state="">                    <div class="title">'+LANG.sign.register_confirmCode+'</div>                    <input id="yhsd-reset-codeConfirm" class="input yhsd-font-text" type="password" name="password_again" maxlength="40">                    <div class="tips"></div>                </div>                <button id="yhsd-reset-password" class="btn btn-primary btn-lg btn-block" type="submit">'+LANG.resetPassword.title+"</button>            </form>        </div>    </div></div>",_resetDone:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">重置密码</h2>        <div class="account-block">            <img src="'+$yhsd.asset+'img/160623/reset-success.png"            <div class="reset-success">'+LANG.resetPassword.titresetSucessle+"</div>            <small>"+LANG.resetPassword.resetSucessTips+'</small>            <a href="/account/login" class="btn btn-primary btn-sm">'+LANG.sign.login+"</a>        </div>    </div></div>",config:[{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_code_empty,active:LANG.sign.inputTips.register_code_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.register_recode_empty,active:LANG.sign.inputTips.register_recode_active}}],submit:function(e){window.location.pathname.slice(15);$("#yhsd-reset-password").on("click",function(t){var a=e.getter(0).value,s=e.getter(1).value;return 0===a.length?(e.setter(0,"error"),void t.preventDefault()):a.length<6?(e.setter(0,"error",LANG.sign.inputTips.register_code_short),void t.preventDefault()):0===s.length?(e.setter(1,"error"),void t.preventDefault()):a!==s?(e.setter(1,"error",LANG.sign.inputTips.register_code_diff),void t.preventDefault()):void 0})},init:function(){if(window.YhsdResetPasswordForm&&window.YhsdResetPasswordForm["posted_successfully?"])window.location.href="/";else{var e=this._main;$(oGlobalConfig.layoutHook).html(e);var t=new $yhsd.InputManager("#yhsd-reset-inputField",this.config);t.init(),this.submit(t)}}},socialBind={_main:'<div class="wrapper">    <div class="cont">        <h2 class="page-title yhsd-font-title">'+LANG.socialBind.title+'</h2>        <div class="account-block">#{main_filed}</div>    </div></div>',_login:'<h4 class="yhsd-font-title">'+LANG.socialBind.accountBind+'</h4><form id="yhsd-bind-inputField" class="input-field" action="/account/social/bind" method="POST">    <div class="input-area input-area-lg" data-state="">        <div class="title">'+LANG.sign.account+'</div>        <input class="input yhsd-font-text" type="text" name="account" maxlength="40">        <div class="tips"></div>    </div>    <div class="input-area input-area-lg" data-state="">        <div class="title">'+LANG.sign.password+'</div>        <input class="input yhsd-font-text" type="password" name="password" maxlength="40">        <div class="tips"></div>    </div>    #{tips}    <div class="yhsd-bind-desc yhsd-font-desc">还没有账号？请先 <a href="/account/register" class="yhsd-font-link">注册</a> 后再进行绑定</div>    <a id="yhsd-bind-submit" href="javascript:void(0);" class="btn btn-primary btn-lg btn-block" data-login="true">'+LANG.socialBind.save+"</a></form>",_bindMsg:'<h4 class="yhsd-font-title">'+LANG.socialBind.infoBind+'</h4><form id="yhsd-bind-inputField" class="input-field" action="/account/social/bind" method="POST">    <div class="input-area input-area-lg" data-state="">        <div class="title">'+LANG.sign.typeName.email+'</div>        <input class="input yhsd-font-text" type="text" name="notify_email" maxlength="40">        <div class="tips"></div>    </div>    <div class="input-area input-area-lg" data-state="">        <div class="title">'+LANG.sign.typeName.mobile+'</div>        <input class="input yhsd-font-text" type="text" name="notify_phone" maxlength="40">        <div class="tips"></div>    </div>    #{tips}    <a id="yhsd-bind-submit" href="javascript:void(0);" class="btn btn-primary btn-lg btn-block" data-login="false">'+LANG.socialBind.save+"</a></form>",_bindEmail:'<h4 class="yhsd-font-title">'+LANG.socialBind.infoBind+'</h4><form id="yhsd-bind-inputField" class="input-field" action="/account/social/bind" method="POST">    <div class="input-area input-area-lg" data-state="">        <div class="title">'+LANG.sign.typeName.email+'</div>        <input class="input yhsd-font-text" type="text" name="notify_email" maxlength="40">        <div class="tips"></div>    </div>    #{tips}    <a id="yhsd-bind-submit" href="javascript:void(0);" class="btn btn-primary btn-lg btn-block" data-login="false">'+LANG.socialBind.save+"</a></form>",_bindMobile:'<h4 class="yhsd-font-title">'+LANG.socialBind.infoBind+'</h4><form id="yhsd-bind-inputField" class="input-field" action="/account/social/bind" method="POST">    <div class="input-area input-area-lg" data-state="">        <div class="title">'+LANG.sign.typeName.mobile+'</div>        <input class="input yhsd-font-text" type="text" name="notify_phone" maxlength="40">        <div class="tips"></div>    </div>    #{tips}    <a id="yhsd-bind-submit" href="javascript:void(0);" class="btn btn-primary btn-lg btn-block" data-login="false">'+LANG.socialBind.save+"</a></form>",render:function(e){var t=this._main,a="";if(window.YhsdSocialBindForm&&window.YhsdSocialBindForm["posted_successfully?"]){var s=$yhsd.Util.getCookie("redirect_back_url");s?($yhsd.Util.setCookie("redirect_back_url",""),location.href=decodeURIComponent(s)):location.pathname="/"}else{switch(YhsdSocialBindForm.errors&&YhsdSocialBindForm.errors.length>0&&(a='<div id="yhsd-bind-tips">'+YhsdSocialBindForm.errors[0]+"</div>"),e){case 2:t=t.replace(/#\{main_filed\}/g,this._bindMsg).replace(/#\{tips\}/g,a);break;case 3:t=t.replace(/#\{main_filed\}/g,this._login).replace(/#\{tips\}/g,a);break;case 4:t=t.replace(/#\{main_filed\}/g,this._bindMobile).replace(/#\{tips\}/g,a);break;case 5:t=t.replace(/#\{main_filed\}/g,this._bindEmail).replace(/#\{tips\}/g,a)}$(oGlobalConfig.layoutHook).html(t),this.userEvent(e)}},loginConfig:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.sign.inputTips.login_account_empty,active:LANG.sign.inputTips.login_account_active}},{blurTest:!1,immediate:!1,needTrim:!1,advanced:function(){return null},state:{error:LANG.sign.inputTips.login_code_empty,active:LANG.sign.inputTips.login_code_active}}],bindMsgConfig:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.socialBind.email_empty,active:LANG.socialBind.email_active}},{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.socialBind.mobile_empty,active:LANG.socialBind.mobile_active}}],bindEmailConfig:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.socialBind.email_empty,active:LANG.socialBind.email_active}}],bindMobileConfig:[{blurTest:!1,immediate:!1,needTrim:!0,advanced:function(){return null},state:{error:LANG.socialBind.mobile_empty,active:LANG.socialBind.mobile_active}}],userEvent:function(e){var t,a,s;switch(e){case 2:t=this.bindMsgConfig,a=function(){var e={};return e.notify_email=s.getter(0).value,e.notify_phone=s.getter(1).value,0===e.notify_email.length?(s.setter(0,"error"),!1):$yhsd.Util.isEmail(e.notify_email)?0===e.notify_phone.length?(s.setter(1,"error"),!1):!!$yhsd.Util.isMobile(e.notify_phone)||(s.setter(1,"error",LANG.socialBind.mobile_err),!1):(s.setter(0,"error",LANG.socialBind.email_err),!1)};break;case 3:t=this.loginConfig,a=function(){var e={};return e.account=s.getter(0).value,e.password=s.getter(1).value,0===e.account.length?(s.setter(0,"error"),!1):e.account.length<5?(s.setter(0,"error",LANG.socialBind.account_err),!1):0===e.password.length?(s.setter(1,"error"),!1):!!/[0-9a-zA-Z]{4,40}/.test(e.password)||(s.setter(1,"error",LANG.socialBind.password_err),!1)};break;case 4:t=this.bindMobileConfig,a=function(){var e={};return e.notify_phone=s.getter(0).value,0===e.notify_phone.length?(s.setter(0,"error"),!1):!!$yhsd.Util.isMobile(e.notify_phone)||(s.setter(0,"error",LANG.socialBind.mobile_err),!1)};break;case 5:t=this.bindEmailConfig,a=function(){var e={};return e.notify_email=s.getter(0).value,0===e.notify_email.length?(s.setter(0,"error"),!1):!!$yhsd.Util.isEmail(e.notify_email)||(s.setter(0,"error",LANG.socialBind.email_err),!1)}}(s=new $yhsd.InputManager("#yhsd-bind-inputField",t)).init(),$("#yhsd-bind-submit").on("click",function(){a()&&$("#yhsd-bind-inputField").submit()})},init:function(){var e=this;Jssdk.shop.get(function(t){if(200===t.res.code){var a=t.res.shop;e.render(a.social_register_style)}})}};$(document).ready(function(){window.yhsd&&yhsd.ready&&yhsd.ready(function(e){window.Jssdk=e;var t={all:function(){var e;(simpleCart.init(!1),"new"==$yhsd.Util.getQuery("customer"))?("transparent"==(e=$('<div style="z-index:999;position:fixed;bottom:0;left:0;right:0;width:100%;padding:18px 0;text-align:center;background-color:rgba(68, 153, 238, .9);"><p style="color:#fff;font-size:18px;line-height:1.6;padding:0;margin:0">Hi，欢迎来到属于你的网站，现在它看起来还不是很丰富，快到后台设置吧！</p><a href="/center" style="margin-top:16px;display:inline-block;color:#4499ee;width:212px;height:42px;line-height:42px;background:#fff;border-radius:50px;text-decoration:none;box-shadow:0 0 1px 0 rgba(0,0,0,.3)">进入后台</a></div>')).css("background-color")&&e.css({"background-color":"#4499ee"}),$("body").append(e)):$yhsd.Util.getCookie("preview_theme_id")?$.getScript(window.assetPath.split("image")[0]+"common/js/theme-preview-mode.js"):$yhsd.Util.getCookie("admin_status")&&$.getScript(window.assetPath.split("image")[0]+"common/js/adminmode.js");$(".search-ipt").on("keyup",function(e){var t=$(this).val();13==e.which&&(window.location.href="/search?terms="+encodeURIComponent(t))}),$(".search-btn").on("click",function(e){var t=$(this).parent().find(".search-ipt");t[0]&&(window.location.href="/search?terms="+encodeURIComponent(t.val()))}),$(".prolist-filter-clear a").on("click",function(){var e=window.location.href;if(e.indexOf("?")>-1){var t=e.split("?")[0];setTimeout(function(){window.location.href=t},200)}}),window.assetPath&&setTimeout(function(){$.getScript(window.assetPath.split("image")[0]+"common/js/imgchecker.js")},1e3)},accountLogin:function(){accountLogin.init()},accountRegister:function(){accountRegister.init()},socialBind:function(){socialBind.init()},accountForgetPassword:function(){forgetPassword.init()},accountReset:function(){resetPassword.init()},orderAll:function(){orderList.init()},orderDetail:function(){orderDetail.init()},cart:function(){cart.init()},orderCreate:function(){orderCreate.init()}};t.productDetail=function(){var e=$("#yhsd_productDiscount"),t=window.CurrentProduct;if(!productDetail.init(t)){Jssdk.discount.matchProduct(t.handle,function(t){200===t.res.code&&t.res.discounts.length>0?$.each(t.res.discounts,function(t,a){var s='<div class="pro_discount_each">';s+='<span class="settings-buyBtn_background settings-buyBtn_color">'+LANG.productDetail["discount_"+a.discount_type]+"</span>",s+='<span class="pro_discount_content">',s+='<span class="settings-price_color">'+a.name+"</span>",a.introduce&&(s+='<span class="settings-desc_color">'+a.introduce+"</span>"),s+="</span>",s+='<a href="'+a.page_url+'" class="settings-link_color" target="_blank">详情 ></a>',s+="</div>",e.append($(s))}):(e.remove(),$(".pro-detail-title + .pro-detail-price").css({"margin-top":"12px"}))});$(".pro-detail-gallery-main>a").each(function(e,t){imgSrc=$(t).find("img").attr("src"),newItem=$('<a href="javascript:void(0);"><img src="'+Jssdk.util.getProductUrl(imgSrc,75,75)+'" /></a>'),function(e,t){e.on("mouseenter click",function(){$(".pro-detail-gallery-main>a").hide(),t.show(),e.parent().find("A").removeClass("pro-detail-gallery-list-current"),e.addClass("pro-detail-gallery-list-current")})}(newItem,$(t)),$(".pro-detail-gallery-list").append(newItem)})}},t.accountIndex=function(){var e={"/":function(){accountProfile.init()},"/security":function(){accountSecurity.init()},"/address":function(){accountAddress.init()},"/coupon":function(){accountCoupon.init()},"/points":function(){accountPoints.init()}};$yhsd.HashRoute.init(e)},t.blogDetail=function(){var e=$(".blog_cont-music-item-disc-play"),t=$(".blog_cont-music-item-disc"),a="",s=0;if(e){if((a=e.attr("href"))&&a.indexOf("?id=")>-1){var i=a.split("?id=")[1];/\d/.test(i)&&(s=i-0)}}if(s&&t.length>0){var n=$('<div style="margin:0 auto;width:280px;"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=280 height=52 src="http://music.163.com/outchain/player?type=2&id=#{trackId}&auto=0&height=32"></iframe></div>'.replace("#{trackId}",s));$(".blog_cont-music-info").after(n)}},$yhsd.route.init(t)})});